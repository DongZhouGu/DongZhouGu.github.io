<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>JDBCæ ¸å¿ƒæŠ€æœ¯ | æ¬¢è¿æ¥åˆ°ï¼ŒTWOTO çš„åšå®¢</title><meta name="keywords" content="JDBC"><meta name="author" content="DongZhou"><meta name="copyright" content="DongZhou"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="æ­¤ç¬”è®°æ˜¯è§‚çœ‹ æ­¤è§†é¢‘  åšçš„ç¬”è®°ï¼Œä¾›å­¦ä¹ å‚è€ƒç”¨ã€‚   ç¬¬1ç« ï¼šJDBCæ¦‚è¿°1.1 æ•°æ®çš„æŒä¹…åŒ– æŒä¹…åŒ–(persistence)ï¼šæŠŠæ•°æ®ä¿å­˜åˆ°å¯æ‰ç”µå¼å­˜å‚¨è®¾å¤‡ä¸­ä»¥ä¾›ä¹‹åä½¿ç”¨ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç‰¹åˆ«æ˜¯ä¼ä¸šçº§åº”ç”¨ï¼Œæ•°æ®æŒä¹…åŒ–æ„å‘³ç€å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜ä¸ŠåŠ ä»¥â€å›ºåŒ–â€ï¼Œè€ŒæŒä¹…åŒ–çš„å®ç°è¿‡ç¨‹å¤§å¤šé€šè¿‡å„ç§å…³ç³»æ•°æ®åº“æ¥å®Œæˆã€‚  æŒä¹…åŒ–çš„ä¸»è¦åº”ç”¨æ˜¯å°†å†…å­˜ä¸­çš„æ•°æ®å­˜å‚¨åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å­˜å‚¨åœ¨ç£ç›˜æ–‡ä»¶ã€X">
<meta property="og:type" content="article">
<meta property="og:title" content="JDBCæ ¸å¿ƒæŠ€æœ¯">
<meta property="og:url" content="https://dongzhougu.github.io/2020/10/08/jdbc-he-xin-ji-zhu/index.html">
<meta property="og:site_name" content="æ¬¢è¿æ¥åˆ°ï¼ŒTWOTO çš„åšå®¢">
<meta property="og:description" content="æ­¤ç¬”è®°æ˜¯è§‚çœ‹ æ­¤è§†é¢‘  åšçš„ç¬”è®°ï¼Œä¾›å­¦ä¹ å‚è€ƒç”¨ã€‚   ç¬¬1ç« ï¼šJDBCæ¦‚è¿°1.1 æ•°æ®çš„æŒä¹…åŒ– æŒä¹…åŒ–(persistence)ï¼šæŠŠæ•°æ®ä¿å­˜åˆ°å¯æ‰ç”µå¼å­˜å‚¨è®¾å¤‡ä¸­ä»¥ä¾›ä¹‹åä½¿ç”¨ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç‰¹åˆ«æ˜¯ä¼ä¸šçº§åº”ç”¨ï¼Œæ•°æ®æŒä¹…åŒ–æ„å‘³ç€å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜ä¸ŠåŠ ä»¥â€å›ºåŒ–â€ï¼Œè€ŒæŒä¹…åŒ–çš„å®ç°è¿‡ç¨‹å¤§å¤šé€šè¿‡å„ç§å…³ç³»æ•°æ®åº“æ¥å®Œæˆã€‚  æŒä¹…åŒ–çš„ä¸»è¦åº”ç”¨æ˜¯å°†å†…å­˜ä¸­çš„æ•°æ®å­˜å‚¨åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å­˜å‚¨åœ¨ç£ç›˜æ–‡ä»¶ã€X">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-1.png">
<meta property="article:published_time" content="2020-10-08T07:57:44.000Z">
<meta property="article:modified_time" content="2021-11-07T15:49:12.312Z">
<meta property="article:author" content="DongZhou">
<meta property="article:tag" content="JDBC">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-1.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://dongzhougu.github.io/2020/10/08/jdbc-he-xin-ji-zhu/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="NdIUXAOVyGnnBhcrip0ksCawbdAzT0hlBZDE9u4jx6k"/><meta name="msvalidate.01" content="567E47D75E8DCF1282B9623AD914701E"/><meta name="baidu-site-verification" content="code-pE5rnuxcfD"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  noticeOutdate: undefined,
  highlight: undefined,
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":150,"languages":{"author":"ä½œè€…: DongZhou","link":"é“¾æ¥: ","source":"æ¥æº: æ¬¢è¿æ¥åˆ°ï¼ŒTWOTO çš„åšå®¢","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'JDBCæ ¸å¿ƒæŠ€æœ¯',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-11-07 23:49:12'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    document.addEventListener('pjax:complete', detectApple)})(window)</script><style type="text/css">.card-announcement .social-button{margin: .6rem 0 0 0; text-align: center;}.card-announcement .social-button a{display: block; margin: 0.2rem 0;background-color: var(--btn-bg); color: var(--btn-color); line-height: 1.6rem; transition: all .3s; position: relative; z-index: 1;}</style><style type="text/css" lang="css">
    #loading-container{
        position: fixed;
        top: 0;
        left: 0;
        min-height: 100vh;
        width: 100vw;
        z-index: 9999;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: #FFF;
        text-align: center;
        /* loaderé¡µé¢æ¶ˆå¤±é‡‡ç”¨æ¸éšçš„æ–¹å¼*/
        -webkit-transition: opacity 1s ease;
        -moz-transition: opacity 1s ease;
        -o-transition: opacity 1s ease;
        transition: opacity 1s ease;
    }
    .loading-image{
        width: 120px;
        height: 50px;
        transform: translate(-50%);
    }
    
    .loading-image div:nth-child(2) {
        -webkit-animation: pacman-balls 1s linear 0s infinite;
        animation: pacman-balls 1s linear 0s infinite
    }

    .loading-image div:nth-child(3) {
        -webkit-animation: pacman-balls 1s linear .33s infinite;
        animation: pacman-balls 1s linear .33s infinite
    }

    .loading-image div:nth-child(4) {
        -webkit-animation: pacman-balls 1s linear .66s infinite;
        animation: pacman-balls 1s linear .66s infinite
    }

    .loading-image div:nth-child(5) {
        -webkit-animation: pacman-balls 1s linear .99s infinite;
        animation: pacman-balls 1s linear .99s infinite
    }
    
   .loading-image div:first-of-type {
        width: 0;
        height: 0;
        border: 25px solid #49b1f5;
        border-right-color: transparent;
        border-radius: 25px;
        -webkit-animation: rotate_pacman_half_up .5s 0s infinite;
        animation: rotate_pacman_half_up .5s 0s infinite;
    }
    .loading-image div:nth-child(2) {
        width: 0;
        height: 0;
        border: 25px solid #49b1f5;
        border-right-color: transparent;
        border-radius: 25px;
        -webkit-animation: rotate_pacman_half_down .5s 0s infinite;
        animation: rotate_pacman_half_down .5s 0s infinite;
        margin-top: -50px;
    }
    @-webkit-keyframes rotate_pacman_half_up {0% {transform: rotate(270deg)}50% {transform: rotate(1turn)}to {transform: rotate(270deg)}}

    @keyframes rotate_pacman_half_up {0% {transform: rotate(270deg)}50% {transform: rotate(1turn)}to {transform: rotate(270deg)}}

    @-webkit-keyframes rotate_pacman_half_down {0% {transform: rotate(90deg)}50% {transform: rotate(0deg)}to {transform: rotate(90deg)}}

    @keyframes rotate_pacman_half_down {0% {transform: rotate(90deg)}50% {transform: rotate(0deg)}to {transform: rotate(90deg)}}
    
    @-webkit-keyframes pacman-balls {75% {opacity: .7}to {transform: translate(-100px, -6.25px)}}

    @keyframes pacman-balls {75% {opacity: .7}to {transform: translate(-100px, -6.25px)}}
    
   
    .loading-image div:nth-child(3),
    .loading-image div:nth-child(4),
    .loading-image div:nth-child(5),
    .loading-image div:nth-child(6){
        background-color: #49b1f5;
        width: 15px;
        height: 15px;
        border-radius: 100%;
        margin: 2px;
        width: 10px;
        height: 10px;
        position: absolute;
        transform: translateY(-6.25px);
        top: 25px;
        left: 100px;
    }
    .loading-text{
        margin-bottom: 20vh;
        text-align: center;
        color: #2c3e50;
        font-size: 2rem;
        box-sizing: border-box;
        padding: 0 10px;
        text-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    @media only screen and (max-width: 500px) {
         .loading-text{
            font-size: 1.5rem;
         }
    }
    .fadeout {
        opacity: 0;
        filter: alpha(opacity=0);
    }
    /* logoå‡ºç°åŠ¨ç”» */
    @-webkit-keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}100%{opacity:1;-webkit-transform:none;transform:none}}
    @keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);}}
 </style>
 <script>
(function () {
    const loaded = function(){
       setTimeout(function(){
            const loader = document.getElementById("loading-container");
            loader.className="fadeout" ;//ä½¿ç”¨æ¸éšçš„æ–¹æ³•æ·¡å‡ºloading page
            // document.getElementById("body-wrap").style.display="flex";
            setTimeout(function(){
                loader.style.display="none";
            },1000); 
        },1000);//å¼ºåˆ¶æ˜¾ç¤ºloading page 1s  
    };
    loaded();
})()
 </script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="æ¬¢è¿æ¥åˆ°ï¼ŒTWOTO çš„åšå®¢" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>
 <div id="loading-container">
     <p class="loading-text">ç©å‘½åŠ è½½ä¸­ . . . </p> 
     <div class="loading-image">
         <div></div>
         <div></div>
         <div></div>
         <div></div> 
         <div></div>
     </div>
 </div><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">50</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">29</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">10</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é </span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> ç›®éŒ„</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ­¸æª”</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ¨™ç±¤</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†é¡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> æ–‡æª”</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/posts/21cfbf15/"><span> ğŸš€ å¿«é€Ÿé–‹å§‹</span></a></li><li><a class="site-page child" href="/posts/dc584b87/"><span> ğŸ“‘ ä¸»é¡Œé é¢</span></a></li><li><a class="site-page child" href="/posts/4aa8abbe/"><span> ğŸ›  ä¸»é¡Œé…ç½®-1</span></a></li><li><a class="site-page child" href="/posts/ceeb73f/"><span> âš”ï¸ ä¸»é¡Œé…ç½®-2</span></a></li><li><a class="site-page child" href="/posts/98d20436/"><span> â“ ä¸»é¡Œå•ç­”</span></a></li><li><a class="site-page child" href="/posts/4073eda/"><span> âš¡ï¸ é€²éšæ•™ç¨‹</span></a></li><li><a class="site-page child" href="/posts/198a4240/"><span> âœ¨ æ›´æ–°æ—¥èªŒ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> å¨›æ¨‚</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> åœ–åº«</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> é›»å½±</span></a></li><li><a class="site-page child" href="/talking/"><i class="fa-fw fas fa-cubes"></i><span> è‡ªè¨€è‡ªèª</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> ç¤ºä¾‹</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-1.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">æ¬¢è¿æ¥åˆ°ï¼ŒTWOTO çš„åšå®¢</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é </span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> ç›®éŒ„</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ­¸æª”</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ¨™ç±¤</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†é¡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> æ–‡æª”</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/posts/21cfbf15/"><span> ğŸš€ å¿«é€Ÿé–‹å§‹</span></a></li><li><a class="site-page child" href="/posts/dc584b87/"><span> ğŸ“‘ ä¸»é¡Œé é¢</span></a></li><li><a class="site-page child" href="/posts/4aa8abbe/"><span> ğŸ›  ä¸»é¡Œé…ç½®-1</span></a></li><li><a class="site-page child" href="/posts/ceeb73f/"><span> âš”ï¸ ä¸»é¡Œé…ç½®-2</span></a></li><li><a class="site-page child" href="/posts/98d20436/"><span> â“ ä¸»é¡Œå•ç­”</span></a></li><li><a class="site-page child" href="/posts/4073eda/"><span> âš¡ï¸ é€²éšæ•™ç¨‹</span></a></li><li><a class="site-page child" href="/posts/198a4240/"><span> âœ¨ æ›´æ–°æ—¥èªŒ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> å¨›æ¨‚</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> åœ–åº«</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> é›»å½±</span></a></li><li><a class="site-page child" href="/talking/"><i class="fa-fw fas fa-cubes"></i><span> è‡ªè¨€è‡ªèª</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> ç¤ºä¾‹</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">JDBCæ ¸å¿ƒæŠ€æœ¯<a class="post-edit-link" href="https://github.com/jerryc127/butterfly.js.org/edit/main/source/_posts/JDBCæ ¸å¿ƒæŠ€æœ¯.md" title="ç¼–è¾‘" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">å‘è¡¨äº</span><time datetime="2020-10-08T07:57:44.000Z" title="undefined 2020-10-08 15:57:44">2020-10-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">æ•°æ®åº“</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">14.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>56åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="JDBCæ ¸å¿ƒæŠ€æœ¯"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><hr>
<blockquote>
<p>æ­¤ç¬”è®°æ˜¯è§‚çœ‹ <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV11J411c7sB?from=search&amp;seid=4044749892780872620">æ­¤è§†é¢‘</a>  åšçš„ç¬”è®°ï¼Œä¾›å­¦ä¹ å‚è€ƒç”¨ã€‚</p>
</blockquote>
<hr>
<h2 id="ç¬¬1ç« ï¼šJDBCæ¦‚è¿°"><a href="#ç¬¬1ç« ï¼šJDBCæ¦‚è¿°" class="headerlink" title="ç¬¬1ç« ï¼šJDBCæ¦‚è¿°"></a>ç¬¬1ç« ï¼šJDBCæ¦‚è¿°</h2><h3 id="1-1-æ•°æ®çš„æŒä¹…åŒ–"><a href="#1-1-æ•°æ®çš„æŒä¹…åŒ–" class="headerlink" title="1.1 æ•°æ®çš„æŒä¹…åŒ–"></a>1.1 æ•°æ®çš„æŒä¹…åŒ–</h3><ul>
<li><p>æŒä¹…åŒ–(persistence)ï¼š<strong>æŠŠæ•°æ®ä¿å­˜åˆ°å¯æ‰ç”µå¼å­˜å‚¨è®¾å¤‡ä¸­ä»¥ä¾›ä¹‹åä½¿ç”¨</strong>ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç‰¹åˆ«æ˜¯ä¼ä¸šçº§åº”ç”¨ï¼Œ<strong>æ•°æ®æŒä¹…åŒ–æ„å‘³ç€å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜</strong>ä¸ŠåŠ ä»¥â€å›ºåŒ–â€<strong>ï¼Œè€ŒæŒä¹…åŒ–çš„å®ç°è¿‡ç¨‹å¤§å¤šé€šè¿‡å„ç§å…³ç³»æ•°æ®åº“æ¥å®Œæˆ</strong>ã€‚</p>
</li>
<li><p>æŒä¹…åŒ–çš„ä¸»è¦åº”ç”¨æ˜¯å°†å†…å­˜ä¸­çš„æ•°æ®å­˜å‚¨åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å­˜å‚¨åœ¨ç£ç›˜æ–‡ä»¶ã€XMLæ•°æ®æ–‡ä»¶ä¸­ã€‚</p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566741430592.png" alt="1566741430592"> </p>
</li>
</ul>
<h3 id="1-2-Javaä¸­çš„æ•°æ®å­˜å‚¨æŠ€æœ¯"><a href="#1-2-Javaä¸­çš„æ•°æ®å­˜å‚¨æŠ€æœ¯" class="headerlink" title="1.2 Javaä¸­çš„æ•°æ®å­˜å‚¨æŠ€æœ¯"></a>1.2 Javaä¸­çš„æ•°æ®å­˜å‚¨æŠ€æœ¯</h3><ul>
<li><p>åœ¨Javaä¸­ï¼Œæ•°æ®åº“å­˜å–æŠ€æœ¯å¯åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼š</p>
<ul>
<li><p><strong>JDBC</strong>ç›´æ¥è®¿é—®æ•°æ®åº“</p>
</li>
<li><p>JDO (Java Data Object )æŠ€æœ¯</p>
</li>
<li><p><strong>ç¬¬ä¸‰æ–¹O/Rå·¥å…·</strong>ï¼Œå¦‚Hibernate, Mybatis ç­‰</p>
</li>
</ul>
</li>
<li><p>JDBCæ˜¯javaè®¿é—®æ•°æ®åº“çš„åŸºçŸ³ï¼ŒJDOã€Hibernateã€MyBatisç­‰åªæ˜¯æ›´å¥½çš„å°è£…äº†JDBCã€‚</p>
</li>
</ul>
<h3 id="1-3-JDBCä»‹ç»"><a href="#1-3-JDBCä»‹ç»" class="headerlink" title="1.3 JDBCä»‹ç»"></a>1.3 JDBCä»‹ç»</h3><ul>
<li>JDBC(Java Database Connectivity)æ˜¯ä¸€ä¸ª<strong>ç‹¬ç«‹äºç‰¹å®šæ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€é€šç”¨çš„SQLæ•°æ®åº“å­˜å–å’Œæ“ä½œçš„å…¬å…±æ¥å£</strong>ï¼ˆä¸€ç»„APIï¼‰ï¼Œå®šä¹‰äº†ç”¨æ¥è®¿é—®æ•°æ®åº“çš„æ ‡å‡†Javaç±»åº“ï¼Œï¼ˆ<strong>java.sql,javax.sql</strong>ï¼‰ä½¿ç”¨è¿™äº›ç±»åº“å¯ä»¥ä»¥ä¸€ç§<strong>æ ‡å‡†</strong>çš„æ–¹æ³•ã€æ–¹ä¾¿åœ°è®¿é—®æ•°æ®åº“èµ„æºã€‚</li>
<li>JDBCä¸ºè®¿é—®ä¸åŒçš„æ•°æ®åº“æä¾›äº†ä¸€ç§<strong>ç»Ÿä¸€çš„é€”å¾„</strong>ï¼Œä¸ºå¼€å‘è€…å±è”½äº†ä¸€äº›ç»†èŠ‚é—®é¢˜ã€‚</li>
<li>JDBCçš„ç›®æ ‡æ˜¯ä½¿Javaç¨‹åºå‘˜ä½¿ç”¨JDBCå¯ä»¥è¿æ¥ä»»ä½•<strong>æä¾›äº†JDBCé©±åŠ¨ç¨‹åº</strong>çš„æ•°æ®åº“ç³»ç»Ÿï¼Œè¿™æ ·å°±ä½¿å¾—ç¨‹åºå‘˜æ— éœ€å¯¹ç‰¹å®šçš„æ•°æ®åº“ç³»ç»Ÿçš„ç‰¹ç‚¹æœ‰è¿‡å¤šçš„äº†è§£ï¼Œä»è€Œå¤§å¤§ç®€åŒ–å’ŒåŠ å¿«äº†å¼€å‘è¿‡ç¨‹ã€‚</li>
<li>å¦‚æœæ²¡æœ‰JDBCï¼Œé‚£ä¹ˆJavaç¨‹åºè®¿é—®æ•°æ®åº“æ—¶æ˜¯è¿™æ ·çš„ï¼š</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555575760234.png" alt="1555575760234"></p>
<hr>
<ul>
<li>æœ‰äº†JDBCï¼ŒJavaç¨‹åºè®¿é—®æ•°æ®åº“æ—¶æ˜¯è¿™æ ·çš„ï¼š</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555575981203.png" alt="1555575981203"></p>
<hr>
<ul>
<li>æ€»ç»“å¦‚ä¸‹ï¼š</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566741692804.png" alt="1566741692804"></p>
<h3 id="1-4-JDBCä½“ç³»ç»“æ„"><a href="#1-4-JDBCä½“ç³»ç»“æ„" class="headerlink" title="1.4 JDBCä½“ç³»ç»“æ„"></a>1.4 JDBCä½“ç³»ç»“æ„</h3><ul>
<li>JDBCæ¥å£ï¼ˆAPIï¼‰åŒ…æ‹¬ä¸¤ä¸ªå±‚æ¬¡ï¼š<ul>
<li><strong>é¢å‘åº”ç”¨çš„API</strong>ï¼šJava APIï¼ŒæŠ½è±¡æ¥å£ï¼Œä¾›åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ä½¿ç”¨ï¼ˆè¿æ¥æ•°æ®åº“ï¼Œæ‰§è¡ŒSQLè¯­å¥ï¼Œè·å¾—ç»“æœï¼‰ã€‚</li>
<li><strong>é¢å‘æ•°æ®åº“çš„API</strong>ï¼šJava Driver APIï¼Œä¾›å¼€å‘å•†å¼€å‘æ•°æ®åº“é©±åŠ¨ç¨‹åºç”¨ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>JDBCæ˜¯sunå…¬å¸æä¾›ä¸€å¥—ç”¨äºæ•°æ®åº“æ“ä½œçš„æ¥å£ï¼Œjavaç¨‹åºå‘˜åªéœ€è¦é¢å‘è¿™å¥—æ¥å£ç¼–ç¨‹å³å¯ã€‚</strong></p>
<p><strong>ä¸åŒçš„æ•°æ®åº“å‚å•†ï¼Œéœ€è¦é’ˆå¯¹è¿™å¥—æ¥å£ï¼Œæä¾›ä¸åŒå®ç°ã€‚ä¸åŒçš„å®ç°çš„é›†åˆï¼Œå³ä¸ºä¸åŒæ•°æ®åº“çš„é©±åŠ¨ã€‚                                                                â€”â€”â€”â€”é¢å‘æ¥å£ç¼–ç¨‹</strong></p>
</blockquote>
<h3 id="1-5-JDBCç¨‹åºç¼–å†™æ­¥éª¤"><a href="#1-5-JDBCç¨‹åºç¼–å†™æ­¥éª¤" class="headerlink" title="1.5 JDBCç¨‹åºç¼–å†™æ­¥éª¤"></a>1.5 JDBCç¨‹åºç¼–å†™æ­¥éª¤</h3><p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1565969323908.png" alt="1565969323908"></p>
<blockquote>
<p>è¡¥å……ï¼šODBC(<strong>Open Database Connectivity</strong>ï¼Œå¼€æ”¾å¼æ•°æ®åº“è¿æ¥)ï¼Œæ˜¯å¾®è½¯åœ¨Windowså¹³å°ä¸‹æ¨å‡ºçš„ã€‚ä½¿ç”¨è€…åœ¨ç¨‹åºä¸­åªéœ€è¦è°ƒç”¨ODBC APIï¼Œç”± ODBC é©±åŠ¨ç¨‹åºå°†è°ƒç”¨è½¬æ¢æˆä¸ºå¯¹ç‰¹å®šçš„æ•°æ®åº“çš„è°ƒç”¨è¯·æ±‚ã€‚</p>
</blockquote>
<h2 id="ç¬¬2ç« ï¼šè·å–æ•°æ®åº“è¿æ¥"><a href="#ç¬¬2ç« ï¼šè·å–æ•°æ®åº“è¿æ¥" class="headerlink" title="ç¬¬2ç« ï¼šè·å–æ•°æ®åº“è¿æ¥"></a>ç¬¬2ç« ï¼šè·å–æ•°æ®åº“è¿æ¥</h2><h3 id="2-1-è¦ç´ ä¸€ï¼šDriveræ¥å£å®ç°ç±»"><a href="#2-1-è¦ç´ ä¸€ï¼šDriveræ¥å£å®ç°ç±»" class="headerlink" title="2.1 è¦ç´ ä¸€ï¼šDriveræ¥å£å®ç°ç±»"></a>2.1 è¦ç´ ä¸€ï¼šDriveræ¥å£å®ç°ç±»</h3><h4 id="2-1-1-Driveræ¥å£ä»‹ç»"><a href="#2-1-1-Driveræ¥å£ä»‹ç»" class="headerlink" title="2.1.1 Driveræ¥å£ä»‹ç»"></a>2.1.1 Driveræ¥å£ä»‹ç»</h4><ul>
<li><p>java.sql.Driver æ¥å£æ˜¯æ‰€æœ‰ JDBC é©±åŠ¨ç¨‹åºéœ€è¦å®ç°çš„æ¥å£ã€‚è¿™ä¸ªæ¥å£æ˜¯æä¾›ç»™æ•°æ®åº“å‚å•†ä½¿ç”¨çš„ï¼Œä¸åŒæ•°æ®åº“å‚å•†æä¾›ä¸åŒçš„å®ç°ã€‚</p>
</li>
<li><p>åœ¨ç¨‹åºä¸­ä¸éœ€è¦ç›´æ¥å»è®¿é—®å®ç°äº† Driver æ¥å£çš„ç±»ï¼Œè€Œæ˜¯ç”±é©±åŠ¨ç¨‹åºç®¡ç†å™¨ç±»(java.sql.DriverManager)å»è°ƒç”¨è¿™äº›Driverå®ç°ã€‚</p>
<ul>
<li>Oracleçš„é©±åŠ¨ï¼š<strong>oracle.jdbc.driver.OracleDriver</strong></li>
<li>mySqlçš„é©±åŠ¨ï¼š <strong>com.mysql.jdbc.Driver</strong></li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555576157618.png" alt="1555576157618"></p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566134718955.png" alt="1555576170074"></p>
<ul>
<li><p>å°†ä¸Šè¿°jaråŒ…æ‹·è´åˆ°Javaå·¥ç¨‹çš„ä¸€ä¸ªç›®å½•ä¸­ï¼Œä¹ æƒ¯ä¸Šæ–°å»ºä¸€ä¸ªlibæ–‡ä»¶å¤¹ã€‚</p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566134781682.png" alt="1566134718955"></p>
</li>
</ul>
<p>åœ¨é©±åŠ¨jarä¸Šå³é”®â€“&gt;Build Pathâ€“&gt;Add to Build Path</p>
<p> <img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566135290460.png" alt="1566134781682"></p>
<p>æ³¨æ„ï¼šå¦‚æœæ˜¯Dynamic Web Projectï¼ˆåŠ¨æ€çš„webé¡¹ç›®ï¼‰è¯ï¼Œåˆ™æ˜¯æŠŠé©±åŠ¨jaræ”¾åˆ°WebContentï¼ˆæœ‰çš„å¼€å‘å·¥å…·å«WebRootï¼‰ç›®å½•ä¸­çš„WEB-INFç›®å½•ä¸­çš„libç›®å½•ä¸‹å³å¯</p>
<p> <img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566136831283.png" alt="1566135290460"></p>
<h4 id="2-1-2-åŠ è½½ä¸æ³¨å†ŒJDBCé©±åŠ¨"><a href="#2-1-2-åŠ è½½ä¸æ³¨å†ŒJDBCé©±åŠ¨" class="headerlink" title="2.1.2 åŠ è½½ä¸æ³¨å†ŒJDBCé©±åŠ¨"></a>2.1.2 åŠ è½½ä¸æ³¨å†ŒJDBCé©±åŠ¨</h4><ul>
<li><p>åŠ è½½é©±åŠ¨ï¼šåŠ è½½ JDBC é©±åŠ¨éœ€è°ƒç”¨ Class ç±»çš„é™æ€æ–¹æ³• forName()ï¼Œå‘å…¶ä¼ é€’è¦åŠ è½½çš„ JDBC é©±åŠ¨çš„ç±»å</p>
<ul>
<li><strong>Class.forName(â€œcom.mysql.jdbc.Driverâ€);</strong></li>
</ul>
</li>
<li><p>æ³¨å†Œé©±åŠ¨ï¼šDriverManager ç±»æ˜¯é©±åŠ¨ç¨‹åºç®¡ç†å™¨ç±»ï¼Œè´Ÿè´£ç®¡ç†é©±åŠ¨ç¨‹åº</p>
<ul>
<li><p><strong>ä½¿ç”¨DriverManager.registerDriver(com.mysql.jdbc.Driver)æ¥æ³¨å†Œé©±åŠ¨</strong></p>
</li>
<li><p>é€šå¸¸ä¸ç”¨æ˜¾å¼è°ƒç”¨ DriverManager ç±»çš„ registerDriver() æ–¹æ³•æ¥æ³¨å†Œé©±åŠ¨ç¨‹åºç±»çš„å®ä¾‹ï¼Œå› ä¸º Driver æ¥å£çš„é©±åŠ¨ç¨‹åºç±»<strong>éƒ½</strong>åŒ…å«äº†é™æ€ä»£ç å—ï¼Œåœ¨è¿™ä¸ªé™æ€ä»£ç å—ä¸­ï¼Œä¼šè°ƒç”¨ DriverManager.registerDriver() æ–¹æ³•æ¥æ³¨å†Œè‡ªèº«çš„ä¸€ä¸ªå®ä¾‹ã€‚ä¸‹å›¾æ˜¯MySQLçš„Driverå®ç°ç±»çš„æºç ï¼š</p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555576170074.png" alt="1566136831283"></p>
</li>
</ul>
</li>
</ul>
<h3 id="2-2-è¦ç´ äºŒï¼šURL"><a href="#2-2-è¦ç´ äºŒï¼šURL" class="headerlink" title="2.2 è¦ç´ äºŒï¼šURL"></a>2.2 è¦ç´ äºŒï¼šURL</h3><ul>
<li><p>JDBC URL ç”¨äºæ ‡è¯†ä¸€ä¸ªè¢«æ³¨å†Œçš„é©±åŠ¨ç¨‹åºï¼Œé©±åŠ¨ç¨‹åºç®¡ç†å™¨é€šè¿‡è¿™ä¸ª URL é€‰æ‹©æ­£ç¡®çš„é©±åŠ¨ç¨‹åºï¼Œä»è€Œå»ºç«‹åˆ°æ•°æ®åº“çš„è¿æ¥ã€‚</p>
</li>
<li><p>JDBC URLçš„æ ‡å‡†ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå„éƒ¨åˆ†é—´ç”¨å†’å·åˆ†éš”ã€‚ </p>
<ul>
<li><strong>jdbc:å­åè®®:å­åç§°</strong></li>
<li><strong>åè®®</strong>ï¼šJDBC URLä¸­çš„åè®®æ€»æ˜¯jdbc </li>
<li><strong>å­åè®®</strong>ï¼šå­åè®®ç”¨äºæ ‡è¯†ä¸€ä¸ªæ•°æ®åº“é©±åŠ¨ç¨‹åº</li>
<li><strong>å­åç§°</strong>ï¼šä¸€ç§æ ‡è¯†æ•°æ®åº“çš„æ–¹æ³•ã€‚å­åç§°å¯ä»¥ä¾ä¸åŒçš„å­åè®®è€Œå˜åŒ–ï¼Œç”¨å­åç§°çš„ç›®çš„æ˜¯ä¸ºäº†<strong>å®šä½æ•°æ®åº“</strong>æä¾›è¶³å¤Ÿçš„ä¿¡æ¯ã€‚åŒ…å«<strong>ä¸»æœºå</strong>(å¯¹åº”æœåŠ¡ç«¯çš„ipåœ°å€)<strong>ï¼Œç«¯å£å·ï¼Œæ•°æ®åº“å</strong></li>
</ul>
</li>
<li><p>ä¸¾ä¾‹ï¼š</p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555576477107.png" alt="1555576477107"></p>
</li>
<li><p><strong>å‡ ç§å¸¸ç”¨æ•°æ®åº“çš„ JDBC URL</strong></p>
<ul>
<li><p>MySQLçš„è¿æ¥URLç¼–å†™æ–¹å¼ï¼š</p>
<ul>
<li>jdbc:mysql://ä¸»æœºåç§°:mysqlæœåŠ¡ç«¯å£å·/æ•°æ®åº“åç§°?å‚æ•°=å€¼&amp;å‚æ•°=å€¼</li>
<li>jdbc:mysql://localhost:3306/atguigu</li>
<li>jdbc:mysql://localhost:3306/atguigu<strong>?useUnicode=true&amp;characterEncoding=utf8</strong>ï¼ˆå¦‚æœJDBCç¨‹åºä¸æœåŠ¡å™¨ç«¯çš„å­—ç¬¦é›†ä¸ä¸€è‡´ï¼Œä¼šå¯¼è‡´ä¹±ç ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡å‚æ•°æŒ‡å®šæœåŠ¡å™¨ç«¯çš„å­—ç¬¦é›†ï¼‰</li>
<li>jdbc:mysql://localhost:3306/atguigu?user=root&amp;password=123456</li>
</ul>
</li>
<li><p>Oracle 9içš„è¿æ¥URLç¼–å†™æ–¹å¼ï¼š</p>
<ul>
<li>jdbc:oracle:thin:@ä¸»æœºåç§°:oracleæœåŠ¡ç«¯å£å·:æ•°æ®åº“åç§°</li>
<li>jdbc:oracle:thin:@localhost:1521:atguigu</li>
</ul>
</li>
<li><p>SQLServerçš„è¿æ¥URLç¼–å†™æ–¹å¼ï¼š</p>
<ul>
<li><p>jdbc:sqlserver://ä¸»æœºåç§°:sqlserveræœåŠ¡ç«¯å£å·:DatabaseName=æ•°æ®åº“åç§°</p>
</li>
<li><p>jdbc:sqlserver://localhost:1433:DatabaseName=atguigu</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="2-3-è¦ç´ ä¸‰ï¼šç”¨æˆ·åå’Œå¯†ç "><a href="#2-3-è¦ç´ ä¸‰ï¼šç”¨æˆ·åå’Œå¯†ç " class="headerlink" title="2.3 è¦ç´ ä¸‰ï¼šç”¨æˆ·åå’Œå¯†ç "></a>2.3 è¦ç´ ä¸‰ï¼šç”¨æˆ·åå’Œå¯†ç </h3><ul>
<li>user,passwordå¯ä»¥ç”¨â€œå±æ€§å=å±æ€§å€¼â€æ–¹å¼å‘Šè¯‰æ•°æ®åº“</li>
<li>å¯ä»¥è°ƒç”¨ DriverManager ç±»çš„ getConnection() æ–¹æ³•å»ºç«‹åˆ°æ•°æ®åº“çš„è¿æ¥</li>
</ul>
<h3 id="2-4-æ•°æ®åº“è¿æ¥æ–¹å¼ä¸¾ä¾‹"><a href="#2-4-æ•°æ®åº“è¿æ¥æ–¹å¼ä¸¾ä¾‹" class="headerlink" title="2.4 æ•°æ®åº“è¿æ¥æ–¹å¼ä¸¾ä¾‹"></a>2.4 æ•°æ®åº“è¿æ¥æ–¹å¼ä¸¾ä¾‹</h3><h4 id="2-4-1-è¿æ¥æ–¹å¼ä¸€"><a href="#2-4-1-è¿æ¥æ–¹å¼ä¸€" class="headerlink" title="2.4.1 è¿æ¥æ–¹å¼ä¸€"></a>2.4.1 è¿æ¥æ–¹å¼ä¸€</h4><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testConnection1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//1.æä¾›java.sql.Driveræ¥å£å®ç°ç±»çš„å¯¹è±¡</span>
            Driver driver <span class="token operator">=</span> null<span class="token punctuation">;</span>
            driver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//2.æä¾›urlï¼ŒæŒ‡æ˜å…·ä½“æ“ä½œçš„æ•°æ®</span>
            String url <span class="token operator">=</span> <span class="token string">"jdbc:mysql://localhost:3306/test"</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//3.æä¾›Propertiesçš„å¯¹è±¡ï¼ŒæŒ‡æ˜ç”¨æˆ·åå’Œå¯†ç </span>
            Properties info <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            info<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            info<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">,</span> <span class="token string">"abc123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//4.è°ƒç”¨driverçš„connect()ï¼Œè·å–è¿æ¥</span>
            Connection conn <span class="token operator">=</span> driver<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¯´æ˜ï¼šä¸Šè¿°ä»£ç ä¸­æ˜¾å¼å‡ºç°äº†ç¬¬ä¸‰æ–¹æ•°æ®åº“çš„API</p>
</blockquote>
<h4 id="2-4-2-è¿æ¥æ–¹å¼äºŒ"><a href="#2-4-2-è¿æ¥æ–¹å¼äºŒ" class="headerlink" title="2.4.2 è¿æ¥æ–¹å¼äºŒ"></a>2.4.2 è¿æ¥æ–¹å¼äºŒ</h4><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testConnection2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//1.å®ä¾‹åŒ–Driver</span>
            String className <span class="token operator">=</span> <span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">;</span>
            Class <span class="token class-name">clazz</span> <span class="token operator">=</span> Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Driver driver <span class="token operator">=</span> <span class="token punctuation">(</span>Driver<span class="token punctuation">)</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//2.æä¾›urlï¼ŒæŒ‡æ˜å…·ä½“æ“ä½œçš„æ•°æ®</span>
            String url <span class="token operator">=</span> <span class="token string">"jdbc:mysql://localhost:3306/test"</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//3.æä¾›Propertiesçš„å¯¹è±¡ï¼ŒæŒ‡æ˜ç”¨æˆ·åå’Œå¯†ç </span>
            Properties info <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            info<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            info<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">,</span> <span class="token string">"abc123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//4.è°ƒç”¨driverçš„connect()ï¼Œè·å–è¿æ¥</span>
            Connection conn <span class="token operator">=</span> driver<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¯´æ˜ï¼šç›¸è¾ƒäºæ–¹å¼ä¸€ï¼Œè¿™é‡Œä½¿ç”¨åå°„å®ä¾‹åŒ–Driverï¼Œä¸åœ¨ä»£ç ä¸­ä½“ç°ç¬¬ä¸‰æ–¹æ•°æ®åº“çš„APIã€‚ä½“ç°äº†é¢å‘æ¥å£ç¼–ç¨‹æ€æƒ³ã€‚</p>
</blockquote>
<h4 id="2-4-3-è¿æ¥æ–¹å¼ä¸‰"><a href="#2-4-3-è¿æ¥æ–¹å¼ä¸‰" class="headerlink" title="2.4.3 è¿æ¥æ–¹å¼ä¸‰"></a>2.4.3 è¿æ¥æ–¹å¼ä¸‰</h4><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//1.æ•°æ®åº“è¿æ¥çš„4ä¸ªåŸºæœ¬è¦ç´ ï¼š</span>
            String url <span class="token operator">=</span> <span class="token string">"jdbc:mysql://localhost:3306/test"</span><span class="token punctuation">;</span>
            String user <span class="token operator">=</span> <span class="token string">"root"</span><span class="token punctuation">;</span>
            String password <span class="token operator">=</span> <span class="token string">"abc123"</span><span class="token punctuation">;</span>
            String driverName <span class="token operator">=</span> <span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//2.å®ä¾‹åŒ–Driver</span>
            Class <span class="token class-name">clazz</span> <span class="token operator">=</span> Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Driver driver <span class="token operator">=</span> <span class="token punctuation">(</span>Driver<span class="token punctuation">)</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//3.æ³¨å†Œé©±åŠ¨</span>
            DriverManager<span class="token punctuation">.</span><span class="token function">registerDriver</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//4.è·å–è¿æ¥</span>
            Connection conn <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> user<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¯´æ˜ï¼šä½¿ç”¨DriverManagerå®ç°æ•°æ®åº“çš„è¿æ¥ã€‚ä½“ä¼šè·å–è¿æ¥å¿…è¦çš„4ä¸ªåŸºæœ¬è¦ç´ ã€‚</p>
</blockquote>
<h4 id="2-4-4-è¿æ¥æ–¹å¼å››"><a href="#2-4-4-è¿æ¥æ–¹å¼å››" class="headerlink" title="2.4.4 è¿æ¥æ–¹å¼å››"></a>2.4.4 è¿æ¥æ–¹å¼å››</h4><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testConnection4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//1.æ•°æ®åº“è¿æ¥çš„4ä¸ªåŸºæœ¬è¦ç´ ï¼š</span>
            String url <span class="token operator">=</span> <span class="token string">"jdbc:mysql://localhost:3306/test"</span><span class="token punctuation">;</span>
            String user <span class="token operator">=</span> <span class="token string">"root"</span><span class="token punctuation">;</span>
            String password <span class="token operator">=</span> <span class="token string">"abc123"</span><span class="token punctuation">;</span>
            String driverName <span class="token operator">=</span> <span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//2.åŠ è½½é©±åŠ¨ ï¼ˆâ‘ å®ä¾‹åŒ–Driver â‘¡æ³¨å†Œé©±åŠ¨ï¼‰</span>
            Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverName<span class="token punctuation">)</span><span class="token punctuation">;</span>


            <span class="token comment" spellcheck="true">//Driver driver = (Driver) clazz.newInstance();</span>
            <span class="token comment" spellcheck="true">//3.æ³¨å†Œé©±åŠ¨</span>
            <span class="token comment" spellcheck="true">//DriverManager.registerDriver(driver);</span>
            <span class="token comment" spellcheck="true">/*
            å¯ä»¥æ³¨é‡Šæ‰ä¸Šè¿°ä»£ç çš„åŸå› ï¼Œæ˜¯å› ä¸ºåœ¨mysqlçš„Driverç±»ä¸­å£°æ˜æœ‰ï¼š
            static {
                try {
                    DriverManager.registerDriver(new Driver());
                } catch (SQLException var1) {
                    throw new RuntimeException("Can't register driver!");
                }
            }

             */</span>


            <span class="token comment" spellcheck="true">//3.è·å–è¿æ¥</span>
            Connection conn <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> user<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¯´æ˜ï¼šä¸å¿…æ˜¾å¼çš„æ³¨å†Œé©±åŠ¨äº†ã€‚å› ä¸ºåœ¨DriverManagerçš„æºç ä¸­å·²ç»å­˜åœ¨é™æ€ä»£ç å—ï¼Œå®ç°äº†é©±åŠ¨çš„æ³¨å†Œã€‚</p>
</blockquote>
<h4 id="2-4-5-è¿æ¥æ–¹å¼äº”-æœ€ç»ˆç‰ˆ"><a href="#2-4-5-è¿æ¥æ–¹å¼äº”-æœ€ç»ˆç‰ˆ" class="headerlink" title="2.4.5 è¿æ¥æ–¹å¼äº”(æœ€ç»ˆç‰ˆ)"></a>2.4.5 è¿æ¥æ–¹å¼äº”(æœ€ç»ˆç‰ˆ)</h4><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span>  <span class="token keyword">void</span> <span class="token function">testConnection5</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//1.åŠ è½½é…ç½®æ–‡ä»¶</span>
        InputStream is <span class="token operator">=</span> ConnectionTest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"jdbc.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Properties pros <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pros<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">//2.è¯»å–é…ç½®ä¿¡æ¯</span>
        String user <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        String password <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        String url <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        String driverClass <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"driverClass"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">//3.åŠ è½½é©±åŠ¨</span>
        Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverClass<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">//4.è·å–è¿æ¥</span>
        Connection conn <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>user<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶ä¸­ï¼Œé…ç½®æ–‡ä»¶å£°æ˜åœ¨å·¥ç¨‹çš„srcç›®å½•ä¸‹ï¼šã€jdbc.propertiesã€‘</p>
<pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">user</span><span class="token punctuation">=</span><span class="token attr-value">root</span>
<span class="token attr-name">password</span><span class="token punctuation">=</span><span class="token attr-value">abc123</span>
<span class="token attr-name">url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost:3306/test</span>
<span class="token attr-name">driverClass</span><span class="token punctuation">=</span><span class="token attr-value">com.mysql.jdbc.Driver</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¯´æ˜ï¼šä½¿ç”¨é…ç½®æ–‡ä»¶çš„æ–¹å¼ä¿å­˜é…ç½®ä¿¡æ¯ï¼Œåœ¨ä»£ç ä¸­åŠ è½½é…ç½®æ–‡ä»¶</p>
<p><strong>ä½¿ç”¨é…ç½®æ–‡ä»¶çš„å¥½å¤„ï¼š</strong></p>
<p>â‘ å®ç°äº†ä»£ç å’Œæ•°æ®çš„åˆ†ç¦»ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹é…ç½®ä¿¡æ¯ï¼Œç›´æ¥åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ï¼Œä¸éœ€è¦æ·±å…¥ä»£ç <br>â‘¡å¦‚æœä¿®æ”¹äº†é…ç½®ä¿¡æ¯ï¼Œçœå»é‡æ–°ç¼–è¯‘çš„è¿‡ç¨‹ã€‚</p>
</blockquote>
<h2 id="ç¬¬3ç« ï¼šä½¿ç”¨PreparedStatementå®ç°CRUDæ“ä½œ"><a href="#ç¬¬3ç« ï¼šä½¿ç”¨PreparedStatementå®ç°CRUDæ“ä½œ" class="headerlink" title="ç¬¬3ç« ï¼šä½¿ç”¨PreparedStatementå®ç°CRUDæ“ä½œ"></a>ç¬¬3ç« ï¼šä½¿ç”¨PreparedStatementå®ç°CRUDæ“ä½œ</h2><h3 id="3-1-æ“ä½œå’Œè®¿é—®æ•°æ®åº“"><a href="#3-1-æ“ä½œå’Œè®¿é—®æ•°æ®åº“" class="headerlink" title="3.1 æ“ä½œå’Œè®¿é—®æ•°æ®åº“"></a>3.1 æ“ä½œå’Œè®¿é—®æ•°æ®åº“</h3><ul>
<li><p>æ•°æ®åº“è¿æ¥è¢«ç”¨äºå‘æ•°æ®åº“æœåŠ¡å™¨å‘é€å‘½ä»¤å’Œ SQL è¯­å¥ï¼Œå¹¶æ¥å—æ•°æ®åº“æœåŠ¡å™¨è¿”å›çš„ç»“æœã€‚å…¶å®ä¸€ä¸ªæ•°æ®åº“è¿æ¥å°±æ˜¯ä¸€ä¸ªSocketè¿æ¥ã€‚</p>
</li>
<li><p>åœ¨ java.sql åŒ…ä¸­æœ‰ 3 ä¸ªæ¥å£åˆ†åˆ«å®šä¹‰äº†å¯¹æ•°æ®åº“çš„è°ƒç”¨çš„ä¸åŒæ–¹å¼ï¼š</p>
<ul>
<li>Statementï¼šç”¨äºæ‰§è¡Œé™æ€ SQL è¯­å¥å¹¶è¿”å›å®ƒæ‰€ç”Ÿæˆç»“æœçš„å¯¹è±¡ã€‚ </li>
<li>PrepatedStatementï¼šSQL è¯­å¥è¢«é¢„ç¼–è¯‘å¹¶å­˜å‚¨åœ¨æ­¤å¯¹è±¡ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ­¤å¯¹è±¡å¤šæ¬¡é«˜æ•ˆåœ°æ‰§è¡Œè¯¥è¯­å¥ã€‚</li>
<li>CallableStatementï¼šç”¨äºæ‰§è¡Œ SQL å­˜å‚¨è¿‡ç¨‹</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566573842140.png" alt="1566573842140"></p>
</li>
</ul>
<h3 id="3-2-ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨çš„å¼Šç«¯"><a href="#3-2-ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨çš„å¼Šç«¯" class="headerlink" title="3.2 ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨çš„å¼Šç«¯"></a>3.2 ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨çš„å¼Šç«¯</h3><ul>
<li><p>é€šè¿‡è°ƒç”¨ Connection å¯¹è±¡çš„ createStatement() æ–¹æ³•åˆ›å»ºè¯¥å¯¹è±¡ã€‚è¯¥å¯¹è±¡ç”¨äºæ‰§è¡Œé™æ€çš„ SQL è¯­å¥ï¼Œå¹¶ä¸”è¿”å›æ‰§è¡Œç»“æœã€‚</p>
</li>
<li><p>Statement æ¥å£ä¸­å®šä¹‰äº†ä¸‹åˆ—æ–¹æ³•ç”¨äºæ‰§è¡Œ SQL è¯­å¥ï¼š</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">int</span> excuteUpdate<span class="token punctuation">(</span>String sql<span class="token punctuation">)</span>ï¼šæ‰§è¡Œæ›´æ–°æ“ä½œ<span class="token keyword">INSERT</span>ã€<span class="token keyword">UPDATE</span>ã€<span class="token keyword">DELETE</span>
ResultSet executeQuery<span class="token punctuation">(</span>String sql<span class="token punctuation">)</span>ï¼šæ‰§è¡ŒæŸ¥è¯¢æ“ä½œ<span class="token keyword">SELECT</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>ä½†æ˜¯ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨å­˜åœ¨å¼Šç«¯ï¼š</p>
<ul>
<li><strong>é—®é¢˜ä¸€ï¼šå­˜åœ¨æ‹¼ä¸²æ“ä½œï¼Œç¹ç</strong></li>
<li><strong>é—®é¢˜äºŒï¼šå­˜åœ¨SQLæ³¨å…¥é—®é¢˜</strong></li>
</ul>
</li>
<li><p>SQL æ³¨å…¥æ˜¯åˆ©ç”¨æŸäº›ç³»ç»Ÿæ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¿›è¡Œå……åˆ†çš„æ£€æŸ¥ï¼Œè€Œåœ¨ç”¨æˆ·è¾“å…¥æ•°æ®ä¸­æ³¨å…¥éæ³•çš„ SQL è¯­å¥æ®µæˆ–å‘½ä»¤(å¦‚ï¼šSELECT user, password FROM user_table WHERE user=â€™aâ€™ OR 1 = â€˜ AND password = â€˜ OR â€˜1â€™ = â€˜1â€™) ï¼Œä»è€Œåˆ©ç”¨ç³»ç»Ÿçš„ SQL å¼•æ“å®Œæˆæ¶æ„è¡Œä¸ºçš„åšæ³•ã€‚</p>
</li>
<li><p>å¯¹äº Java è€Œè¨€ï¼Œè¦é˜²èŒƒ SQL æ³¨å…¥ï¼Œåªè¦ç”¨ PreparedStatement(ä»Statementæ‰©å±•è€Œæ¥) å–ä»£ Statement å°±å¯ä»¥äº†ã€‚</p>
</li>
<li><p>ä»£ç æ¼”ç¤ºï¼š</p>
</li>
</ul>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StatementTest</span> <span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">// ä½¿ç”¨Statementçš„å¼Šç«¯ï¼šéœ€è¦æ‹¼å†™sqlè¯­å¥ï¼Œå¹¶ä¸”å­˜åœ¨SQLæ³¨å…¥çš„é—®é¢˜</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Scanner scan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ç”¨æˆ·åï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        String userName <span class="token operator">=</span> scan<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"å¯†   ç ï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        String password <span class="token operator">=</span> scan<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// SELECT user,password FROM user_table WHERE USER = '1' or ' AND PASSWORD = '='1' or '1' = '1';</span>
        String sql <span class="token operator">=</span> <span class="token string">"SELECT user,password FROM user_table WHERE USER = '"</span> <span class="token operator">+</span> userName <span class="token operator">+</span> <span class="token string">"' AND PASSWORD = '"</span> <span class="token operator">+</span> password
                <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">;</span>
        User user <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> User<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç™»é™†æˆåŠŸ!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// ä½¿ç”¨Statementå®ç°å¯¹æ•°æ®è¡¨çš„æŸ¥è¯¢æ“ä½œ</span>
    <span class="token keyword">public</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> T <span class="token function">get</span><span class="token punctuation">(</span>String sql<span class="token punctuation">,</span> Class<span class="token operator">&lt;</span>T<span class="token operator">></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        T t <span class="token operator">=</span> null<span class="token punctuation">;</span>

        Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>
        Statement st <span class="token operator">=</span> null<span class="token punctuation">;</span>
        ResultSet rs <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 1.åŠ è½½é…ç½®æ–‡ä»¶</span>
            InputStream is <span class="token operator">=</span> StatementTest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"jdbc.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Properties pros <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            pros<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// 2.è¯»å–é…ç½®ä¿¡æ¯</span>
            String user <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            String password <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            String url <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            String driverClass <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"driverClass"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// 3.åŠ è½½é©±åŠ¨</span>
            Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverClass<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// 4.è·å–è¿æ¥</span>
            conn <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> user<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>

            st <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            rs <span class="token operator">=</span> st<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// è·å–ç»“æœé›†çš„å…ƒæ•°æ®</span>
            ResultSetMetaData rsmd <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// è·å–ç»“æœé›†çš„åˆ—æ•°</span>
            <span class="token keyword">int</span> columnCount <span class="token operator">=</span> rsmd<span class="token punctuation">.</span><span class="token function">getColumnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                t <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> columnCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">// //1. è·å–åˆ—çš„åç§°</span>
                    <span class="token comment" spellcheck="true">// String columnName = rsmd.getColumnName(i+1);</span>

                    <span class="token comment" spellcheck="true">// 1. è·å–åˆ—çš„åˆ«å</span>
                    String columnName <span class="token operator">=</span> rsmd<span class="token punctuation">.</span><span class="token function">getColumnLabel</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment" spellcheck="true">// 2. æ ¹æ®åˆ—åè·å–å¯¹åº”æ•°æ®è¡¨ä¸­çš„æ•°æ®</span>
                    Object columnVal <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment" spellcheck="true">// 3. å°†æ•°æ®è¡¨ä¸­å¾—åˆ°çš„æ•°æ®ï¼Œå°è£…è¿›å¯¹è±¡</span>
                    Field field <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    field<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> columnVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> t<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// å…³é—­èµ„æº</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>rs <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>st <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    st<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>conn <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç»¼ä¸Šï¼š</p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566569819744.png" alt="1566569819744"></p>
<h3 id="3-3-PreparedStatementçš„ä½¿ç”¨"><a href="#3-3-PreparedStatementçš„ä½¿ç”¨" class="headerlink" title="3.3 PreparedStatementçš„ä½¿ç”¨"></a>3.3 PreparedStatementçš„ä½¿ç”¨</h3><h4 id="3-3-1-PreparedStatementä»‹ç»"><a href="#3-3-1-PreparedStatementä»‹ç»" class="headerlink" title="3.3.1 PreparedStatementä»‹ç»"></a>3.3.1 PreparedStatementä»‹ç»</h4><ul>
<li><p>å¯ä»¥é€šè¿‡è°ƒç”¨ Connection å¯¹è±¡çš„ <strong>preparedStatement(String sql)</strong> æ–¹æ³•è·å– PreparedStatement å¯¹è±¡</p>
</li>
<li><p><strong>PreparedStatement æ¥å£æ˜¯ Statement çš„å­æ¥å£ï¼Œå®ƒè¡¨ç¤ºä¸€æ¡é¢„ç¼–è¯‘è¿‡çš„ SQL è¯­å¥</strong></p>
</li>
<li><p>PreparedStatement å¯¹è±¡æ‰€ä»£è¡¨çš„ SQL è¯­å¥ä¸­çš„å‚æ•°ç”¨é—®å·(?)æ¥è¡¨ç¤ºï¼Œè°ƒç”¨ PreparedStatement å¯¹è±¡çš„ setXxx() æ–¹æ³•æ¥è®¾ç½®è¿™äº›å‚æ•°. setXxx() æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦è®¾ç½®çš„ SQL è¯­å¥ä¸­çš„å‚æ•°çš„ç´¢å¼•(ä» 1 å¼€å§‹)ï¼Œç¬¬äºŒä¸ªæ˜¯è®¾ç½®çš„ SQL è¯­å¥ä¸­çš„å‚æ•°çš„å€¼</p>
</li>
</ul>
<h4 id="3-3-2-PreparedStatement-vs-Statement"><a href="#3-3-2-PreparedStatement-vs-Statement" class="headerlink" title="3.3.2 PreparedStatement vs Statement"></a>3.3.2 PreparedStatement vs Statement</h4><ul>
<li><p>ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
</li>
<li><p><strong>PreparedStatement èƒ½æœ€å¤§å¯èƒ½æé«˜æ€§èƒ½ï¼š</strong></p>
<ul>
<li>DBServerä¼šå¯¹<strong>é¢„ç¼–è¯‘</strong>è¯­å¥æä¾›æ€§èƒ½ä¼˜åŒ–ã€‚å› ä¸ºé¢„ç¼–è¯‘è¯­å¥æœ‰å¯èƒ½è¢«é‡å¤è°ƒç”¨ï¼Œæ‰€ä»¥<u>è¯­å¥åœ¨è¢«DBServerçš„ç¼–è¯‘å™¨ç¼–è¯‘åçš„æ‰§è¡Œä»£ç è¢«ç¼“å­˜ä¸‹æ¥ï¼Œé‚£ä¹ˆä¸‹æ¬¡è°ƒç”¨æ—¶åªè¦æ˜¯ç›¸åŒçš„é¢„ç¼–è¯‘è¯­å¥å°±ä¸éœ€è¦ç¼–è¯‘ï¼Œåªè¦å°†å‚æ•°ç›´æ¥ä¼ å…¥ç¼–è¯‘è¿‡çš„è¯­å¥æ‰§è¡Œä»£ç ä¸­å°±ä¼šå¾—åˆ°æ‰§è¡Œã€‚</u></li>
<li>åœ¨statementè¯­å¥ä¸­,å³ä½¿æ˜¯ç›¸åŒæ“ä½œä½†å› ä¸ºæ•°æ®å†…å®¹ä¸ä¸€æ ·,æ‰€ä»¥æ•´ä¸ªè¯­å¥æœ¬èº«ä¸èƒ½åŒ¹é…,æ²¡æœ‰ç¼“å­˜è¯­å¥çš„æ„ä¹‰.äº‹å®æ˜¯æ²¡æœ‰æ•°æ®åº“ä¼šå¯¹æ™®é€šè¯­å¥ç¼–è¯‘åçš„æ‰§è¡Œä»£ç ç¼“å­˜ã€‚è¿™æ ·<u>æ¯æ‰§è¡Œä¸€æ¬¡éƒ½è¦å¯¹ä¼ å…¥çš„è¯­å¥ç¼–è¯‘ä¸€æ¬¡ã€‚</u></li>
<li>(è¯­æ³•æ£€æŸ¥ï¼Œè¯­ä¹‰æ£€æŸ¥ï¼Œç¿»è¯‘æˆäºŒè¿›åˆ¶å‘½ä»¤ï¼Œç¼“å­˜)</li>
</ul>
</li>
<li><p>PreparedStatement å¯ä»¥é˜²æ­¢ SQL æ³¨å…¥ </p>
</li>
</ul>
<h4 id="3-3-3-Javaä¸SQLå¯¹åº”æ•°æ®ç±»å‹è½¬æ¢è¡¨"><a href="#3-3-3-Javaä¸SQLå¯¹åº”æ•°æ®ç±»å‹è½¬æ¢è¡¨" class="headerlink" title="3.3.3 Javaä¸SQLå¯¹åº”æ•°æ®ç±»å‹è½¬æ¢è¡¨"></a>3.3.3 Javaä¸SQLå¯¹åº”æ•°æ®ç±»å‹è½¬æ¢è¡¨</h4><table>
<thead>
<tr>
<th>Javaç±»å‹</th>
<th>SQLç±»å‹</th>
</tr>
</thead>
<tbody><tr>
<td>boolean</td>
<td>BIT</td>
</tr>
<tr>
<td>byte</td>
<td>TINYINT</td>
</tr>
<tr>
<td>short</td>
<td>SMALLINT</td>
</tr>
<tr>
<td>int</td>
<td>INTEGER</td>
</tr>
<tr>
<td>long</td>
<td>BIGINT</td>
</tr>
<tr>
<td>String</td>
<td>CHAR,VARCHAR,LONGVARCHAR</td>
</tr>
<tr>
<td>byte   array</td>
<td>BINARY  ,    VAR BINARY</td>
</tr>
<tr>
<td>java.sql.Date</td>
<td>DATE</td>
</tr>
<tr>
<td>java.sql.Time</td>
<td>TIME</td>
</tr>
<tr>
<td>java.sql.Timestamp</td>
<td>TIMESTAMP</td>
</tr>
</tbody></table>
<h4 id="3-3-4-ä½¿ç”¨PreparedStatementå®ç°å¢ã€åˆ ã€æ”¹æ“ä½œ"><a href="#3-3-4-ä½¿ç”¨PreparedStatementå®ç°å¢ã€åˆ ã€æ”¹æ“ä½œ" class="headerlink" title="3.3.4 ä½¿ç”¨PreparedStatementå®ç°å¢ã€åˆ ã€æ”¹æ“ä½œ"></a>3.3.4 ä½¿ç”¨PreparedStatementå®ç°å¢ã€åˆ ã€æ”¹æ“ä½œ</h4><pre class="line-numbers language-java"><code class="language-java">    <span class="token comment" spellcheck="true">//é€šç”¨çš„å¢ã€åˆ ã€æ”¹æ“ä½œï¼ˆä½“ç°ä¸€ï¼šå¢ã€åˆ ã€æ”¹ ï¼› ä½“ç°äºŒï¼šé’ˆå¯¹äºä¸åŒçš„è¡¨ï¼‰</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span>String sql<span class="token punctuation">,</span>Object <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>
        PreparedStatement ps <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//1.è·å–æ•°æ®åº“çš„è¿æ¥</span>
            conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//2.è·å–PreparedStatementçš„å®ä¾‹ (æˆ–ï¼šé¢„ç¼–è¯‘sqlè¯­å¥)</span>
            ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//3.å¡«å……å ä½ç¬¦</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> args<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                ps<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment" spellcheck="true">//4.æ‰§è¡Œsqlè¯­å¥</span>
            ps<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span><span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//5.å…³é—­èµ„æº</span>
            JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="3-3-5-ä½¿ç”¨PreparedStatementå®ç°æŸ¥è¯¢æ“ä½œ"><a href="#3-3-5-ä½¿ç”¨PreparedStatementå®ç°æŸ¥è¯¢æ“ä½œ" class="headerlink" title="3.3.5 ä½¿ç”¨PreparedStatementå®ç°æŸ¥è¯¢æ“ä½œ"></a>3.3.5 ä½¿ç”¨PreparedStatementå®ç°æŸ¥è¯¢æ“ä½œ</h4><pre class="line-numbers language-java"><code class="language-java">    <span class="token comment" spellcheck="true">// é€šç”¨çš„é’ˆå¯¹äºä¸åŒè¡¨çš„æŸ¥è¯¢:è¿”å›ä¸€ä¸ªå¯¹è±¡ (version 1.0)</span>
    <span class="token keyword">public</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> T <span class="token function">getInstance</span><span class="token punctuation">(</span>Class<span class="token operator">&lt;</span>T<span class="token operator">></span> clazz<span class="token punctuation">,</span> String sql<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>
        PreparedStatement ps <span class="token operator">=</span> null<span class="token punctuation">;</span>
        ResultSet rs <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 1.è·å–æ•°æ®åº“è¿æ¥</span>
            conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// 2.é¢„ç¼–è¯‘sqlè¯­å¥ï¼Œå¾—åˆ°PreparedStatementå¯¹è±¡</span>
            ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// 3.å¡«å……å ä½ç¬¦</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> args<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                ps<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment" spellcheck="true">// 4.æ‰§è¡ŒexecuteQuery(),å¾—åˆ°ç»“æœé›†ï¼šResultSet</span>
            rs <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// 5.å¾—åˆ°ç»“æœé›†çš„å…ƒæ•°æ®ï¼šResultSetMetaData</span>
            ResultSetMetaData rsmd <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// 6.1é€šè¿‡ResultSetMetaDataå¾—åˆ°columnCount,columnLabelï¼›é€šè¿‡ResultSetå¾—åˆ°åˆ—å€¼</span>
            <span class="token keyword">int</span> columnCount <span class="token operator">=</span> rsmd<span class="token punctuation">.</span><span class="token function">getColumnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                T t <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> columnCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">// éå†æ¯ä¸€ä¸ªåˆ—</span>

                    <span class="token comment" spellcheck="true">// è·å–åˆ—å€¼</span>
                    Object columnVal <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// è·å–åˆ—çš„åˆ«å:åˆ—çš„åˆ«åï¼Œä½¿ç”¨ç±»çš„å±æ€§åå……å½“</span>
                    String columnLabel <span class="token operator">=</span> rsmd<span class="token punctuation">.</span><span class="token function">getColumnLabel</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// 6.2ä½¿ç”¨åå°„ï¼Œç»™å¯¹è±¡çš„ç›¸åº”å±æ€§èµ‹å€¼</span>
                    Field field <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span>columnLabel<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    field<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> columnVal<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> t<span class="token punctuation">;</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 7.å…³é—­èµ„æº</span>
            JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">,</span> rs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> null<span class="token punctuation">;</span>

    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¯´æ˜ï¼šä½¿ç”¨PreparedStatementå®ç°çš„æŸ¥è¯¢æ“ä½œå¯ä»¥æ›¿æ¢Statementå®ç°çš„æŸ¥è¯¢æ“ä½œï¼Œè§£å†³Statementæ‹¼ä¸²å’ŒSQLæ³¨å…¥é—®é¢˜ã€‚</p>
</blockquote>
<h3 id="3-4-ResultSetä¸ResultSetMetaData"><a href="#3-4-ResultSetä¸ResultSetMetaData" class="headerlink" title="3.4 ResultSetä¸ResultSetMetaData"></a>3.4 ResultSetä¸ResultSetMetaData</h3><h4 id="3-4-1-ResultSet"><a href="#3-4-1-ResultSet" class="headerlink" title="3.4.1 ResultSet"></a>3.4.1 ResultSet</h4><ul>
<li><p>æŸ¥è¯¢éœ€è¦è°ƒç”¨PreparedStatement çš„ executeQuery() æ–¹æ³•ï¼ŒæŸ¥è¯¢ç»“æœæ˜¯ä¸€ä¸ªResultSet å¯¹è±¡</p>
</li>
<li><p>ResultSet å¯¹è±¡ä»¥é€»è¾‘è¡¨æ ¼çš„å½¢å¼å°è£…äº†æ‰§è¡Œæ•°æ®åº“æ“ä½œçš„ç»“æœé›†ï¼ŒResultSet æ¥å£ç”±æ•°æ®åº“å‚å•†æä¾›å®ç°</p>
</li>
<li><p>ResultSet è¿”å›çš„å®é™…ä¸Šå°±æ˜¯ä¸€å¼ æ•°æ®è¡¨ã€‚æœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘æ•°æ®è¡¨çš„ç¬¬ä¸€æ¡è®°å½•çš„å‰é¢ã€‚</p>
</li>
<li><p>ResultSet å¯¹è±¡ç»´æŠ¤äº†ä¸€ä¸ªæŒ‡å‘å½“å‰æ•°æ®è¡Œçš„<strong>æ¸¸æ ‡</strong>ï¼Œåˆå§‹çš„æ—¶å€™ï¼Œæ¸¸æ ‡åœ¨ç¬¬ä¸€è¡Œä¹‹å‰ï¼Œå¯ä»¥é€šè¿‡ ResultSet å¯¹è±¡çš„ next() æ–¹æ³•ç§»åŠ¨åˆ°ä¸‹ä¸€è¡Œã€‚è°ƒç”¨ next()æ–¹æ³•æ£€æµ‹ä¸‹ä¸€è¡Œæ˜¯å¦æœ‰æ•ˆã€‚è‹¥æœ‰æ•ˆï¼Œè¯¥æ–¹æ³•è¿”å› trueï¼Œä¸”æŒ‡é’ˆä¸‹ç§»ã€‚ç›¸å½“äºIteratorå¯¹è±¡çš„ hasNext() å’Œ next() æ–¹æ³•çš„ç»“åˆä½“ã€‚</p>
</li>
<li><p>å½“æŒ‡é’ˆæŒ‡å‘ä¸€è¡Œæ—¶, å¯ä»¥é€šè¿‡è°ƒç”¨ getXxx(int index) æˆ– getXxx(int columnName) è·å–æ¯ä¸€åˆ—çš„å€¼ã€‚</p>
<ul>
<li>ä¾‹å¦‚: getInt(1), getString(â€œnameâ€)</li>
<li><strong>æ³¨æ„ï¼šJavaä¸æ•°æ®åº“äº¤äº’æ¶‰åŠåˆ°çš„ç›¸å…³Java APIä¸­çš„ç´¢å¼•éƒ½ä»1å¼€å§‹ã€‚</strong></li>
</ul>
</li>
<li><p>ResultSet æ¥å£çš„å¸¸ç”¨æ–¹æ³•ï¼š</p>
<ul>
<li><p>boolean next()</p>
</li>
<li><p>getString()</p>
</li>
<li><p>â€¦</p>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555580152530.png" alt="1555580152530"></p>
</li>
</ul>
<h4 id="3-4-2-ResultSetMetaData"><a href="#3-4-2-ResultSetMetaData" class="headerlink" title="3.4.2 ResultSetMetaData"></a>3.4.2 ResultSetMetaData</h4><ul>
<li><p>å¯ç”¨äºè·å–å…³äº ResultSet å¯¹è±¡ä¸­åˆ—çš„ç±»å‹å’Œå±æ€§ä¿¡æ¯çš„å¯¹è±¡</p>
</li>
<li><p>ResultSetMetaData meta = rs.getMetaData();</p>
<ul>
<li><p><strong>getColumnName</strong>(int column)ï¼šè·å–æŒ‡å®šåˆ—çš„åç§°</p>
</li>
<li><p><strong>getColumnLabel</strong>(int column)ï¼šè·å–æŒ‡å®šåˆ—çš„åˆ«å</p>
</li>
<li><p><strong>getColumnCount</strong>()ï¼šè¿”å›å½“å‰ ResultSet å¯¹è±¡ä¸­çš„åˆ—æ•°ã€‚ </p>
</li>
<li><p>getColumnTypeName(int column)ï¼šæ£€ç´¢æŒ‡å®šåˆ—çš„æ•°æ®åº“ç‰¹å®šçš„ç±»å‹åç§°ã€‚ </p>
</li>
<li><p>getColumnDisplaySize(int column)ï¼šæŒ‡ç¤ºæŒ‡å®šåˆ—çš„æœ€å¤§æ ‡å‡†å®½åº¦ï¼Œä»¥å­—ç¬¦ä¸ºå•ä½ã€‚ </p>
</li>
<li><p><strong>isNullable</strong>(int column)ï¼šæŒ‡ç¤ºæŒ‡å®šåˆ—ä¸­çš„å€¼æ˜¯å¦å¯ä»¥ä¸º nullã€‚ </p>
</li>
<li><p>isAutoIncrement(int column)ï¼šæŒ‡ç¤ºæ˜¯å¦è‡ªåŠ¨ä¸ºæŒ‡å®šåˆ—è¿›è¡Œç¼–å·ï¼Œè¿™æ ·è¿™äº›åˆ—ä»ç„¶æ˜¯åªè¯»çš„ã€‚ </p>
</li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555579494691.png" alt="1555579494691"></p>
<p><strong>é—®é¢˜1ï¼šå¾—åˆ°ç»“æœé›†å, å¦‚ä½•çŸ¥é“è¯¥ç»“æœé›†ä¸­æœ‰å“ªäº›åˆ— ï¼Ÿ åˆ—åæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>â€‹     éœ€è¦ä½¿ç”¨ä¸€ä¸ªæè¿° ResultSet çš„å¯¹è±¡ï¼Œ å³ ResultSetMetaData</p>
<p><strong>é—®é¢˜2ï¼šå…³äºResultSetMetaData</strong></p>
<ol>
<li><strong>å¦‚ä½•è·å– ResultSetMetaData</strong>ï¼š è°ƒç”¨ ResultSet çš„ getMetaData() æ–¹æ³•å³å¯</li>
<li><strong>è·å– ResultSet ä¸­æœ‰å¤šå°‘åˆ—</strong>ï¼šè°ƒç”¨ ResultSetMetaData çš„ getColumnCount() æ–¹æ³•</li>
<li><strong>è·å– ResultSet æ¯ä¸€åˆ—çš„åˆ—çš„åˆ«åæ˜¯ä»€ä¹ˆ</strong>ï¼šè°ƒç”¨ ResultSetMetaData çš„getColumnLabel() æ–¹æ³•</li>
</ol>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555579816884.png" alt="1555579816884"></p>
<h3 id="3-5-èµ„æºçš„é‡Šæ”¾"><a href="#3-5-èµ„æºçš„é‡Šæ”¾" class="headerlink" title="3.5 èµ„æºçš„é‡Šæ”¾"></a>3.5 èµ„æºçš„é‡Šæ”¾</h3><ul>
<li>é‡Šæ”¾ResultSet, Statement,Connectionã€‚</li>
<li>æ•°æ®åº“è¿æ¥ï¼ˆConnectionï¼‰æ˜¯éå¸¸ç¨€æœ‰çš„èµ„æºï¼Œç”¨å®Œåå¿…é¡»é©¬ä¸Šé‡Šæ”¾ï¼Œå¦‚æœConnectionä¸èƒ½åŠæ—¶æ­£ç¡®çš„å…³é—­å°†å¯¼è‡´ç³»ç»Ÿå®•æœºã€‚Connectionçš„ä½¿ç”¨åŸåˆ™æ˜¯<strong>å°½é‡æ™šåˆ›å»ºï¼Œå°½é‡æ—©çš„é‡Šæ”¾ã€‚</strong></li>
<li>å¯ä»¥åœ¨finallyä¸­å…³é—­ï¼Œä¿è¯åŠæ—¶å…¶ä»–ä»£ç å‡ºç°å¼‚å¸¸ï¼Œèµ„æºä¹Ÿä¸€å®šèƒ½è¢«å…³é—­ã€‚</li>
</ul>
<h3 id="3-6-JDBC-APIå°ç»“"><a href="#3-6-JDBC-APIå°ç»“" class="headerlink" title="3.6 JDBC APIå°ç»“"></a>3.6 JDBC APIå°ç»“</h3><ul>
<li><p>ä¸¤ç§æ€æƒ³</p>
<ul>
<li><p>é¢å‘æ¥å£ç¼–ç¨‹çš„æ€æƒ³</p>
</li>
<li><p>ORMæ€æƒ³(object relational mapping)</p>
<ul>
<li>ä¸€ä¸ªæ•°æ®è¡¨å¯¹åº”ä¸€ä¸ªjavaç±»</li>
<li>è¡¨ä¸­çš„ä¸€æ¡è®°å½•å¯¹åº”javaç±»çš„ä¸€ä¸ªå¯¹è±¡</li>
<li>è¡¨ä¸­çš„ä¸€ä¸ªå­—æ®µå¯¹åº”javaç±»çš„ä¸€ä¸ªå±æ€§</li>
</ul>
</li>
</ul>
<blockquote>
<p>sqlæ˜¯éœ€è¦ç»“åˆåˆ—åå’Œè¡¨çš„å±æ€§åæ¥å†™ã€‚æ³¨æ„èµ·åˆ«åã€‚</p>
</blockquote>
</li>
<li><p>ä¸¤ç§æŠ€æœ¯</p>
<ul>
<li>JDBCç»“æœé›†çš„å…ƒæ•°æ®ï¼šResultSetMetaData<ul>
<li>è·å–åˆ—æ•°ï¼šgetColumnCount()</li>
<li>è·å–åˆ—çš„åˆ«åï¼šgetColumnLabel()</li>
</ul>
</li>
<li>é€šè¿‡åå°„ï¼Œåˆ›å»ºæŒ‡å®šç±»çš„å¯¹è±¡ï¼Œè·å–æŒ‡å®šçš„å±æ€§å¹¶èµ‹å€¼</li>
</ul>
</li>
</ul>
<hr>
<h2 id="ç« èŠ‚ç»ƒä¹ "><a href="#ç« èŠ‚ç»ƒä¹ " class="headerlink" title="ç« èŠ‚ç»ƒä¹ "></a>ç« èŠ‚ç»ƒä¹ </h2><p><strong>ç»ƒä¹ é¢˜1ï¼šä»æ§åˆ¶å°å‘æ•°æ®åº“çš„è¡¨customersä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼Œè¡¨ç»“æ„å¦‚ä¸‹ï¼š</strong></p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555580735377.png" alt="1555580275036"></p>
<p><strong>ç»ƒä¹ é¢˜2ï¼šåˆ›ç«‹æ•°æ®åº“è¡¨ examstudentï¼Œè¡¨ç»“æ„å¦‚ä¸‹ï¼š</strong></p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555580763636.png" alt="1555580735377"></p>
<p>å‘æ•°æ®è¡¨ä¸­æ·»åŠ å¦‚ä¸‹æ•°æ®ï¼š</p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555580275036.png" alt="1555580763636"></p>
<p><strong>ä»£ç å®ç°1ï¼šæ’å…¥ä¸€ä¸ªæ–°çš„student ä¿¡æ¯</strong></p>
<p>è¯·è¾“å…¥è€ƒç”Ÿçš„è¯¦ç»†ä¿¡æ¯</p>
<p>Type:<br>IDCard:<br>ExamCard:<br>StudentName:<br>Location:<br>Grade:</p>
<p>ä¿¡æ¯å½•å…¥æˆåŠŸ!</p>
<p><strong>ä»£ç å®ç°2ï¼šåœ¨ eclipseä¸­å»ºç«‹ java ç¨‹åºï¼šè¾“å…¥èº«ä»½è¯å·æˆ–å‡†è€ƒè¯å·å¯ä»¥æŸ¥è¯¢åˆ°å­¦ç”Ÿçš„åŸºæœ¬ä¿¡æ¯ã€‚ç»“æœå¦‚ä¸‹ï¼š</strong></p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555580965019.png" alt="1555580937490"></p>
<p><strong>ä»£ç å®ç°3ï¼šå®Œæˆå­¦ç”Ÿä¿¡æ¯çš„åˆ é™¤åŠŸèƒ½</strong></p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555580937490.png" alt="1555580965019"></p>
<hr>
<h2 id="ç¬¬4ç« -æ“ä½œBLOBç±»å‹å­—æ®µ"><a href="#ç¬¬4ç« -æ“ä½œBLOBç±»å‹å­—æ®µ" class="headerlink" title="ç¬¬4ç«  æ“ä½œBLOBç±»å‹å­—æ®µ"></a>ç¬¬4ç«  æ“ä½œBLOBç±»å‹å­—æ®µ</h2><h3 id="4-1-MySQL-BLOBç±»å‹"><a href="#4-1-MySQL-BLOBç±»å‹" class="headerlink" title="4.1 MySQL BLOBç±»å‹"></a>4.1 MySQL BLOBç±»å‹</h3><ul>
<li><p>MySQLä¸­ï¼ŒBLOBæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å¤§å‹å¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥å­˜å‚¨å¤§é‡æ•°æ®çš„å®¹å™¨ï¼Œå®ƒèƒ½å®¹çº³ä¸åŒå¤§å°çš„æ•°æ®ã€‚</p>
</li>
<li><p>æ’å…¥BLOBç±»å‹çš„æ•°æ®å¿…é¡»ä½¿ç”¨PreparedStatementï¼Œå› ä¸ºBLOBç±»å‹çš„æ•°æ®æ— æ³•ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥å†™çš„ã€‚</p>
</li>
<li><p>MySQLçš„å››ç§BLOBç±»å‹(é™¤äº†åœ¨å­˜å‚¨çš„æœ€å¤§ä¿¡æ¯é‡ä¸Šä¸åŒå¤–ï¼Œä»–ä»¬æ˜¯ç­‰åŒçš„)</p>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555581069798.png" alt="1555581069798"></p>
<ul>
<li>å®é™…ä½¿ç”¨ä¸­æ ¹æ®éœ€è¦å­˜å…¥çš„æ•°æ®å¤§å°å®šä¹‰ä¸åŒçš„BLOBç±»å‹ã€‚</li>
<li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœå­˜å‚¨çš„æ–‡ä»¶è¿‡å¤§ï¼Œæ•°æ®åº“çš„æ€§èƒ½ä¼šä¸‹é™ã€‚</li>
<li>å¦‚æœåœ¨æŒ‡å®šäº†ç›¸å…³çš„Blobç±»å‹ä»¥åï¼Œè¿˜æŠ¥é”™ï¼šxxx too largeï¼Œé‚£ä¹ˆåœ¨mysqlçš„å®‰è£…ç›®å½•ä¸‹ï¼Œæ‰¾my.iniæ–‡ä»¶åŠ ä¸Šå¦‚ä¸‹çš„é…ç½®å‚æ•°ï¼š <strong>max_allowed_packet=16M</strong>ã€‚åŒæ—¶æ³¨æ„ï¼šä¿®æ”¹äº†my.iniæ–‡ä»¶ä¹‹åï¼Œéœ€è¦é‡æ–°å¯åŠ¨mysqlæœåŠ¡ã€‚</li>
</ul>
<h3 id="4-2-å‘æ•°æ®è¡¨ä¸­æ’å…¥å¤§æ•°æ®ç±»å‹"><a href="#4-2-å‘æ•°æ®è¡¨ä¸­æ’å…¥å¤§æ•°æ®ç±»å‹" class="headerlink" title="4.2 å‘æ•°æ®è¡¨ä¸­æ’å…¥å¤§æ•°æ®ç±»å‹"></a>4.2 å‘æ•°æ®è¡¨ä¸­æ’å…¥å¤§æ•°æ®ç±»å‹</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">//è·å–è¿æ¥</span>
Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

String sql <span class="token operator">=</span> <span class="token string">"insert into customers(name,email,birth,photo)values(?,?,?,?)"</span><span class="token punctuation">;</span>
PreparedStatement ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// å¡«å……å ä½ç¬¦</span>
ps<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"å¾æµ·å¼º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ps<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"xhq@126.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ps<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// æ“ä½œBlobç±»å‹çš„å˜é‡</span>
FileInputStream fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"xhq.png"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ps<span class="token punctuation">.</span><span class="token function">setBlob</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> fis<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//æ‰§è¡Œ</span>
ps<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="4-3-ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„Blobç±»å‹å­—æ®µ"><a href="#4-3-ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„Blobç±»å‹å­—æ®µ" class="headerlink" title="4.3 ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„Blobç±»å‹å­—æ®µ"></a>4.3 ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„Blobç±»å‹å­—æ®µ</h3><pre class="line-numbers language-java"><code class="language-java">Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
String sql <span class="token operator">=</span> <span class="token string">"update customers set photo = ? where id = ?"</span><span class="token punctuation">;</span>
PreparedStatement ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// å¡«å……å ä½ç¬¦</span>
<span class="token comment" spellcheck="true">// æ“ä½œBlobç±»å‹çš„å˜é‡</span>
FileInputStream fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"coffee.png"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ps<span class="token punctuation">.</span><span class="token function">setBlob</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> fis<span class="token punctuation">)</span><span class="token punctuation">;</span>
ps<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ps<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="4-4-ä»æ•°æ®è¡¨ä¸­è¯»å–å¤§æ•°æ®ç±»å‹"><a href="#4-4-ä»æ•°æ®è¡¨ä¸­è¯»å–å¤§æ•°æ®ç±»å‹" class="headerlink" title="4.4 ä»æ•°æ®è¡¨ä¸­è¯»å–å¤§æ•°æ®ç±»å‹"></a>4.4 ä»æ•°æ®è¡¨ä¸­è¯»å–å¤§æ•°æ®ç±»å‹</h3><pre class="line-numbers language-java"><code class="language-java">String sql <span class="token operator">=</span> <span class="token string">"SELECT id, name, email, birth, photo FROM customer WHERE id = ?"</span><span class="token punctuation">;</span>
conn <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
ps<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
rs <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    Integer id <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    String name <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    String email <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Date birth <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Customer cust <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> email<span class="token punctuation">,</span> birth<span class="token punctuation">)</span><span class="token punctuation">;</span>
    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cust<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token comment" spellcheck="true">//è¯»å–Blobç±»å‹çš„å­—æ®µ</span>
    Blob photo <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getBlob</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    InputStream is <span class="token operator">=</span> photo<span class="token punctuation">.</span><span class="token function">getBinaryStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    OutputStream os <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"c.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">byte</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">,</span> rs<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>is <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>
        is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>os <span class="token operator">!=</span>  null<span class="token punctuation">)</span><span class="token punctuation">{</span>
        os<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="ç¬¬5ç« -æ‰¹é‡æ’å…¥"><a href="#ç¬¬5ç« -æ‰¹é‡æ’å…¥" class="headerlink" title="ç¬¬5ç«  æ‰¹é‡æ’å…¥"></a>ç¬¬5ç«  æ‰¹é‡æ’å…¥</h2><h3 id="5-1-æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥"><a href="#5-1-æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥" class="headerlink" title="5.1 æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥"></a>5.1 æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥</h3><p>å½“éœ€è¦æˆæ‰¹æ’å…¥æˆ–è€…æ›´æ–°è®°å½•æ—¶ï¼Œå¯ä»¥é‡‡ç”¨Javaçš„æ‰¹é‡<strong>æ›´æ–°</strong>æœºåˆ¶ï¼Œè¿™ä¸€æœºåˆ¶å…è®¸å¤šæ¡è¯­å¥ä¸€æ¬¡æ€§æäº¤ç»™æ•°æ®åº“æ‰¹é‡å¤„ç†ã€‚é€šå¸¸æƒ…å†µä¸‹æ¯”å•ç‹¬æäº¤å¤„ç†æ›´æœ‰æ•ˆç‡</p>
<p>JDBCçš„æ‰¹é‡å¤„ç†è¯­å¥åŒ…æ‹¬ä¸‹é¢ä¸‰ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li><strong>addBatch(String)ï¼šæ·»åŠ éœ€è¦æ‰¹é‡å¤„ç†çš„SQLè¯­å¥æˆ–æ˜¯å‚æ•°ï¼›</strong></li>
<li><strong>executeBatch()ï¼šæ‰§è¡Œæ‰¹é‡å¤„ç†è¯­å¥ï¼›</strong></li>
<li><strong>clearBatch():æ¸…ç©ºç¼“å­˜çš„æ•°æ®</strong></li>
</ul>
<p>é€šå¸¸æˆ‘ä»¬ä¼šé‡åˆ°ä¸¤ç§æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥çš„æƒ…å†µï¼š</p>
<ul>
<li>å¤šæ¡SQLè¯­å¥çš„æ‰¹é‡å¤„ç†ï¼›</li>
<li>ä¸€ä¸ªSQLè¯­å¥çš„æ‰¹é‡ä¼ å‚ï¼›</li>
</ul>
<h3 id="5-2-é«˜æ•ˆçš„æ‰¹é‡æ’å…¥"><a href="#5-2-é«˜æ•ˆçš„æ‰¹é‡æ’å…¥" class="headerlink" title="5.2 é«˜æ•ˆçš„æ‰¹é‡æ’å…¥"></a>5.2 é«˜æ•ˆçš„æ‰¹é‡æ’å…¥</h3><p>ä¸¾ä¾‹ï¼šå‘æ•°æ®è¡¨ä¸­æ’å…¥20000æ¡æ•°æ®</p>
<ul>
<li>æ•°æ®åº“ä¸­æä¾›ä¸€ä¸ªgoodsè¡¨ã€‚åˆ›å»ºå¦‚ä¸‹ï¼š</li>
</ul>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> goods<span class="token punctuation">(</span>
id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="5-2-1-å®ç°å±‚æ¬¡ä¸€ï¼šä½¿ç”¨Statement"><a href="#5-2-1-å®ç°å±‚æ¬¡ä¸€ï¼šä½¿ç”¨Statement" class="headerlink" title="5.2.1 å®ç°å±‚æ¬¡ä¸€ï¼šä½¿ç”¨Statement"></a>5.2.1 å®ç°å±‚æ¬¡ä¸€ï¼šä½¿ç”¨Statement</h4><pre class="line-numbers language-java"><code class="language-java">Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Statement st <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>i <span class="token operator">&lt;=</span> <span class="token number">20000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    String sql <span class="token operator">=</span> <span class="token string">"insert into goods(name) values('name_' + "</span><span class="token operator">+</span> i <span class="token operator">+</span><span class="token string">")"</span><span class="token punctuation">;</span>
    st<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="5-2-2-å®ç°å±‚æ¬¡äºŒï¼šä½¿ç”¨PreparedStatement"><a href="#5-2-2-å®ç°å±‚æ¬¡äºŒï¼šä½¿ç”¨PreparedStatement" class="headerlink" title="5.2.2 å®ç°å±‚æ¬¡äºŒï¼šä½¿ç”¨PreparedStatement"></a>5.2.2 å®ç°å±‚æ¬¡äºŒï¼šä½¿ç”¨PreparedStatement</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">long</span> start <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

String sql <span class="token operator">=</span> <span class="token string">"insert into goods(name)values(?)"</span><span class="token punctuation">;</span>
PreparedStatement ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>i <span class="token operator">&lt;=</span> <span class="token number">20000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    ps<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"name_"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ps<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">long</span> end <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"èŠ±è´¹çš„æ—¶é—´ä¸ºï¼š"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//82340</span>


JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="5-2-3-å®ç°å±‚æ¬¡ä¸‰"><a href="#5-2-3-å®ç°å±‚æ¬¡ä¸‰" class="headerlink" title="5.2.3 å®ç°å±‚æ¬¡ä¸‰"></a>5.2.3 å®ç°å±‚æ¬¡ä¸‰</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*
 * ä¿®æ”¹1ï¼š ä½¿ç”¨ addBatch() / executeBatch() / clearBatch()
 * ä¿®æ”¹2ï¼šmysqlæœåŠ¡å™¨é»˜è®¤æ˜¯å…³é—­æ‰¹å¤„ç†çš„ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ä¸€ä¸ªå‚æ•°ï¼Œè®©mysqlå¼€å¯æ‰¹å¤„ç†çš„æ”¯æŒã€‚
 *          ?rewriteBatchedStatements=true å†™åœ¨é…ç½®æ–‡ä»¶çš„urlåé¢
 * ä¿®æ”¹3ï¼šä½¿ç”¨æ›´æ–°çš„mysql é©±åŠ¨ï¼šmysql-connector-java-5.1.37-bin.jar
 * 
 */</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testInsert1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>
    <span class="token keyword">long</span> start <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    String sql <span class="token operator">=</span> <span class="token string">"insert into goods(name)values(?)"</span><span class="token punctuation">;</span>
    PreparedStatement ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>i <span class="token operator">&lt;=</span> <span class="token number">1000000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        ps<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"name_"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">//1.â€œæ”’â€sql</span>
        ps<span class="token punctuation">.</span><span class="token function">addBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">500</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//2.æ‰§è¡Œ</span>
            ps<span class="token punctuation">.</span><span class="token function">executeBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//3.æ¸…ç©º</span>
            ps<span class="token punctuation">.</span><span class="token function">clearBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">long</span> end <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"èŠ±è´¹çš„æ—¶é—´ä¸ºï¼š"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//20000æ¡ï¼š625                                                                         //1000000æ¡:14733  </span>

    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="5-2-4-å®ç°å±‚æ¬¡å››"><a href="#5-2-4-å®ç°å±‚æ¬¡å››" class="headerlink" title="5.2.4 å®ç°å±‚æ¬¡å››"></a>5.2.4 å®ç°å±‚æ¬¡å››</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*
* å±‚æ¬¡å››ï¼šåœ¨å±‚æ¬¡ä¸‰çš„åŸºç¡€ä¸Šæ“ä½œ
* ä½¿ç”¨Connection çš„ setAutoCommit(false)  /  commit()
*/</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testInsert2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>
    <span class="token keyword">long</span> start <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//1.è®¾ç½®ä¸ºä¸è‡ªåŠ¨æäº¤æ•°æ®</span>
    conn<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    String sql <span class="token operator">=</span> <span class="token string">"insert into goods(name)values(?)"</span><span class="token punctuation">;</span>
    PreparedStatement ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>i <span class="token operator">&lt;=</span> <span class="token number">1000000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        ps<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"name_"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">//1.â€œæ”’â€sql</span>
        ps<span class="token punctuation">.</span><span class="token function">addBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">500</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//2.æ‰§è¡Œ</span>
            ps<span class="token punctuation">.</span><span class="token function">executeBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">//3.æ¸…ç©º</span>
            ps<span class="token punctuation">.</span><span class="token function">clearBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">//2.æäº¤æ•°æ®</span>
    conn<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">long</span> end <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"èŠ±è´¹çš„æ—¶é—´ä¸ºï¼š"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//1000000æ¡:4978 </span>

    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="ç¬¬6ç« ï¼š-æ•°æ®åº“äº‹åŠ¡"><a href="#ç¬¬6ç« ï¼š-æ•°æ®åº“äº‹åŠ¡" class="headerlink" title="ç¬¬6ç« ï¼š æ•°æ®åº“äº‹åŠ¡"></a>ç¬¬6ç« ï¼š æ•°æ®åº“äº‹åŠ¡</h2><h3 id="6-1-æ•°æ®åº“äº‹åŠ¡ä»‹ç»"><a href="#6-1-æ•°æ®åº“äº‹åŠ¡ä»‹ç»" class="headerlink" title="6.1 æ•°æ®åº“äº‹åŠ¡ä»‹ç»"></a>6.1 æ•°æ®åº“äº‹åŠ¡ä»‹ç»</h3><ul>
<li><p><strong>äº‹åŠ¡ï¼šä¸€ç»„é€»è¾‘æ“ä½œå•å…ƒ,ä½¿æ•°æ®ä»ä¸€ç§çŠ¶æ€å˜æ¢åˆ°å¦ä¸€ç§çŠ¶æ€ã€‚</strong></p>
</li>
<li><p><strong>äº‹åŠ¡å¤„ç†ï¼ˆäº‹åŠ¡æ“ä½œï¼‰ï¼š</strong>ä¿è¯æ‰€æœ‰äº‹åŠ¡éƒ½ä½œä¸ºä¸€ä¸ªå·¥ä½œå•å…ƒæ¥æ‰§è¡Œï¼Œå³ä½¿å‡ºç°äº†æ•…éšœï¼Œéƒ½ä¸èƒ½æ”¹å˜è¿™ç§æ‰§è¡Œæ–¹å¼ã€‚å½“åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œå¤šä¸ªæ“ä½œæ—¶ï¼Œè¦ä¹ˆæ‰€æœ‰çš„äº‹åŠ¡éƒ½<strong>è¢«æäº¤(commit)</strong>ï¼Œé‚£ä¹ˆè¿™äº›ä¿®æ”¹å°±æ°¸ä¹…åœ°ä¿å­˜ä¸‹æ¥ï¼›è¦ä¹ˆæ•°æ®åº“ç®¡ç†ç³»ç»Ÿå°†æ”¾å¼ƒæ‰€ä½œçš„æ‰€æœ‰ä¿®æ”¹ï¼Œæ•´ä¸ªäº‹åŠ¡<strong>å›æ»š(rollback)</strong>åˆ°æœ€åˆçŠ¶æ€ã€‚</p>
</li>
<li><p>ä¸ºç¡®ä¿æ•°æ®åº“ä¸­æ•°æ®çš„<strong>ä¸€è‡´æ€§</strong>ï¼Œæ•°æ®çš„æ“çºµåº”å½“æ˜¯ç¦»æ•£çš„æˆç»„çš„é€»è¾‘å•å…ƒï¼šå½“å®ƒå…¨éƒ¨å®Œæˆæ—¶ï¼Œæ•°æ®çš„ä¸€è‡´æ€§å¯ä»¥ä¿æŒï¼Œè€Œå½“è¿™ä¸ªå•å…ƒä¸­çš„ä¸€éƒ¨åˆ†æ“ä½œå¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡åº”å…¨éƒ¨è§†ä¸ºé”™è¯¯ï¼Œæ‰€æœ‰ä»èµ·å§‹ç‚¹ä»¥åçš„æ“ä½œåº”å…¨éƒ¨å›é€€åˆ°å¼€å§‹çŠ¶æ€ã€‚ </p>
</li>
</ul>
<h3 id="6-2-JDBCäº‹åŠ¡å¤„ç†"><a href="#6-2-JDBCäº‹åŠ¡å¤„ç†" class="headerlink" title="6.2 JDBCäº‹åŠ¡å¤„ç†"></a>6.2 JDBCäº‹åŠ¡å¤„ç†</h3><ul>
<li><p>æ•°æ®ä¸€æ—¦æäº¤ï¼Œå°±ä¸å¯å›æ»šã€‚</p>
</li>
<li><p>æ•°æ®ä»€ä¹ˆæ—¶å€™æ„å‘³ç€æäº¤ï¼Ÿ</p>
<ul>
<li><strong>å½“ä¸€ä¸ªè¿æ¥å¯¹è±¡è¢«åˆ›å»ºæ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯è‡ªåŠ¨æäº¤äº‹åŠ¡</strong>ï¼šæ¯æ¬¡æ‰§è¡Œä¸€ä¸ª SQL è¯­å¥æ—¶ï¼Œå¦‚æœæ‰§è¡ŒæˆåŠŸï¼Œå°±ä¼šå‘æ•°æ®åº“è‡ªåŠ¨æäº¤ï¼Œè€Œä¸èƒ½å›æ»šã€‚</li>
<li><strong>å…³é—­æ•°æ®åº“è¿æ¥ï¼Œæ•°æ®å°±ä¼šè‡ªåŠ¨çš„æäº¤ã€‚</strong>å¦‚æœå¤šä¸ªæ“ä½œï¼Œæ¯ä¸ªæ“ä½œä½¿ç”¨çš„æ˜¯è‡ªå·±å•ç‹¬çš„è¿æ¥ï¼Œåˆ™æ— æ³•ä¿è¯äº‹åŠ¡ã€‚å³åŒä¸€ä¸ªäº‹åŠ¡çš„å¤šä¸ªæ“ä½œå¿…é¡»åœ¨åŒä¸€ä¸ªè¿æ¥ä¸‹ã€‚</li>
</ul>
</li>
<li><p><strong>JDBCç¨‹åºä¸­ä¸ºäº†è®©å¤šä¸ª SQL è¯­å¥ä½œä¸ºä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œï¼š</strong></p>
<ul>
<li>è°ƒç”¨ Connection å¯¹è±¡çš„ <strong>setAutoCommit(false);</strong> ä»¥å–æ¶ˆè‡ªåŠ¨æäº¤äº‹åŠ¡</li>
<li>åœ¨æ‰€æœ‰çš„ SQL è¯­å¥éƒ½æˆåŠŸæ‰§è¡Œåï¼Œè°ƒç”¨ <strong>commit();</strong> æ–¹æ³•æäº¤äº‹åŠ¡</li>
<li>åœ¨å‡ºç°å¼‚å¸¸æ—¶ï¼Œè°ƒç”¨ <strong>rollback();</strong> æ–¹æ³•å›æ»šäº‹åŠ¡</li>
</ul>
<blockquote>
<p>è‹¥æ­¤æ—¶ Connection æ²¡æœ‰è¢«å…³é—­ï¼Œè¿˜å¯èƒ½è¢«é‡å¤ä½¿ç”¨ï¼Œåˆ™éœ€è¦æ¢å¤å…¶è‡ªåŠ¨æäº¤çŠ¶æ€ setAutoCommit(true)ã€‚å°¤å…¶æ˜¯åœ¨ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯æ—¶ï¼Œæ‰§è¡Œclose()æ–¹æ³•å‰ï¼Œå»ºè®®æ¢å¤è‡ªåŠ¨æäº¤çŠ¶æ€ã€‚</p>
</blockquote>
</li>
</ul>
<p>ã€æ¡ˆä¾‹ï¼šç”¨æˆ·AAå‘ç”¨æˆ·BBè½¬è´¦100ã€‘</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testJDBCTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 1.è·å–æ•°æ®åº“è¿æ¥</span>
        conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// 2.å¼€å¯äº‹åŠ¡</span>
        conn<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// 3.è¿›è¡Œæ•°æ®åº“æ“ä½œ</span>
        String sql1 <span class="token operator">=</span> <span class="token string">"update user_table set balance = balance - 100 where user = ?"</span><span class="token punctuation">;</span>
        <span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql1<span class="token punctuation">,</span> <span class="token string">"AA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// æ¨¡æ‹Ÿç½‘ç»œå¼‚å¸¸</span>
        <span class="token comment" spellcheck="true">//System.out.println(10 / 0);</span>

        String sql2 <span class="token operator">=</span> <span class="token string">"update user_table set balance = balance + 100 where user = ?"</span><span class="token punctuation">;</span>
        <span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql2<span class="token punctuation">,</span> <span class="token string">"BB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// 4.è‹¥æ²¡æœ‰å¼‚å¸¸ï¼Œåˆ™æäº¤äº‹åŠ¡</span>
        conn<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// 5.è‹¥æœ‰å¼‚å¸¸ï¼Œåˆ™å›æ»šäº‹åŠ¡</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            conn<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//6.æ¢å¤æ¯æ¬¡DMLæ“ä½œçš„è‡ªåŠ¨æäº¤åŠŸèƒ½</span>
            conn<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">//7.å…³é—­è¿æ¥</span>
        JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶ä¸­ï¼Œå¯¹æ•°æ®åº“æ“ä½œçš„æ–¹æ³•ä¸ºï¼š</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">//ä½¿ç”¨äº‹åŠ¡ä»¥åçš„é€šç”¨çš„å¢åˆ æ”¹æ“ä½œï¼ˆversion 2.0ï¼‰</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span>Connection conn <span class="token punctuation">,</span>String sql<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    PreparedStatement ps <span class="token operator">=</span> null<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 1.è·å–PreparedStatementçš„å®ä¾‹ (æˆ–ï¼šé¢„ç¼–è¯‘sqlè¯­å¥)</span>
        ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// 2.å¡«å……å ä½ç¬¦</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> args<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            ps<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">// 3.æ‰§è¡Œsqlè¯­å¥</span>
        ps<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 4.å…³é—­èµ„æº</span>
        JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="6-3-äº‹åŠ¡çš„ACIDå±æ€§"><a href="#6-3-äº‹åŠ¡çš„ACIDå±æ€§" class="headerlink" title="6.3 äº‹åŠ¡çš„ACIDå±æ€§"></a>6.3 äº‹åŠ¡çš„ACIDå±æ€§</h3><ol>
<li><p><strong>åŸå­æ€§ï¼ˆAtomicityï¼‰</strong><br>åŸå­æ€§æ˜¯æŒ‡äº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆéƒ½å‘ç”Ÿï¼Œè¦ä¹ˆéƒ½ä¸å‘ç”Ÿã€‚ </p>
</li>
<li><p><strong>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰</strong><br>äº‹åŠ¡å¿…é¡»ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€å˜æ¢åˆ°å¦å¤–ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ã€‚</p>
</li>
<li><p><strong>éš”ç¦»æ€§ï¼ˆIsolationï¼‰</strong><br>äº‹åŠ¡çš„éš”ç¦»æ€§æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸èƒ½è¢«å…¶ä»–äº‹åŠ¡å¹²æ‰°ï¼Œå³ä¸€ä¸ªäº‹åŠ¡å†…éƒ¨çš„æ“ä½œåŠä½¿ç”¨çš„æ•°æ®å¯¹å¹¶å‘çš„å…¶ä»–äº‹åŠ¡æ˜¯éš”ç¦»çš„ï¼Œå¹¶å‘æ‰§è¡Œçš„å„ä¸ªäº‹åŠ¡ä¹‹é—´ä¸èƒ½äº’ç›¸å¹²æ‰°ã€‚</p>
</li>
<li><p><strong>æŒä¹…æ€§ï¼ˆDurabilityï¼‰</strong><br>æŒä¹…æ€§æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦è¢«æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼Œæ¥ä¸‹æ¥çš„å…¶ä»–æ“ä½œå’Œæ•°æ®åº“æ•…éšœä¸åº”è¯¥å¯¹å…¶æœ‰ä»»ä½•å½±å“ã€‚</p>
</li>
</ol>
<h4 id="6-3-1-æ•°æ®åº“çš„å¹¶å‘é—®é¢˜"><a href="#6-3-1-æ•°æ®åº“çš„å¹¶å‘é—®é¢˜" class="headerlink" title="6.3.1 æ•°æ®åº“çš„å¹¶å‘é—®é¢˜"></a>6.3.1 æ•°æ®åº“çš„å¹¶å‘é—®é¢˜</h4><ul>
<li><p>å¯¹äºåŒæ—¶è¿è¡Œçš„å¤šä¸ªäº‹åŠ¡, å½“è¿™äº›äº‹åŠ¡è®¿é—®æ•°æ®åº“ä¸­ç›¸åŒçš„æ•°æ®æ—¶, å¦‚æœæ²¡æœ‰é‡‡å–å¿…è¦çš„éš”ç¦»æœºåˆ¶, å°±ä¼šå¯¼è‡´å„ç§å¹¶å‘é—®é¢˜:</p>
<ul>
<li><strong>è„è¯»</strong>: å¯¹äºä¸¤ä¸ªäº‹åŠ¡ T1, T2, T1 è¯»å–äº†å·²ç»è¢« T2 æ›´æ–°ä½†è¿˜<strong>æ²¡æœ‰è¢«æäº¤</strong>çš„å­—æ®µã€‚ä¹‹å, è‹¥ T2 å›æ»š, T1è¯»å–çš„å†…å®¹å°±æ˜¯ä¸´æ—¶ä¸”æ— æ•ˆçš„ã€‚</li>
<li><strong>ä¸å¯é‡å¤è¯»</strong>: å¯¹äºä¸¤ä¸ªäº‹åŠ¡T1, T2, T1 è¯»å–äº†ä¸€ä¸ªå­—æ®µ, ç„¶å T2 <strong>æ›´æ–°</strong>äº†è¯¥å­—æ®µã€‚ä¹‹å, T1å†æ¬¡è¯»å–åŒä¸€ä¸ªå­—æ®µ, å€¼å°±ä¸åŒäº†ã€‚</li>
<li><strong>å¹»è¯»</strong>: å¯¹äºä¸¤ä¸ªäº‹åŠ¡T1, T2, T1 ä»ä¸€ä¸ªè¡¨ä¸­è¯»å–äº†ä¸€ä¸ªå­—æ®µ, ç„¶å T2 åœ¨è¯¥è¡¨ä¸­<strong>æ’å…¥</strong>äº†ä¸€äº›æ–°çš„è¡Œã€‚ä¹‹å, å¦‚æœ T1 å†æ¬¡è¯»å–åŒä¸€ä¸ªè¡¨, å°±ä¼šå¤šå‡ºå‡ è¡Œã€‚</li>
</ul>
</li>
<li><p><strong>æ•°æ®åº“äº‹åŠ¡çš„éš”ç¦»æ€§</strong>: æ•°æ®åº“ç³»ç»Ÿå¿…é¡»å…·æœ‰éš”ç¦»å¹¶å‘è¿è¡Œå„ä¸ªäº‹åŠ¡çš„èƒ½åŠ›, ä½¿å®ƒä»¬ä¸ä¼šç›¸äº’å½±å“, é¿å…å„ç§å¹¶å‘é—®é¢˜ã€‚</p>
</li>
<li><p>ä¸€ä¸ªäº‹åŠ¡ä¸å…¶ä»–äº‹åŠ¡éš”ç¦»çš„ç¨‹åº¦ç§°ä¸ºéš”ç¦»çº§åˆ«ã€‚æ•°æ®åº“è§„å®šäº†å¤šç§äº‹åŠ¡éš”ç¦»çº§åˆ«, ä¸åŒéš”ç¦»çº§åˆ«å¯¹åº”ä¸åŒçš„å¹²æ‰°ç¨‹åº¦, <strong>éš”ç¦»çº§åˆ«è¶Šé«˜, æ•°æ®ä¸€è‡´æ€§å°±è¶Šå¥½, ä½†å¹¶å‘æ€§è¶Šå¼±ã€‚</strong></p>
</li>
</ul>
<h4 id="6-3-2-å››ç§éš”ç¦»çº§åˆ«"><a href="#6-3-2-å››ç§éš”ç¦»çº§åˆ«" class="headerlink" title="6.3.2 å››ç§éš”ç¦»çº§åˆ«"></a>6.3.2 å››ç§éš”ç¦»çº§åˆ«</h4><ul>
<li><p>æ•°æ®åº“æä¾›çš„4ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š</p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555586275271.png" alt="1555586275271"></p>
</li>
<li><p>Oracle æ”¯æŒçš„ 2 ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š<strong>READ COMMITED</strong>, SERIALIZABLEã€‚ Oracle é»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸º: <strong>READ COMMITED</strong> ã€‚</p>
</li>
</ul>
<ul>
<li>Mysql æ”¯æŒ 4 ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ã€‚Mysql é»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸º: <strong>REPEATABLE READã€‚</strong></li>
</ul>
<h4 id="6-3-3-åœ¨MySqlä¸­è®¾ç½®éš”ç¦»çº§åˆ«"><a href="#6-3-3-åœ¨MySqlä¸­è®¾ç½®éš”ç¦»çº§åˆ«" class="headerlink" title="6.3.3 åœ¨MySqlä¸­è®¾ç½®éš”ç¦»çº§åˆ«"></a>6.3.3 åœ¨MySqlä¸­è®¾ç½®éš”ç¦»çº§åˆ«</h4><ul>
<li><p>æ¯å¯åŠ¨ä¸€ä¸ª mysql ç¨‹åº, å°±ä¼šè·å¾—ä¸€ä¸ªå•ç‹¬çš„æ•°æ®åº“è¿æ¥. æ¯ä¸ªæ•°æ®åº“è¿æ¥éƒ½æœ‰ä¸€ä¸ªå…¨å±€å˜é‡ @@tx_isolation, è¡¨ç¤ºå½“å‰çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ã€‚</p>
</li>
<li><p>æŸ¥çœ‹å½“å‰çš„éš”ç¦»çº§åˆ«: </p>
<pre class="line-numbers language-mysql"><code class="language-mysql">SELECT @@tx_isolation;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>è®¾ç½®å½“å‰ mySQL è¿æ¥çš„éš”ç¦»çº§åˆ«:  </p>
<pre class="line-numbers language-mysql"><code class="language-mysql">set  transaction isolation level read committed;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>è®¾ç½®æ•°æ®åº“ç³»ç»Ÿçš„å…¨å±€çš„éš”ç¦»çº§åˆ«:</p>
<pre class="line-numbers language-mysql"><code class="language-mysql">set global transaction isolation level read committed;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>è¡¥å……æ“ä½œï¼š</p>
<ul>
<li><p>åˆ›å»ºmysqlæ•°æ®åº“ç”¨æˆ·ï¼š</p>
<pre class="line-numbers language-mysql"><code class="language-mysql">create user tom identified by 'abc123';<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>æˆäºˆæƒé™</p>
<pre class="line-numbers language-mysql"><code class="language-mysql">#æˆäºˆé€šè¿‡ç½‘ç»œæ–¹å¼ç™»å½•çš„tomç”¨æˆ·ï¼Œå¯¹æ‰€æœ‰åº“æ‰€æœ‰è¡¨çš„å…¨éƒ¨æƒé™ï¼Œå¯†ç è®¾ä¸ºabc123.
grant all privileges on *.* to tom@'%'  identified by 'abc123'; 

 #ç»™tomç”¨æˆ·ä½¿ç”¨æœ¬åœ°å‘½ä»¤è¡Œæ–¹å¼ï¼Œæˆäºˆatguigudbè¿™ä¸ªåº“ä¸‹çš„æ‰€æœ‰è¡¨çš„æ’åˆ æ”¹æŸ¥çš„æƒé™ã€‚
grant select,insert,delete,update on atguigudb.* to tom@localhost identified by 'abc123'; 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
</li>
</ul>
<h2 id="ç¬¬7ç« ï¼šDAOåŠç›¸å…³å®ç°ç±»"><a href="#ç¬¬7ç« ï¼šDAOåŠç›¸å…³å®ç°ç±»" class="headerlink" title="ç¬¬7ç« ï¼šDAOåŠç›¸å…³å®ç°ç±»"></a>ç¬¬7ç« ï¼šDAOåŠç›¸å…³å®ç°ç±»</h2><ul>
<li>DAOï¼šData Access Objectè®¿é—®æ•°æ®ä¿¡æ¯çš„ç±»å’Œæ¥å£ï¼ŒåŒ…æ‹¬äº†å¯¹æ•°æ®çš„CRUDï¼ˆCreateã€Retrivalã€Updateã€Deleteï¼‰ï¼Œè€Œä¸åŒ…å«ä»»ä½•ä¸šåŠ¡ç›¸å…³çš„ä¿¡æ¯ã€‚æœ‰æ—¶ä¹Ÿç§°ä½œï¼šBaseDAO</li>
<li>ä½œç”¨ï¼šä¸ºäº†å®ç°åŠŸèƒ½çš„æ¨¡å—åŒ–ï¼Œæ›´æœ‰åˆ©äºä»£ç çš„ç»´æŠ¤å’Œå‡çº§ã€‚</li>
<li>ä¸‹é¢æ˜¯å°šç¡…è°·JavaWebé˜¶æ®µä¹¦åŸé¡¹ç›®ä¸­DAOä½¿ç”¨çš„ä½“ç°ï¼š</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566726681515.png" alt="1566726681515"></p>
<ul>
<li>å±‚æ¬¡ç»“æ„ï¼š</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555593598606.png" alt="1566745811244"></p>
<h3 id="ã€BaseDAO-javaã€‘"><a href="#ã€BaseDAO-javaã€‘" class="headerlink" title="ã€BaseDAO.javaã€‘"></a>ã€BaseDAO.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>ParameterizedType<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>Type<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>SQLException<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>

<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>dbutils<span class="token punctuation">.</span>QueryRunner<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>dbutils<span class="token punctuation">.</span>handlers<span class="token punctuation">.</span>BeanHandler<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>dbutils<span class="token punctuation">.</span>handlers<span class="token punctuation">.</span>BeanListHandler<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>dbutils<span class="token punctuation">.</span>handlers<span class="token punctuation">.</span>ScalarHandler<span class="token punctuation">;</span>


<span class="token comment" spellcheck="true">/**
 * å®šä¹‰ä¸€ä¸ªç”¨æ¥è¢«ç»§æ‰¿çš„å¯¹æ•°æ®åº“è¿›è¡ŒåŸºæœ¬æ“ä½œçš„Dao
 * 
 * @author HanYanBing
 *
 * @param &lt;T>
 */</span>
<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">BaseDao</span><span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> QueryRunner queryRunner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// å®šä¹‰ä¸€ä¸ªå˜é‡æ¥æ¥æ”¶æ³›å‹çš„ç±»å‹</span>
    <span class="token keyword">private</span> Class<span class="token operator">&lt;</span>T<span class="token operator">></span> type<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// è·å–Tçš„Classå¯¹è±¡ï¼Œè·å–æ³›å‹çš„ç±»å‹ï¼Œæ³›å‹æ˜¯åœ¨è¢«å­ç±»ç»§æ‰¿æ—¶æ‰ç¡®å®š</span>
    <span class="token keyword">public</span> <span class="token function">BaseDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// è·å–å­ç±»çš„ç±»å‹</span>
        Class <span class="token class-name">clazz</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è·å–çˆ¶ç±»çš„ç±»å‹</span>
        <span class="token comment" spellcheck="true">// getGenericSuperclass()ç”¨æ¥è·å–å½“å‰ç±»çš„çˆ¶ç±»çš„ç±»å‹</span>
        <span class="token comment" spellcheck="true">// ParameterizedTypeè¡¨ç¤ºçš„æ˜¯å¸¦æ³›å‹çš„ç±»å‹</span>
        ParameterizedType parameterizedType <span class="token operator">=</span> <span class="token punctuation">(</span>ParameterizedType<span class="token punctuation">)</span> clazz<span class="token punctuation">.</span><span class="token function">getGenericSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è·å–å…·ä½“çš„æ³›å‹ç±»å‹ getActualTypeArgumentsè·å–å…·ä½“çš„æ³›å‹çš„ç±»å‹</span>
        <span class="token comment" spellcheck="true">// è¿™ä¸ªæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªTypeçš„æ•°ç»„</span>
        Type<span class="token punctuation">[</span><span class="token punctuation">]</span> types <span class="token operator">=</span> parameterizedType<span class="token punctuation">.</span><span class="token function">getActualTypeArguments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è·å–å…·ä½“çš„æ³›å‹çš„ç±»å‹Â·</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token punctuation">(</span>Class<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">)</span> types<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * é€šç”¨çš„å¢åˆ æ”¹æ“ä½œ
     * 
     * @param sql
     * @param params
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">update</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String sql<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            count <span class="token operator">=</span> queryRunner<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> 
        <span class="token keyword">return</span> count<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * è·å–ä¸€ä¸ªå¯¹è±¡
     * 
     * @param sql
     * @param params
     * @return
     */</span>
    <span class="token keyword">public</span> T <span class="token function">getBean</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String sql<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        T t <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            t <span class="token operator">=</span> queryRunner<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BeanHandler</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> 
        <span class="token keyword">return</span> t<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * è·å–æ‰€æœ‰å¯¹è±¡
     * 
     * @param sql
     * @param params
     * @return
     */</span>
    <span class="token keyword">public</span> List<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">getBeanList</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String sql<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        List<span class="token operator">&lt;</span>T<span class="token operator">></span> list <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            list <span class="token operator">=</span> queryRunner<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BeanListHandler</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> 
        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * è·å–ä¸€ä¸ªä½†ä¸€å€¼å¾—æ–¹æ³•ï¼Œä¸“é—¨ç”¨æ¥æ‰§è¡Œåƒ select count(*)...è¿™æ ·çš„sqlè¯­å¥
     * 
     * @param sql
     * @param params
     * @return
     */</span>
    <span class="token keyword">public</span> Object <span class="token function">getValue</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String sql<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Object count <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// è°ƒç”¨queryRunnerçš„queryæ–¹æ³•è·å–ä¸€ä¸ªå•ä¸€çš„å€¼</span>
            count <span class="token operator">=</span> queryRunner<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ScalarHandler</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> 
        <span class="token keyword">return</span> count<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="ã€BookDAO-javaã€‘"><a href="#ã€BookDAO-javaã€‘" class="headerlink" title="ã€BookDAO.javaã€‘"></a>ã€BookDAO.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>Book<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>Page<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BookDao</span> <span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">/**
     * ä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºæ‰€æœ‰çš„è®°å½•
     * 
     * @return
     */</span>
    List<span class="token operator">&lt;</span>Book<span class="token operator">></span> <span class="token function">getBooks</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * å‘æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡è®°å½•
     * 
     * @param book
     */</span>
    <span class="token keyword">void</span> <span class="token function">saveBook</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Book book<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * ä»æ•°æ®åº“ä¸­æ ¹æ®å›¾ä¹¦çš„idåˆ é™¤ä¸€æ¡è®°å½•
     * 
     * @param bookId
     */</span>
    <span class="token keyword">void</span> <span class="token function">deleteBookById</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * æ ¹æ®å›¾ä¹¦çš„idä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºä¸€æ¡è®°å½•
     * 
     * @param bookId
     * @return
     */</span>
    Book <span class="token function">getBookById</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * æ ¹æ®å›¾ä¹¦çš„idä»æ•°æ®åº“ä¸­æ›´æ–°ä¸€æ¡è®°å½•
     * 
     * @param book
     */</span>
    <span class="token keyword">void</span> <span class="token function">updateBook</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Book book<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * è·å–å¸¦åˆ†é¡µçš„å›¾ä¹¦ä¿¡æ¯
     * 
     * @param pageï¼šæ˜¯åªåŒ…å«äº†ç”¨æˆ·è¾“å…¥çš„pageNoå±æ€§çš„pageå¯¹è±¡
     * @return è¿”å›çš„Pageå¯¹è±¡æ˜¯åŒ…å«äº†æ‰€æœ‰å±æ€§çš„Pageå¯¹è±¡
     */</span>
    Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> <span class="token function">getPageBooks</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> page<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * è·å–å¸¦åˆ†é¡µå’Œä»·æ ¼èŒƒå›´çš„å›¾ä¹¦ä¿¡æ¯
     * 
     * @param pageï¼šæ˜¯åªåŒ…å«äº†ç”¨æˆ·è¾“å…¥çš„pageNoå±æ€§çš„pageå¯¹è±¡
     * @return è¿”å›çš„Pageå¯¹è±¡æ˜¯åŒ…å«äº†æ‰€æœ‰å±æ€§çš„Pageå¯¹è±¡
     */</span>
    Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> <span class="token function">getPageBooksByPrice</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> page<span class="token punctuation">,</span> <span class="token keyword">double</span> minPrice<span class="token punctuation">,</span> <span class="token keyword">double</span> maxPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="ã€UserDAO-javaã€‘"><a href="#ã€UserDAO-javaã€‘" class="headerlink" title="ã€UserDAO.javaã€‘"></a>ã€UserDAO.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>User<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserDao</span> <span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">/**
     * æ ¹æ®Userå¯¹è±¡ä¸­çš„ç”¨æˆ·åå’Œå¯†ç ä»æ•°æ®åº“ä¸­è·å–ä¸€æ¡è®°å½•
     * 
     * @param user
     * @return User æ•°æ®åº“ä¸­æœ‰è®°å½• null æ•°æ®åº“ä¸­æ— æ­¤è®°å½•
     */</span>
    User <span class="token function">getUser</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>User user<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * æ ¹æ®Userå¯¹è±¡ä¸­çš„ç”¨æˆ·åä»æ•°æ®åº“ä¸­è·å–ä¸€æ¡è®°å½•
     * 
     * @param user
     * @return true æ•°æ®åº“ä¸­æœ‰è®°å½• false æ•°æ®åº“ä¸­æ— æ­¤è®°å½•
     */</span>
    <span class="token keyword">boolean</span> <span class="token function">checkUsername</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>User user<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * å‘æ•°æ®åº“ä¸­æ’å…¥Userå¯¹è±¡
     * 
     * @param user
     */</span>
    <span class="token keyword">void</span> <span class="token function">saveUser</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>User user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="ã€BookDaoImpl-javaã€‘"><a href="#ã€BookDaoImpl-javaã€‘" class="headerlink" title="ã€BookDaoImpl.javaã€‘"></a>ã€BookDaoImpl.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>impl<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>Book<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>Page<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>BaseDao<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>BookDao<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BookDaoImpl</span> <span class="token keyword">extends</span> <span class="token class-name">BaseDao</span><span class="token operator">&lt;</span>Book<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">BookDao</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> List<span class="token operator">&lt;</span>Book<span class="token operator">></span> <span class="token function">getBooks</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­å¾—åˆ°ä¸€ä¸ªListçš„æ–¹æ³•</span>
        List<span class="token operator">&lt;</span>Book<span class="token operator">></span> beanList <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å†™sqlè¯­å¥</span>
        String sql <span class="token operator">=</span> <span class="token string">"select id,title,author,price,sales,stock,img_path imgPath from books"</span><span class="token punctuation">;</span>
        beanList <span class="token operator">=</span> <span class="token function">getBeanList</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> beanList<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveBook</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Book book<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// å†™sqlè¯­å¥</span>
        String sql <span class="token operator">=</span> <span class="token string">"insert into books(title,author,price,sales,stock,img_path) values(?,?,?,?,?,?)"</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­é€šç”¨çš„å¢åˆ æ”¹çš„æ–¹æ³•</span>
        <span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getAuthor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getSales</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getStock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>book<span class="token punctuation">.</span><span class="token function">getImgPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteBookById</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String bookId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// å†™sqlè¯­å¥</span>
        String sql <span class="token operator">=</span> <span class="token string">"DELETE FROM books WHERE id = ?"</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­é€šç”¨å¢åˆ æ”¹çš„æ–¹æ³•</span>
        <span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span> bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> Book <span class="token function">getBookById</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String bookId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•</span>
        Book book <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å†™sqlè¯­å¥</span>
        String sql <span class="token operator">=</span> <span class="token string">"select id,title,author,price,sales,stock,img_path imgPath from books where id = ?"</span><span class="token punctuation">;</span>
        book <span class="token operator">=</span> <span class="token function">getBean</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span> bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> book<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateBook</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Book book<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// å†™sqlè¯­å¥</span>
        String sql <span class="token operator">=</span> <span class="token string">"update books set title = ? , author = ? , price = ? , sales = ? , stock = ? where id = ?"</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­é€šç”¨çš„å¢åˆ æ”¹çš„æ–¹æ³•</span>
        <span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getAuthor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getSales</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getStock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> <span class="token function">getPageBooks</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> page<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// è·å–æ•°æ®åº“ä¸­å›¾ä¹¦çš„æ€»è®°å½•æ•°</span>
        String sql <span class="token operator">=</span> <span class="token string">"select count(*) from books"</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªå•ä¸€å€¼çš„æ–¹æ³•</span>
        <span class="token keyword">long</span> totalRecord <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token function">getValue</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å°†æ€»è®°å½•æ•°è®¾ç½®éƒ½pageå¯¹è±¡ä¸­</span>
        page<span class="token punctuation">.</span><span class="token function">setTotalRecord</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> totalRecord<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// è·å–å½“å‰é¡µä¸­çš„è®°å½•å­˜æ”¾çš„List</span>
        String sql2 <span class="token operator">=</span> <span class="token string">"select id,title,author,price,sales,stock,img_path imgPath from books limit ?,?"</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªé›†åˆçš„æ–¹æ³•</span>
        List<span class="token operator">&lt;</span>Book<span class="token operator">></span> beanList <span class="token operator">=</span> <span class="token function">getBeanList</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql2<span class="token punctuation">,</span> <span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">getPageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> Page<span class="token punctuation">.</span>PAGE_SIZE<span class="token punctuation">,</span> Page<span class="token punctuation">.</span>PAGE_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å°†è¿™ä¸ªListè®¾ç½®åˆ°pageå¯¹è±¡ä¸­</span>
        page<span class="token punctuation">.</span><span class="token function">setList</span><span class="token punctuation">(</span>beanList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> page<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> <span class="token function">getPageBooksByPrice</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> page<span class="token punctuation">,</span> <span class="token keyword">double</span> minPrice<span class="token punctuation">,</span> <span class="token keyword">double</span> maxPrice<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// è·å–æ•°æ®åº“ä¸­å›¾ä¹¦çš„æ€»è®°å½•æ•°</span>
        String sql <span class="token operator">=</span> <span class="token string">"select count(*) from books where price between ? and ?"</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªå•ä¸€å€¼çš„æ–¹æ³•</span>
        <span class="token keyword">long</span> totalRecord <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token function">getValue</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span>minPrice<span class="token punctuation">,</span>maxPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å°†æ€»è®°å½•æ•°è®¾ç½®éƒ½pageå¯¹è±¡ä¸­</span>
        page<span class="token punctuation">.</span><span class="token function">setTotalRecord</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> totalRecord<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// è·å–å½“å‰é¡µä¸­çš„è®°å½•å­˜æ”¾çš„List</span>
        String sql2 <span class="token operator">=</span> <span class="token string">"select id,title,author,price,sales,stock,img_path imgPath from books where price between ? and ? limit ?,?"</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªé›†åˆçš„æ–¹æ³•</span>
        List<span class="token operator">&lt;</span>Book<span class="token operator">></span> beanList <span class="token operator">=</span> <span class="token function">getBeanList</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql2<span class="token punctuation">,</span> minPrice <span class="token punctuation">,</span> maxPrice <span class="token punctuation">,</span> <span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">getPageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> Page<span class="token punctuation">.</span>PAGE_SIZE<span class="token punctuation">,</span> Page<span class="token punctuation">.</span>PAGE_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å°†è¿™ä¸ªListè®¾ç½®åˆ°pageå¯¹è±¡ä¸­</span>
        page<span class="token punctuation">.</span><span class="token function">setList</span><span class="token punctuation">(</span>beanList<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> page<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="ã€UserDaoImpl-javaã€‘"><a href="#ã€UserDaoImpl-javaã€‘" class="headerlink" title="ã€UserDaoImpl.javaã€‘"></a>ã€UserDaoImpl.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>impl<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>User<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>BaseDao<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>UserDao<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDaoImpl</span> <span class="token keyword">extends</span> <span class="token class-name">BaseDao</span><span class="token operator">&lt;</span>User<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">UserDao</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> User <span class="token function">getUser</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>User user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•</span>
        User bean <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å†™sqlè¯­å¥</span>
        String sql <span class="token operator">=</span> <span class="token string">"select id,username,password,email from users where username = ? and password = ?"</span><span class="token punctuation">;</span>
        bean <span class="token operator">=</span> <span class="token function">getBean</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">checkUsername</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>User user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•</span>
        User bean <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å†™sqlè¯­å¥</span>
        String sql <span class="token operator">=</span> <span class="token string">"select id,username,password,email from users where username = ?"</span><span class="token punctuation">;</span>
        bean <span class="token operator">=</span> <span class="token function">getBean</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> bean <span class="token operator">!=</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveUser</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>User user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//å†™sqlè¯­å¥</span>
        String sql <span class="token operator">=</span> <span class="token string">"insert into users(username,password,email) values(?,?,?)"</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//è°ƒç”¨BaseDaoä¸­é€šç”¨çš„å¢åˆ æ”¹çš„æ–¹æ³•</span>
        <span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>user<span class="token punctuation">.</span><span class="token function">getEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="ã€Book-javaã€‘"><a href="#ã€Book-javaã€‘" class="headerlink" title="ã€Book.javaã€‘"></a>ã€Book.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * å›¾ä¹¦ç±»
 * @author songhongkang
 *
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Book</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> Integer id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String title<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ä¹¦å</span>
    <span class="token keyword">private</span> String author<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ä½œè€…</span>
    <span class="token keyword">private</span> <span class="token keyword">double</span> price<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ä»·æ ¼</span>
    <span class="token keyword">private</span> Integer sales<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// é”€é‡</span>
    <span class="token keyword">private</span> Integer stock<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// åº“å­˜</span>
    <span class="token keyword">private</span> String imgPath <span class="token operator">=</span> <span class="token string">"static/img/default.jpg"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å°é¢å›¾ç‰‡çš„è·¯å¾„</span>
    <span class="token comment" spellcheck="true">//æ„é€ å™¨ï¼Œget()ï¼Œset()ï¼ŒtoString()æ–¹æ³•ç•¥</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="ã€Page-javaã€‘"><a href="#ã€Page-javaã€‘" class="headerlink" title="ã€Page.javaã€‘"></a>ã€Page.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * é¡µç ç±»
 * @author songhongkang
 *
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Page</span><span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> List<span class="token operator">&lt;</span>T<span class="token operator">></span> list<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// æ¯é¡µæŸ¥åˆ°çš„è®°å½•å­˜æ”¾çš„é›†åˆ</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> PAGE_SIZE <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// æ¯é¡µæ˜¾ç¤ºçš„è®°å½•æ•°</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> pageNo<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å½“å‰é¡µ</span>
<span class="token comment" spellcheck="true">//    private int totalPageNo; // æ€»é¡µæ•°ï¼Œé€šè¿‡è®¡ç®—å¾—åˆ°</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> totalRecord<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// æ€»è®°å½•æ•°ï¼Œé€šè¿‡æŸ¥è¯¢æ•°æ®åº“å¾—åˆ°</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="ã€User-javaã€‘"><a href="#ã€User-javaã€‘" class="headerlink" title="ã€User.javaã€‘"></a>ã€User.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * ç”¨æˆ·ç±»
 * @author songhongkang
 *
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> Integer id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String username<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String password<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String email<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="ç¬¬8ç« ï¼šæ•°æ®åº“è¿æ¥æ± "><a href="#ç¬¬8ç« ï¼šæ•°æ®åº“è¿æ¥æ± " class="headerlink" title="ç¬¬8ç« ï¼šæ•°æ®åº“è¿æ¥æ± "></a>ç¬¬8ç« ï¼šæ•°æ®åº“è¿æ¥æ± </h2><h3 id="8-1-JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§"><a href="#8-1-JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§" class="headerlink" title="8.1 JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§"></a>8.1 JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§</h3><ul>
<li><p>åœ¨ä½¿ç”¨å¼€å‘åŸºäºæ•°æ®åº“çš„webç¨‹åºæ—¶ï¼Œä¼ ç»Ÿçš„æ¨¡å¼åŸºæœ¬æ˜¯æŒ‰ä»¥ä¸‹æ­¥éª¤ï¼šã€€ã€€</p>
<ul>
<li><strong>åœ¨ä¸»ç¨‹åºï¼ˆå¦‚servletã€beansï¼‰ä¸­å»ºç«‹æ•°æ®åº“è¿æ¥</strong></li>
<li><strong>è¿›è¡Œsqlæ“ä½œ</strong></li>
<li><strong>æ–­å¼€æ•°æ®åº“è¿æ¥</strong></li>
</ul>
</li>
<li><p>è¿™ç§æ¨¡å¼å¼€å‘ï¼Œå­˜åœ¨çš„é—®é¢˜:</p>
<ul>
<li>æ™®é€šçš„JDBCæ•°æ®åº“è¿æ¥ä½¿ç”¨ DriverManager æ¥è·å–ï¼Œæ¯æ¬¡å‘æ•°æ®åº“å»ºç«‹è¿æ¥çš„æ—¶å€™éƒ½è¦å°† Connection åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå†éªŒè¯ç”¨æˆ·åå’Œå¯†ç (å¾—èŠ±è´¹0.05sï½1sçš„æ—¶é—´)ã€‚éœ€è¦æ•°æ®åº“è¿æ¥çš„æ—¶å€™ï¼Œå°±å‘æ•°æ®åº“è¦æ±‚ä¸€ä¸ªï¼Œæ‰§è¡Œå®Œæˆåå†æ–­å¼€è¿æ¥ã€‚è¿™æ ·çš„æ–¹å¼å°†ä¼šæ¶ˆè€—å¤§é‡çš„èµ„æºå’Œæ—¶é—´ã€‚<strong>æ•°æ®åº“çš„è¿æ¥èµ„æºå¹¶æ²¡æœ‰å¾—åˆ°å¾ˆå¥½çš„é‡å¤åˆ©ç”¨ã€‚</strong>è‹¥åŒæ—¶æœ‰å‡ ç™¾äººç”šè‡³å‡ åƒäººåœ¨çº¿ï¼Œé¢‘ç¹çš„è¿›è¡Œæ•°æ®åº“è¿æ¥æ“ä½œå°†å ç”¨å¾ˆå¤šçš„ç³»ç»Ÿèµ„æºï¼Œä¸¥é‡çš„ç”šè‡³ä¼šé€ æˆæœåŠ¡å™¨çš„å´©æºƒã€‚</li>
<li><strong>å¯¹äºæ¯ä¸€æ¬¡æ•°æ®åº“è¿æ¥ï¼Œä½¿ç”¨å®Œåéƒ½å¾—æ–­å¼€ã€‚</strong>å¦åˆ™ï¼Œå¦‚æœç¨‹åºå‡ºç°å¼‚å¸¸è€Œæœªèƒ½å…³é—­ï¼Œå°†ä¼šå¯¼è‡´æ•°æ®åº“ç³»ç»Ÿä¸­çš„å†…å­˜æ³„æ¼ï¼Œæœ€ç»ˆå°†å¯¼è‡´é‡å¯æ•°æ®åº“ã€‚ï¼ˆå›å¿†ï¼šä½•ä¸ºJavaçš„å†…å­˜æ³„æ¼ï¼Ÿï¼‰</li>
<li><strong>è¿™ç§å¼€å‘ä¸èƒ½æ§åˆ¶è¢«åˆ›å»ºçš„è¿æ¥å¯¹è±¡æ•°</strong>ï¼Œç³»ç»Ÿèµ„æºä¼šè¢«æ¯«æ— é¡¾åŠçš„åˆ†é…å‡ºå»ï¼Œå¦‚è¿æ¥è¿‡å¤šï¼Œä¹Ÿå¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ï¼ŒæœåŠ¡å™¨å´©æºƒã€‚ </li>
</ul>
</li>
</ul>
<h3 id="8-2-æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯"><a href="#8-2-æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯" class="headerlink" title="8.2 æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯"></a>8.2 æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯</h3><ul>
<li><p>ä¸ºè§£å†³ä¼ ç»Ÿå¼€å‘ä¸­çš„æ•°æ®åº“è¿æ¥é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯ã€‚</p>
</li>
<li><p><strong>æ•°æ®åº“è¿æ¥æ± çš„åŸºæœ¬æ€æƒ³</strong>ï¼šå°±æ˜¯ä¸ºæ•°æ®åº“è¿æ¥å»ºç«‹ä¸€ä¸ªâ€œç¼“å†²æ± â€ã€‚é¢„å…ˆåœ¨ç¼“å†²æ± ä¸­æ”¾å…¥ä¸€å®šæ•°é‡çš„è¿æ¥ï¼Œå½“éœ€è¦å»ºç«‹æ•°æ®åº“è¿æ¥æ—¶ï¼Œåªéœ€ä»â€œç¼“å†²æ± â€ä¸­å–å‡ºä¸€ä¸ªï¼Œä½¿ç”¨å®Œæ¯•ä¹‹åå†æ”¾å›å»ã€‚</p>
</li>
<li><p><strong>æ•°æ®åº“è¿æ¥æ± </strong>è´Ÿè´£åˆ†é…ã€ç®¡ç†å’Œé‡Šæ”¾æ•°æ®åº“è¿æ¥ï¼Œå®ƒ<strong>å…è®¸åº”ç”¨ç¨‹åºé‡å¤ä½¿ç”¨ä¸€ä¸ªç°æœ‰çš„æ•°æ®åº“è¿æ¥ï¼Œè€Œä¸æ˜¯é‡æ–°å»ºç«‹ä¸€ä¸ª</strong>ã€‚</p>
</li>
<li><p>æ•°æ®åº“è¿æ¥æ± åœ¨åˆå§‹åŒ–æ—¶å°†åˆ›å»ºä¸€å®šæ•°é‡çš„æ•°æ®åº“è¿æ¥æ”¾åˆ°è¿æ¥æ± ä¸­ï¼Œè¿™äº›æ•°æ®åº“è¿æ¥çš„æ•°é‡æ˜¯ç”±<strong>æœ€å°æ•°æ®åº“è¿æ¥æ•°æ¥è®¾å®š</strong>çš„ã€‚æ— è®ºè¿™äº›æ•°æ®åº“è¿æ¥æ˜¯å¦è¢«ä½¿ç”¨ï¼Œè¿æ¥æ± éƒ½å°†ä¸€ç›´ä¿è¯è‡³å°‘æ‹¥æœ‰è¿™ä¹ˆå¤šçš„è¿æ¥æ•°é‡ã€‚è¿æ¥æ± çš„<strong>æœ€å¤§æ•°æ®åº“è¿æ¥æ•°é‡</strong>é™å®šäº†è¿™ä¸ªè¿æ¥æ± èƒ½å æœ‰çš„æœ€å¤§è¿æ¥æ•°ï¼Œå½“åº”ç”¨ç¨‹åºå‘è¿æ¥æ± è¯·æ±‚çš„è¿æ¥æ•°è¶…è¿‡æœ€å¤§è¿æ¥æ•°é‡æ—¶ï¼Œè¿™äº›è¯·æ±‚å°†è¢«åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚</p>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555593464033.png" alt="1555593464033"></p>
<ul>
<li><strong>å·¥ä½œåŸç†ï¼š</strong></li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566745811244.png" alt="1555593598606"></p>
<ul>
<li><p><strong>æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯çš„ä¼˜ç‚¹</strong></p>
<p><strong>1. èµ„æºé‡ç”¨</strong></p>
<p>ç”±äºæ•°æ®åº“è¿æ¥å¾—ä»¥é‡ç”¨ï¼Œé¿å…äº†é¢‘ç¹åˆ›å»ºï¼Œé‡Šæ”¾è¿æ¥å¼•èµ·çš„å¤§é‡æ€§èƒ½å¼€é”€ã€‚åœ¨å‡å°‘ç³»ç»Ÿæ¶ˆè€—çš„åŸºç¡€ä¸Šï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¢åŠ äº†ç³»ç»Ÿè¿è¡Œç¯å¢ƒçš„å¹³ç¨³æ€§ã€‚</p>
<p><strong>2. æ›´å¿«çš„ç³»ç»Ÿååº”é€Ÿåº¦</strong></p>
<p>æ•°æ®åº“è¿æ¥æ± åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€å·²ç»åˆ›å»ºäº†è‹¥å¹²æ•°æ®åº“è¿æ¥ç½®äºè¿æ¥æ± ä¸­å¤‡ç”¨ã€‚æ­¤æ—¶è¿æ¥çš„åˆå§‹åŒ–å·¥ä½œå‡å·²å®Œæˆã€‚å¯¹äºä¸šåŠ¡è¯·æ±‚å¤„ç†è€Œè¨€ï¼Œç›´æ¥åˆ©ç”¨ç°æœ‰å¯ç”¨è¿æ¥ï¼Œé¿å…äº†æ•°æ®åº“è¿æ¥åˆå§‹åŒ–å’Œé‡Šæ”¾è¿‡ç¨‹çš„æ—¶é—´å¼€é”€ï¼Œä»è€Œå‡å°‘äº†ç³»ç»Ÿçš„å“åº”æ—¶é—´</p>
<p><strong>3. æ–°çš„èµ„æºåˆ†é…æ‰‹æ®µ</strong></p>
<p>å¯¹äºå¤šåº”ç”¨å…±äº«åŒä¸€æ•°æ®åº“çš„ç³»ç»Ÿè€Œè¨€ï¼Œå¯åœ¨åº”ç”¨å±‚é€šè¿‡æ•°æ®åº“è¿æ¥æ± çš„é…ç½®ï¼Œå®ç°æŸä¸€åº”ç”¨æœ€å¤§å¯ç”¨æ•°æ®åº“è¿æ¥æ•°çš„é™åˆ¶ï¼Œé¿å…æŸä¸€åº”ç”¨ç‹¬å æ‰€æœ‰çš„æ•°æ®åº“èµ„æº</p>
<p><strong>4. ç»Ÿä¸€çš„è¿æ¥ç®¡ç†ï¼Œé¿å…æ•°æ®åº“è¿æ¥æ³„æ¼</strong></p>
<p>åœ¨è¾ƒä¸ºå®Œå–„çš„æ•°æ®åº“è¿æ¥æ± å®ç°ä¸­ï¼Œå¯æ ¹æ®é¢„å…ˆçš„å ç”¨è¶…æ—¶è®¾å®šï¼Œå¼ºåˆ¶å›æ”¶è¢«å ç”¨è¿æ¥ï¼Œä»è€Œé¿å…äº†å¸¸è§„æ•°æ®åº“è¿æ¥æ“ä½œä¸­å¯èƒ½å‡ºç°çš„èµ„æºæ³„éœ²</p>
</li>
</ul>
<h3 id="8-3-å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± "><a href="#8-3-å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="8.3 å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± "></a>8.3 å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± </h3><ul>
<li>JDBC çš„æ•°æ®åº“è¿æ¥æ± ä½¿ç”¨ javax.sql.DataSource æ¥è¡¨ç¤ºï¼ŒDataSource åªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œè¯¥æ¥å£é€šå¸¸ç”±æœåŠ¡å™¨(Weblogic, WebSphere, Tomcat)æä¾›å®ç°ï¼Œä¹Ÿæœ‰ä¸€äº›å¼€æºç»„ç»‡æä¾›å®ç°ï¼š<ul>
<li><strong>DBCP</strong> æ˜¯Apacheæä¾›çš„æ•°æ®åº“è¿æ¥æ± ã€‚tomcat æœåŠ¡å™¨è‡ªå¸¦dbcpæ•°æ®åº“è¿æ¥æ± ã€‚<strong>é€Ÿåº¦ç›¸å¯¹c3p0è¾ƒå¿«</strong>ï¼Œä½†å› è‡ªèº«å­˜åœ¨BUGï¼ŒHibernate3å·²ä¸å†æä¾›æ”¯æŒã€‚</li>
<li><strong>C3P0</strong> æ˜¯ä¸€ä¸ªå¼€æºç»„ç»‡æä¾›çš„ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œ<strong>é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ï¼Œç¨³å®šæ€§è¿˜å¯ä»¥ã€‚</strong>hibernateå®˜æ–¹æ¨èä½¿ç”¨</li>
<li><strong>Proxool</strong> æ˜¯sourceforgeä¸‹çš„ä¸€ä¸ªå¼€æºé¡¹ç›®æ•°æ®åº“è¿æ¥æ± ï¼Œæœ‰ç›‘æ§è¿æ¥æ± çŠ¶æ€çš„åŠŸèƒ½ï¼Œ<strong>ç¨³å®šæ€§è¾ƒc3p0å·®ä¸€ç‚¹</strong></li>
<li><strong>BoneCP</strong> æ˜¯ä¸€ä¸ªå¼€æºç»„ç»‡æä¾›çš„æ•°æ®åº“è¿æ¥æ± ï¼Œé€Ÿåº¦å¿«</li>
<li><strong>Druid</strong> æ˜¯é˜¿é‡Œæä¾›çš„æ•°æ®åº“è¿æ¥æ± ï¼Œæ®è¯´æ˜¯é›†DBCP ã€C3P0 ã€Proxool ä¼˜ç‚¹äºä¸€èº«çš„æ•°æ®åº“è¿æ¥æ± ï¼Œä½†æ˜¯é€Ÿåº¦ä¸ç¡®å®šæ˜¯å¦æœ‰BoneCPå¿«</li>
</ul>
</li>
<li>DataSource é€šå¸¸è¢«ç§°ä¸ºæ•°æ®æºï¼Œå®ƒåŒ…å«è¿æ¥æ± å’Œè¿æ¥æ± ç®¡ç†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¹ æƒ¯ä¸Šä¹Ÿç»å¸¸æŠŠ DataSource ç§°ä¸ºè¿æ¥æ± </li>
<li><strong>DataSourceç”¨æ¥å–ä»£DriverManageræ¥è·å–Connectionï¼Œè·å–é€Ÿåº¦å¿«ï¼ŒåŒæ—¶å¯ä»¥å¤§å¹…åº¦æé«˜æ•°æ®åº“è®¿é—®é€Ÿåº¦ã€‚</strong></li>
<li>ç‰¹åˆ«æ³¨æ„ï¼š<ul>
<li>æ•°æ®æºå’Œæ•°æ®åº“è¿æ¥ä¸åŒï¼Œæ•°æ®æºæ— éœ€åˆ›å»ºå¤šä¸ªï¼Œå®ƒæ˜¯äº§ç”Ÿæ•°æ®åº“è¿æ¥çš„å·¥å‚ï¼Œå› æ­¤<strong>æ•´ä¸ªåº”ç”¨åªéœ€è¦ä¸€ä¸ªæ•°æ®æºå³å¯ã€‚</strong></li>
<li>å½“æ•°æ®åº“è®¿é—®ç»“æŸåï¼Œç¨‹åºè¿˜æ˜¯åƒä»¥å‰ä¸€æ ·å…³é—­æ•°æ®åº“è¿æ¥ï¼šconn.close(); ä½†conn.close()å¹¶æ²¡æœ‰å…³é—­æ•°æ®åº“çš„ç‰©ç†è¿æ¥ï¼Œå®ƒä»…ä»…æŠŠæ•°æ®åº“è¿æ¥é‡Šæ”¾ï¼Œå½’è¿˜ç»™äº†æ•°æ®åº“è¿æ¥æ± ã€‚</li>
</ul>
</li>
</ul>
<h4 id="8-3-1-C3P0æ•°æ®åº“è¿æ¥æ± "><a href="#8-3-1-C3P0æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="8.3.1 C3P0æ•°æ®åº“è¿æ¥æ± "></a>8.3.1 C3P0æ•°æ®åº“è¿æ¥æ± </h4><ul>
<li>è·å–è¿æ¥æ–¹å¼ä¸€</li>
</ul>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">//ä½¿ç”¨C3P0æ•°æ®åº“è¿æ¥æ± çš„æ–¹å¼ï¼Œè·å–æ•°æ®åº“çš„è¿æ¥ï¼šä¸æ¨è</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>
    ComboPooledDataSource cpds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ComboPooledDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cpds<span class="token punctuation">.</span><span class="token function">setDriverClass</span><span class="token punctuation">(</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    cpds<span class="token punctuation">.</span><span class="token function">setJdbcUrl</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://localhost:3306/test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cpds<span class="token punctuation">.</span><span class="token function">setUser</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cpds<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"abc123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//    cpds.setMaxPoolSize(100);</span>

    Connection conn <span class="token operator">=</span> cpds<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> conn<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>è·å–è¿æ¥æ–¹å¼äºŒ</li>
</ul>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">//ä½¿ç”¨C3P0æ•°æ®åº“è¿æ¥æ± çš„é…ç½®æ–‡ä»¶æ–¹å¼ï¼Œè·å–æ•°æ®åº“çš„è¿æ¥ï¼šæ¨è</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> DataSource cpds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ComboPooledDataSource</span><span class="token punctuation">(</span><span class="token string">"helloc3p0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException<span class="token punctuation">{</span>
    Connection conn <span class="token operator">=</span> cpds<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> conn<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶ä¸­ï¼Œsrcä¸‹çš„é…ç½®æ–‡ä»¶ä¸ºï¼šã€c3p0-config.xmlã€‘</p>
<pre class="line-numbers language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>c3p0-config</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>named-config</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>helloc3p0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- è·å–è¿æ¥çš„4ä¸ªåŸºæœ¬ä¿¡æ¯ --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>abc123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>jdbcUrl<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>jdbc:mysql:///test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>driverClass<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>com.mysql.jdbc.Driver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>

        <span class="token comment" spellcheck="true">&lt;!-- æ¶‰åŠåˆ°æ•°æ®åº“è¿æ¥æ± çš„ç®¡ç†çš„ç›¸å…³å±æ€§çš„è®¾ç½® --></span>
        <span class="token comment" spellcheck="true">&lt;!-- è‹¥æ•°æ®åº“ä¸­è¿æ¥æ•°ä¸è¶³æ—¶, ä¸€æ¬¡å‘æ•°æ®åº“æœåŠ¡å™¨ç”³è¯·å¤šå°‘ä¸ªè¿æ¥ --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>acquireIncrement<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- åˆå§‹åŒ–æ•°æ®åº“è¿æ¥æ± æ—¶è¿æ¥çš„æ•°é‡ --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>initialPoolSize<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- æ•°æ®åº“è¿æ¥æ± ä¸­çš„æœ€å°çš„æ•°æ®åº“è¿æ¥æ•° --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>minPoolSize<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- æ•°æ®åº“è¿æ¥æ± ä¸­çš„æœ€å¤§çš„æ•°æ®åº“è¿æ¥æ•° --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>maxPoolSize<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- C3P0 æ•°æ®åº“è¿æ¥æ± å¯ä»¥ç»´æŠ¤çš„ Statement çš„ä¸ªæ•° --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>maxStatements<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>20<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>
        <span class="token comment" spellcheck="true">&lt;!-- æ¯ä¸ªè¿æ¥åŒæ—¶å¯ä»¥ä½¿ç”¨çš„ Statement å¯¹è±¡çš„ä¸ªæ•° --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>maxStatementsPerConnection<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>named-config</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>c3p0-config</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="8-3-2-DBCPæ•°æ®åº“è¿æ¥æ± "><a href="#8-3-2-DBCPæ•°æ®åº“è¿æ¥æ± " class="headerlink" title="8.3.2 DBCPæ•°æ®åº“è¿æ¥æ± "></a>8.3.2 DBCPæ•°æ®åº“è¿æ¥æ± </h4><ul>
<li>DBCP æ˜¯ Apache è½¯ä»¶åŸºé‡‘ç»„ç»‡ä¸‹çš„å¼€æºè¿æ¥æ± å®ç°ï¼Œè¯¥è¿æ¥æ± ä¾èµ–è¯¥ç»„ç»‡ä¸‹çš„å¦ä¸€ä¸ªå¼€æºç³»ç»Ÿï¼šCommon-poolã€‚å¦‚éœ€ä½¿ç”¨è¯¥è¿æ¥æ± å®ç°ï¼Œåº”åœ¨ç³»ç»Ÿä¸­å¢åŠ å¦‚ä¸‹ä¸¤ä¸ª jar æ–‡ä»¶ï¼š<ul>
<li>Commons-dbcp.jarï¼šè¿æ¥æ± çš„å®ç°</li>
<li>Commons-pool.jarï¼šè¿æ¥æ± å®ç°çš„ä¾èµ–åº“</li>
</ul>
</li>
<li><strong>Tomcat çš„è¿æ¥æ± æ­£æ˜¯é‡‡ç”¨è¯¥è¿æ¥æ± æ¥å®ç°çš„ã€‚</strong>è¯¥æ•°æ®åº“è¿æ¥æ± æ—¢å¯ä»¥ä¸åº”ç”¨æœåŠ¡å™¨æ•´åˆä½¿ç”¨ï¼Œä¹Ÿå¯ç”±åº”ç”¨ç¨‹åºç‹¬ç«‹ä½¿ç”¨ã€‚</li>
<li>æ•°æ®æºå’Œæ•°æ®åº“è¿æ¥ä¸åŒï¼Œæ•°æ®æºæ— éœ€åˆ›å»ºå¤šä¸ªï¼Œå®ƒæ˜¯äº§ç”Ÿæ•°æ®åº“è¿æ¥çš„å·¥å‚ï¼Œå› æ­¤æ•´ä¸ªåº”ç”¨åªéœ€è¦ä¸€ä¸ªæ•°æ®æºå³å¯ã€‚</li>
<li>å½“æ•°æ®åº“è®¿é—®ç»“æŸåï¼Œç¨‹åºè¿˜æ˜¯åƒä»¥å‰ä¸€æ ·å…³é—­æ•°æ®åº“è¿æ¥ï¼šconn.close(); ä½†ä¸Šé¢çš„ä»£ç å¹¶æ²¡æœ‰å…³é—­æ•°æ®åº“çš„ç‰©ç†è¿æ¥ï¼Œå®ƒä»…ä»…æŠŠæ•°æ®åº“è¿æ¥é‡Šæ”¾ï¼Œå½’è¿˜ç»™äº†æ•°æ®åº“è¿æ¥æ± ã€‚</li>
<li>é…ç½®å±æ€§è¯´æ˜</li>
</ul>
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>é»˜è®¤å€¼</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>initialSize</td>
<td>0</td>
<td>è¿æ¥æ± å¯åŠ¨æ—¶åˆ›å»ºçš„åˆå§‹åŒ–è¿æ¥æ•°é‡</td>
</tr>
<tr>
<td>maxActive</td>
<td>8</td>
<td>è¿æ¥æ± ä¸­å¯åŒæ—¶è¿æ¥çš„æœ€å¤§çš„è¿æ¥æ•°</td>
</tr>
<tr>
<td>maxIdle</td>
<td>8</td>
<td>è¿æ¥æ± ä¸­æœ€å¤§çš„ç©ºé—²çš„è¿æ¥æ•°ï¼Œè¶…è¿‡çš„ç©ºé—²è¿æ¥å°†è¢«é‡Šæ”¾ï¼Œå¦‚æœè®¾ç½®ä¸ºè´Ÿæ•°è¡¨ç¤ºä¸é™åˆ¶</td>
</tr>
<tr>
<td>minIdle</td>
<td>0</td>
<td>è¿æ¥æ± ä¸­æœ€å°çš„ç©ºé—²çš„è¿æ¥æ•°ï¼Œä½äºè¿™ä¸ªæ•°é‡ä¼šè¢«åˆ›å»ºæ–°çš„è¿æ¥ã€‚è¯¥å‚æ•°è¶Šæ¥è¿‘maxIdleï¼Œæ€§èƒ½è¶Šå¥½ï¼Œå› ä¸ºè¿æ¥çš„åˆ›å»ºå’Œé”€æ¯ï¼Œéƒ½æ˜¯éœ€è¦æ¶ˆè€—èµ„æºçš„ï¼›ä½†æ˜¯ä¸èƒ½å¤ªå¤§ã€‚</td>
</tr>
<tr>
<td>maxWait</td>
<td>æ— é™åˆ¶</td>
<td>æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œå½“æ²¡æœ‰å¯ç”¨è¿æ¥æ—¶ï¼Œè¿æ¥æ± ç­‰å¾…è¿æ¥é‡Šæ”¾çš„æœ€å¤§æ—¶é—´ï¼Œè¶…è¿‡è¯¥æ—¶é—´é™åˆ¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚æœè®¾ç½®-1è¡¨ç¤ºæ— é™ç­‰å¾…</td>
</tr>
<tr>
<td>poolPreparedStatements</td>
<td>false</td>
<td>å¼€å¯æ± çš„Statementæ˜¯å¦prepared</td>
</tr>
<tr>
<td>maxOpenPreparedStatements</td>
<td>æ— é™åˆ¶</td>
<td>å¼€å¯æ± çš„prepared åçš„åŒæ—¶æœ€å¤§è¿æ¥æ•°</td>
</tr>
<tr>
<td>minEvictableIdleTimeMillis</td>
<td></td>
<td>è¿æ¥æ± ä¸­è¿æ¥ï¼Œåœ¨æ—¶é—´æ®µå†…ä¸€ç›´ç©ºé—²ï¼Œ è¢«é€å‡ºè¿æ¥æ± çš„æ—¶é—´</td>
</tr>
<tr>
<td>removeAbandonedTimeout</td>
<td>300</td>
<td>è¶…è¿‡æ—¶é—´é™åˆ¶ï¼Œå›æ”¶æ²¡æœ‰ç”¨(åºŸå¼ƒ)çš„è¿æ¥</td>
</tr>
<tr>
<td>removeAbandoned</td>
<td>false</td>
<td>è¶…è¿‡removeAbandonedTimeoutæ—¶é—´åï¼Œæ˜¯å¦è¿› è¡Œæ²¡ç”¨è¿æ¥ï¼ˆåºŸå¼ƒï¼‰çš„å›æ”¶</td>
</tr>
</tbody></table>
<ul>
<li>è·å–è¿æ¥æ–¹å¼ä¸€ï¼š</li>
</ul>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>
    BasicDataSource source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BasicDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    source<span class="token punctuation">.</span><span class="token function">setDriverClassName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    source<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql:///test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    source<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    source<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"abc123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//</span>
    source<span class="token punctuation">.</span><span class="token function">setInitialSize</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Connection conn <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> conn<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>è·å–è¿æ¥æ–¹å¼äºŒï¼š</li>
</ul>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">//ä½¿ç”¨dbcpæ•°æ®åº“è¿æ¥æ± çš„é…ç½®æ–‡ä»¶æ–¹å¼ï¼Œè·å–æ•°æ®åº“çš„è¿æ¥ï¼šæ¨è</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> DataSource source <span class="token operator">=</span> null<span class="token punctuation">;</span>
<span class="token keyword">static</span><span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        Properties pros <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        InputStream is <span class="token operator">=</span> DBCPTest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"dbcp.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        pros<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//æ ¹æ®æä¾›çš„BasicDataSourceFactoryåˆ›å»ºå¯¹åº”çš„DataSourceå¯¹è±¡</span>
        source <span class="token operator">=</span> BasicDataSourceFactory<span class="token punctuation">.</span><span class="token function">createDataSource</span><span class="token punctuation">(</span>pros<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>

    Connection conn <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> conn<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶ä¸­ï¼Œsrcä¸‹çš„é…ç½®æ–‡ä»¶ä¸ºï¼šã€dbcp.propertiesã€‘</p>
<pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">driverClassName</span><span class="token punctuation">=</span><span class="token attr-value">com.mysql.jdbc.Driver</span>
<span class="token attr-name">url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost:3306/test?rewriteBatchedStatements=true&amp;useServerPrepStmts=false</span>
<span class="token attr-name">username</span><span class="token punctuation">=</span><span class="token attr-value">root</span>
<span class="token attr-name">password</span><span class="token punctuation">=</span><span class="token attr-value">abc123</span>

<span class="token attr-name">initialSize</span><span class="token punctuation">=</span><span class="token attr-value">10</span>
<span class="token comment" spellcheck="true">#...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="8-3-3-Druidï¼ˆå¾·é²ä¼Šï¼‰æ•°æ®åº“è¿æ¥æ± "><a href="#8-3-3-Druidï¼ˆå¾·é²ä¼Šï¼‰æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="8.3.3 Druidï¼ˆå¾·é²ä¼Šï¼‰æ•°æ®åº“è¿æ¥æ± "></a>8.3.3 Druidï¼ˆå¾·é²ä¼Šï¼‰æ•°æ®åº“è¿æ¥æ± </h4><p>Druidæ˜¯é˜¿é‡Œå·´å·´å¼€æºå¹³å°ä¸Šä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± å®ç°ï¼Œå®ƒç»“åˆäº†C3P0ã€DBCPã€Proxoolç­‰DBæ± çš„ä¼˜ç‚¹ï¼ŒåŒæ—¶åŠ å…¥äº†æ—¥å¿—ç›‘æ§ï¼Œå¯ä»¥å¾ˆå¥½çš„ç›‘æ§DBæ± è¿æ¥å’ŒSQLçš„æ‰§è¡Œæƒ…å†µï¼Œå¯ä»¥è¯´æ˜¯é’ˆå¯¹ç›‘æ§è€Œç”Ÿçš„DBè¿æ¥æ± ï¼Œ<strong>å¯ä»¥è¯´æ˜¯ç›®å‰æœ€å¥½çš„è¿æ¥æ± ä¹‹ä¸€ã€‚</strong></p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>druid<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Properties<span class="token punctuation">;</span>

<span class="token keyword">import</span> javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>DataSource<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>druid<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>DruidDataSourceFactory<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestDruid</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>
        Properties pro <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         pro<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>TestDruid<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"druid.properties"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        DataSource ds <span class="token operator">=</span> DruidDataSourceFactory<span class="token punctuation">.</span><span class="token function">createDataSource</span><span class="token punctuation">(</span>pro<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Connection conn <span class="token operator">=</span> ds<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å…¶ä¸­ï¼Œsrcä¸‹çš„é…ç½®æ–‡ä»¶ä¸ºï¼šã€druid.propertiesã€‘</p>
<pre class="line-numbers language-java"><code class="language-java">url<span class="token operator">=</span>jdbc<span class="token operator">:</span>mysql<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">3306</span><span class="token operator">/</span>test<span class="token operator">?</span>rewriteBatchedStatements<span class="token operator">=</span><span class="token boolean">true</span>
username<span class="token operator">=</span>root
password<span class="token operator">=</span><span class="token number">123456</span>
driverClassName<span class="token operator">=</span>com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver

initialSize<span class="token operator">=</span><span class="token number">10</span>
maxActive<span class="token operator">=</span><span class="token number">20</span>
maxWait<span class="token operator">=</span><span class="token number">1000</span>
filters<span class="token operator">=</span>wall<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>è¯¦ç»†é…ç½®å‚æ•°ï¼š</li>
</ul>
<table>
<thead>
<tr>
<th><strong>é…ç½®</strong></th>
<th><strong>ç¼ºçœ</strong></th>
<th><strong>è¯´æ˜</strong></th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td></td>
<td>é…ç½®è¿™ä¸ªå±æ€§çš„æ„ä¹‰åœ¨äºï¼Œå¦‚æœå­˜åœ¨å¤šä¸ªæ•°æ®æºï¼Œç›‘æ§çš„æ—¶å€™å¯ä»¥é€šè¿‡åå­—æ¥åŒºåˆ†å¼€æ¥ã€‚   å¦‚æœæ²¡æœ‰é…ç½®ï¼Œå°†ä¼šç”Ÿæˆä¸€ä¸ªåå­—ï¼Œæ ¼å¼æ˜¯ï¼šâ€DataSource-â€ +   System.identityHashCode(this)</td>
</tr>
<tr>
<td>url</td>
<td></td>
<td>è¿æ¥æ•°æ®åº“çš„urlï¼Œä¸åŒæ•°æ®åº“ä¸ä¸€æ ·ã€‚ä¾‹å¦‚ï¼šmysql :   jdbc:mysql://10.20.153.104:3306/druid2      oracle :   jdbc:oracle:thin:@10.20.149.85:1521:ocnauto</td>
</tr>
<tr>
<td>username</td>
<td></td>
<td>è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·å</td>
</tr>
<tr>
<td>password</td>
<td></td>
<td>è¿æ¥æ•°æ®åº“çš„å¯†ç ã€‚å¦‚æœä½ ä¸å¸Œæœ›å¯†ç ç›´æ¥å†™åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ConfigFilterã€‚è¯¦ç»†çœ‹è¿™é‡Œï¼š<a target="_blank" rel="noopener" href="https://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter">https://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter</a></td>
</tr>
<tr>
<td>driverClassName</td>
<td></td>
<td>æ ¹æ®urlè‡ªåŠ¨è¯†åˆ«   è¿™ä¸€é¡¹å¯é…å¯ä¸é…ï¼Œå¦‚æœä¸é…ç½®druidä¼šæ ¹æ®urlè‡ªåŠ¨è¯†åˆ«dbTypeï¼Œç„¶åé€‰æ‹©ç›¸åº”çš„driverClassName(å»ºè®®é…ç½®ä¸‹)</td>
</tr>
<tr>
<td>initialSize</td>
<td>0</td>
<td>åˆå§‹åŒ–æ—¶å»ºç«‹ç‰©ç†è¿æ¥çš„ä¸ªæ•°ã€‚åˆå§‹åŒ–å‘ç”Ÿåœ¨æ˜¾ç¤ºè°ƒç”¨initæ–¹æ³•ï¼Œæˆ–è€…ç¬¬ä¸€æ¬¡getConnectionæ—¶</td>
</tr>
<tr>
<td>maxActive</td>
<td>8</td>
<td>æœ€å¤§è¿æ¥æ± æ•°é‡</td>
</tr>
<tr>
<td>maxIdle</td>
<td>8</td>
<td>å·²ç»ä¸å†ä½¿ç”¨ï¼Œé…ç½®äº†ä¹Ÿæ²¡æ•ˆæœ</td>
</tr>
<tr>
<td>minIdle</td>
<td></td>
<td>æœ€å°è¿æ¥æ± æ•°é‡</td>
</tr>
<tr>
<td>maxWait</td>
<td></td>
<td>è·å–è¿æ¥æ—¶æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œå•ä½æ¯«ç§’ã€‚é…ç½®äº†maxWaitä¹‹åï¼Œç¼ºçœå¯ç”¨å…¬å¹³é”ï¼Œå¹¶å‘æ•ˆç‡ä¼šæœ‰æ‰€ä¸‹é™ï¼Œå¦‚æœéœ€è¦å¯ä»¥é€šè¿‡é…ç½®useUnfairLockå±æ€§ä¸ºtrueä½¿ç”¨éå…¬å¹³é”ã€‚</td>
</tr>
<tr>
<td>poolPreparedStatements</td>
<td>false</td>
<td>æ˜¯å¦ç¼“å­˜preparedStatementï¼Œä¹Ÿå°±æ˜¯PSCacheã€‚PSCacheå¯¹æ”¯æŒæ¸¸æ ‡çš„æ•°æ®åº“æ€§èƒ½æå‡å·¨å¤§ï¼Œæ¯”å¦‚è¯´oracleã€‚åœ¨mysqlä¸‹å»ºè®®å…³é—­ã€‚</td>
</tr>
<tr>
<td>maxOpenPreparedStatements</td>
<td>-1</td>
<td>è¦å¯ç”¨PSCacheï¼Œå¿…é¡»é…ç½®å¤§äº0ï¼Œå½“å¤§äº0æ—¶ï¼ŒpoolPreparedStatementsè‡ªåŠ¨è§¦å‘ä¿®æ”¹ä¸ºtrueã€‚åœ¨Druidä¸­ï¼Œä¸ä¼šå­˜åœ¨Oracleä¸‹PSCacheå ç”¨å†…å­˜è¿‡å¤šçš„é—®é¢˜ï¼Œå¯ä»¥æŠŠè¿™ä¸ªæ•°å€¼é…ç½®å¤§ä¸€äº›ï¼Œæ¯”å¦‚è¯´100</td>
</tr>
<tr>
<td>validationQuery</td>
<td></td>
<td>ç”¨æ¥æ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆçš„sqlï¼Œè¦æ±‚æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ã€‚å¦‚æœvalidationQueryä¸ºnullï¼ŒtestOnBorrowã€testOnReturnã€testWhileIdleéƒ½ä¸ä¼šå…¶ä½œç”¨ã€‚</td>
</tr>
<tr>
<td>testOnBorrow</td>
<td>true</td>
<td>ç”³è¯·è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½ã€‚</td>
</tr>
<tr>
<td>testOnReturn</td>
<td>false</td>
<td>å½’è¿˜è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½</td>
</tr>
<tr>
<td>testWhileIdle</td>
<td>false</td>
<td>å»ºè®®é…ç½®ä¸ºtrueï¼Œä¸å½±å“æ€§èƒ½ï¼Œå¹¶ä¸”ä¿è¯å®‰å…¨æ€§ã€‚ç”³è¯·è¿æ¥çš„æ—¶å€™æ£€æµ‹ï¼Œå¦‚æœç©ºé—²æ—¶é—´å¤§äºtimeBetweenEvictionRunsMillisï¼Œæ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆã€‚</td>
</tr>
<tr>
<td>timeBetweenEvictionRunsMillis</td>
<td></td>
<td>æœ‰ä¸¤ä¸ªå«ä¹‰ï¼š 1)Destroyçº¿ç¨‹ä¼šæ£€æµ‹è¿æ¥çš„é—´éš”æ—¶é—´2)testWhileIdleçš„åˆ¤æ–­ä¾æ®ï¼Œè¯¦ç»†çœ‹testWhileIdleå±æ€§çš„è¯´æ˜</td>
</tr>
<tr>
<td>numTestsPerEvictionRun</td>
<td></td>
<td>ä¸å†ä½¿ç”¨ï¼Œä¸€ä¸ªDruidDataSourceåªæ”¯æŒä¸€ä¸ªEvictionRun</td>
</tr>
<tr>
<td>minEvictableIdleTimeMillis</td>
<td></td>
<td></td>
</tr>
<tr>
<td>connectionInitSqls</td>
<td></td>
<td>ç‰©ç†è¿æ¥åˆå§‹åŒ–çš„æ—¶å€™æ‰§è¡Œçš„sql</td>
</tr>
<tr>
<td>exceptionSorter</td>
<td></td>
<td>æ ¹æ®dbTypeè‡ªåŠ¨è¯†åˆ«   å½“æ•°æ®åº“æŠ›å‡ºä¸€äº›ä¸å¯æ¢å¤çš„å¼‚å¸¸æ—¶ï¼ŒæŠ›å¼ƒè¿æ¥</td>
</tr>
<tr>
<td>filters</td>
<td></td>
<td>å±æ€§ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œé€šè¿‡åˆ«åçš„æ–¹å¼é…ç½®æ‰©å±•æ’ä»¶ï¼Œå¸¸ç”¨çš„æ’ä»¶æœ‰ï¼š   ç›‘æ§ç»Ÿè®¡ç”¨çš„filter:statæ—¥å¿—ç”¨çš„filter:log4jé˜²å¾¡sqlæ³¨å…¥çš„filter:wall</td>
</tr>
<tr>
<td>proxyFilters</td>
<td></td>
<td>ç±»å‹æ˜¯Listï¼Œå¦‚æœåŒæ—¶é…ç½®äº†filterså’ŒproxyFiltersï¼Œæ˜¯ç»„åˆå…³ç³»ï¼Œå¹¶éæ›¿æ¢å…³ç³»</td>
</tr>
</tbody></table>
<h2 id="ç¬¬9ç« ï¼šApache-DBUtilså®ç°CRUDæ“ä½œ"><a href="#ç¬¬9ç« ï¼šApache-DBUtilså®ç°CRUDæ“ä½œ" class="headerlink" title="ç¬¬9ç« ï¼šApache-DBUtilså®ç°CRUDæ“ä½œ"></a>ç¬¬9ç« ï¼šApache-DBUtilså®ç°CRUDæ“ä½œ</h2><h3 id="9-1-Apache-DBUtilsç®€ä»‹"><a href="#9-1-Apache-DBUtilsç®€ä»‹" class="headerlink" title="9.1 Apache-DBUtilsç®€ä»‹"></a>9.1 Apache-DBUtilsç®€ä»‹</h3><ul>
<li><p>commons-dbutils æ˜¯ Apache ç»„ç»‡æä¾›çš„ä¸€ä¸ªå¼€æº JDBCå·¥å…·ç±»åº“ï¼Œå®ƒæ˜¯å¯¹JDBCçš„ç®€å•å°è£…ï¼Œå­¦ä¹ æˆæœ¬æä½ï¼Œå¹¶ä¸”ä½¿ç”¨dbutilsèƒ½æå¤§ç®€åŒ–jdbcç¼–ç çš„å·¥ä½œé‡ï¼ŒåŒæ—¶ä¹Ÿä¸ä¼šå½±å“ç¨‹åºçš„æ€§èƒ½ã€‚</p>
</li>
<li><p>APIä»‹ç»ï¼š</p>
<ul>
<li>org.apache.commons.dbutils.QueryRunner</li>
<li>org.apache.commons.dbutils.ResultSetHandler</li>
<li>å·¥å…·ç±»ï¼šorg.apache.commons.dbutils.DbUtils   </li>
</ul>
</li>
<li><p>APIåŒ…è¯´æ˜ï¼š</p>
</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555595163263.png" alt="1555595163263"></p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555595198644.png" alt="1555595198644"></p>
<h3 id="9-2-ä¸»è¦APIçš„ä½¿ç”¨"><a href="#9-2-ä¸»è¦APIçš„ä½¿ç”¨" class="headerlink" title="9.2 ä¸»è¦APIçš„ä½¿ç”¨"></a>9.2 ä¸»è¦APIçš„ä½¿ç”¨</h3><h4 id="9-2-1-DbUtils"><a href="#9-2-1-DbUtils" class="headerlink" title="9.2.1 DbUtils"></a>9.2.1 DbUtils</h4><ul>
<li>DbUtils ï¼šæä¾›å¦‚å…³é—­è¿æ¥ã€è£…è½½JDBCé©±åŠ¨ç¨‹åºç­‰å¸¸è§„å·¥ä½œçš„å·¥å…·ç±»ï¼Œé‡Œé¢çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯é™æ€çš„ã€‚ä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š<ul>
<li><strong>public static void close(â€¦) throws java.sql.SQLException</strong>ï¼šã€€DbUtilsç±»æä¾›äº†ä¸‰ä¸ªé‡è½½çš„å…³é—­æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•æ£€æŸ¥æ‰€æä¾›çš„å‚æ•°æ˜¯ä¸æ˜¯NULLï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼Œå®ƒä»¬å°±å…³é—­Connectionã€Statementå’ŒResultSetã€‚</li>
<li>public static void closeQuietly(â€¦): è¿™ä¸€ç±»æ–¹æ³•ä¸ä»…èƒ½åœ¨Connectionã€Statementå’ŒResultSetä¸ºNULLæƒ…å†µä¸‹é¿å…å…³é—­ï¼Œè¿˜èƒ½éšè—ä¸€äº›åœ¨ç¨‹åºä¸­æŠ›å‡ºçš„SQLEeceptionã€‚</li>
<li>public static void commitAndClose(Connection conn)throws SQLExceptionï¼š ç”¨æ¥æäº¤è¿æ¥çš„äº‹åŠ¡ï¼Œç„¶åå…³é—­è¿æ¥</li>
<li>public static void commitAndCloseQuietly(Connection conn)ï¼š ç”¨æ¥æäº¤è¿æ¥ï¼Œç„¶åå…³é—­è¿æ¥ï¼Œå¹¶ä¸”åœ¨å…³é—­è¿æ¥æ—¶ä¸æŠ›å‡ºSQLå¼‚å¸¸ã€‚ </li>
<li>public static void rollback(Connection conn)throws SQLExceptionï¼šå…è®¸connä¸ºnullï¼Œå› ä¸ºæ–¹æ³•å†…éƒ¨åšäº†åˆ¤æ–­</li>
<li>public static void rollbackAndClose(Connection conn)throws SQLException</li>
<li>rollbackAndCloseQuietly(Connection)</li>
<li>public static boolean loadDriver(java.lang.String driverClassName)ï¼šè¿™ä¸€æ–¹è£…è½½å¹¶æ³¨å†ŒJDBCé©±åŠ¨ç¨‹åºï¼Œå¦‚æœæˆåŠŸå°±è¿”å›trueã€‚ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œä½ ä¸éœ€è¦æ•æ‰è¿™ä¸ªå¼‚å¸¸ClassNotFoundExceptionã€‚</li>
</ul>
</li>
</ul>
<h4 id="9-2-2-QueryRunnerç±»"><a href="#9-2-2-QueryRunnerç±»" class="headerlink" title="9.2.2 QueryRunnerç±»"></a>9.2.2 QueryRunnerç±»</h4><ul>
<li><p><strong>è¯¥ç±»ç®€å•åŒ–äº†SQLæŸ¥è¯¢ï¼Œå®ƒä¸ResultSetHandlerç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨å¯ä»¥å®Œæˆå¤§éƒ¨åˆ†çš„æ•°æ®åº“æ“ä½œï¼Œèƒ½å¤Ÿå¤§å¤§å‡å°‘ç¼–ç é‡ã€‚</strong></p>
</li>
<li><p>QueryRunnerç±»æä¾›äº†ä¸¤ä¸ªæ„é€ å™¨ï¼š</p>
<ul>
<li>é»˜è®¤çš„æ„é€ å™¨</li>
<li>éœ€è¦ä¸€ä¸ª javax.sql.DataSource æ¥ä½œå‚æ•°çš„æ„é€ å™¨</li>
</ul>
</li>
<li><p>QueryRunnerç±»çš„ä¸»è¦æ–¹æ³•ï¼š</p>
<ul>
<li><strong>æ›´æ–°</strong><ul>
<li>public int update(Connection conn, String sql, Objectâ€¦ params) throws SQLException:ç”¨æ¥æ‰§è¡Œä¸€ä¸ªæ›´æ–°ï¼ˆæ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤ï¼‰æ“ä½œã€‚</li>
<li>â€¦â€¦</li>
</ul>
</li>
<li><strong>æ’å…¥</strong><ul>
<li>public <t> T insert(Connection conn,String sql,ResultSetHandler<t> rsh, Objectâ€¦ params) throws SQLExceptionï¼šåªæ”¯æŒINSERTè¯­å¥ï¼Œå…¶ä¸­ rsh - The handler used to create the result object from the ResultSet of auto-generated keys.  è¿”å›å€¼: An object generated by the handler.å³è‡ªåŠ¨ç”Ÿæˆçš„é”®å€¼</t></t></li>
<li>â€¦.</li>
</ul>
</li>
<li><strong>æ‰¹å¤„ç†</strong><ul>
<li>public int[] batch(Connection conn,String sql,Object[][] params)throws SQLExceptionï¼š INSERT, UPDATE, or DELETEè¯­å¥</li>
<li>public <t> T insertBatch(Connection conn,String sql,ResultSetHandler<t> rsh,Object[][] params)throws SQLExceptionï¼šåªæ”¯æŒINSERTè¯­å¥</t></t></li>
<li>â€¦..</li>
</ul>
</li>
<li><strong>æŸ¥è¯¢</strong><ul>
<li>public Object query(Connection conn, String sql, ResultSetHandler rsh,Objectâ€¦ params) throws SQLExceptionï¼šæ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢æ“ä½œï¼Œåœ¨è¿™ä¸ªæŸ¥è¯¢ä¸­ï¼Œå¯¹è±¡æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ å€¼è¢«ç”¨æ¥ä½œä¸ºæŸ¥è¯¢è¯­å¥çš„ç½®æ¢å‚æ•°ã€‚è¯¥æ–¹æ³•ä¼šè‡ªè¡Œå¤„ç† PreparedStatement å’Œ ResultSet çš„åˆ›å»ºå’Œå…³é—­ã€‚</li>
<li>â€¦â€¦ </li>
</ul>
</li>
</ul>
</li>
<li><p>æµ‹è¯•</p>
</li>
</ul>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">// æµ‹è¯•æ·»åŠ </span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testInsert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>
    QueryRunner runner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    String sql <span class="token operator">=</span> <span class="token string">"insert into customers(name,email,birth)values(?,?,?)"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> runner<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> <span class="token string">"ä½•æˆé£"</span><span class="token punctuation">,</span> <span class="token string">"he@qq.com"</span><span class="token punctuation">,</span> <span class="token string">"1992-09-08"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ·»åŠ äº†"</span> <span class="token operator">+</span> count <span class="token operator">+</span> <span class="token string">"æ¡è®°å½•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">// æµ‹è¯•åˆ é™¤</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>
    QueryRunner runner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    String sql <span class="token operator">=</span> <span class="token string">"delete from customers where id &lt; ?"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> runner<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"åˆ é™¤äº†"</span> <span class="token operator">+</span> count <span class="token operator">+</span> <span class="token string">"æ¡è®°å½•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="9-2-3-ResultSetHandleræ¥å£åŠå®ç°ç±»"><a href="#9-2-3-ResultSetHandleræ¥å£åŠå®ç°ç±»" class="headerlink" title="9.2.3 ResultSetHandleræ¥å£åŠå®ç°ç±»"></a>9.2.3 ResultSetHandleræ¥å£åŠå®ç°ç±»</h4><ul>
<li><p>è¯¥æ¥å£ç”¨äºå¤„ç† java.sql.ResultSetï¼Œå°†æ•°æ®æŒ‰è¦æ±‚è½¬æ¢ä¸ºå¦ä¸€ç§å½¢å¼ã€‚</p>
</li>
<li><p>ResultSetHandler æ¥å£æä¾›äº†ä¸€ä¸ªå•ç‹¬çš„æ–¹æ³•ï¼šObject handle (java.sql.ResultSet .rs)ã€‚</p>
</li>
<li><p>æ¥å£çš„ä¸»è¦å®ç°ç±»ï¼š</p>
<ul>
<li><p>ArrayHandlerï¼šæŠŠç»“æœé›†ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®è½¬æˆå¯¹è±¡æ•°ç»„ã€‚</p>
</li>
<li><p>ArrayListHandlerï¼šæŠŠç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½è½¬æˆä¸€ä¸ªæ•°ç»„ï¼Œå†å­˜æ”¾åˆ°Listä¸­ã€‚</p>
</li>
<li><p><strong>BeanHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®å°è£…åˆ°ä¸€ä¸ªå¯¹åº”çš„JavaBeanå®ä¾‹ä¸­ã€‚</p>
</li>
<li><p><strong>BeanListHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½å°è£…åˆ°ä¸€ä¸ªå¯¹åº”çš„JavaBeanå®ä¾‹ä¸­ï¼Œå­˜æ”¾åˆ°Listé‡Œã€‚</p>
</li>
<li><p>ColumnListHandlerï¼šå°†ç»“æœé›†ä¸­æŸä¸€åˆ—çš„æ•°æ®å­˜æ”¾åˆ°Listä¸­ã€‚</p>
</li>
<li><p>KeyedHandler(name)ï¼šå°†ç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½å°è£…åˆ°ä¸€ä¸ªMapé‡Œï¼Œå†æŠŠè¿™äº›mapå†å­˜åˆ°ä¸€ä¸ªmapé‡Œï¼Œå…¶keyä¸ºæŒ‡å®šçš„keyã€‚</p>
</li>
<li><p><strong>MapHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®å°è£…åˆ°ä¸€ä¸ªMapé‡Œï¼Œkeyæ˜¯åˆ—åï¼Œvalueå°±æ˜¯å¯¹åº”çš„å€¼ã€‚</p>
</li>
<li><p><strong>MapListHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½å°è£…åˆ°ä¸€ä¸ªMapé‡Œï¼Œç„¶åå†å­˜æ”¾åˆ°List</p>
</li>
<li><p><strong>ScalarHandlerï¼š</strong>æŸ¥è¯¢å•ä¸ªå€¼å¯¹è±¡</p>
</li>
</ul>
</li>
</ul>
<ul>
<li>æµ‹è¯•</li>
</ul>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*
 * æµ‹è¯•æŸ¥è¯¢:æŸ¥è¯¢ä¸€æ¡è®°å½•
 * 
 * ä½¿ç”¨ResultSetHandlerçš„å®ç°ç±»ï¼šBeanHandler
 */</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQueryInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>
    QueryRunner runner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    String sql <span class="token operator">=</span> <span class="token string">"select id,name,email,birth from customers where id = ?"</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//</span>
    BeanHandler<span class="token operator">&lt;</span>Customer<span class="token operator">></span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanHandler</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>Customer<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Customer customer <span class="token operator">=</span> runner<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>    
    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*
 * æµ‹è¯•æŸ¥è¯¢:æŸ¥è¯¢å¤šæ¡è®°å½•æ„æˆçš„é›†åˆ
 * 
 * ä½¿ç”¨ResultSetHandlerçš„å®ç°ç±»ï¼šBeanListHandler
 */</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQueryList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>
    QueryRunner runner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    String sql <span class="token operator">=</span> <span class="token string">"select id,name,email,birth from customers where id &lt; ?"</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//</span>
    BeanListHandler<span class="token operator">&lt;</span>Customer<span class="token operator">></span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanListHandler</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>Customer<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    List<span class="token operator">&lt;</span>Customer<span class="token operator">></span> list <span class="token operator">=</span> runner<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span>println<span class="token punctuation">)</span><span class="token punctuation">;</span>

    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*
 * è‡ªå®šä¹‰ResultSetHandlerçš„å®ç°ç±»
 */</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQueryInstance1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>
    QueryRunner runner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    String sql <span class="token operator">=</span> <span class="token string">"select id,name,email,birth from customers where id = ?"</span><span class="token punctuation">;</span>

    ResultSetHandler<span class="token operator">&lt;</span>Customer<span class="token operator">></span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResultSetHandler</span><span class="token operator">&lt;</span>Customer<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> Customer <span class="token function">handle</span><span class="token punctuation">(</span>ResultSet rs<span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"handle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//            return new Customer(1,"Tom","tom@126.com",new Date(123323432L));</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">int</span> id <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                String name <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                String email <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"email"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Date birth <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token string">"birth"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> email<span class="token punctuation">,</span> birth<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> null<span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    Customer customer <span class="token operator">=</span> runner<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>

    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*
 * å¦‚ä½•æŸ¥è¯¢ç±»ä¼¼äºæœ€å¤§çš„ï¼Œæœ€å°çš„ï¼Œå¹³å‡çš„ï¼Œæ€»å’Œï¼Œä¸ªæ•°ç›¸å…³çš„æ•°æ®ï¼Œ
 * ä½¿ç”¨ScalarHandler
 * 
 */</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQueryValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>
    QueryRunner runner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//æµ‹è¯•ä¸€ï¼š</span>
<span class="token comment" spellcheck="true">//    String sql = "select count(*) from customers where id &lt; ?";</span>
<span class="token comment" spellcheck="true">//    ScalarHandler handler = new ScalarHandler();</span>
<span class="token comment" spellcheck="true">//    long count = (long) runner.query(conn, sql, handler, 20);</span>
<span class="token comment" spellcheck="true">//    System.out.println(count);</span>

    <span class="token comment" spellcheck="true">//æµ‹è¯•äºŒï¼š</span>
    String sql <span class="token operator">=</span> <span class="token string">"select max(birth) from customers"</span><span class="token punctuation">;</span>
    ScalarHandler handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ScalarHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Date birth <span class="token operator">=</span> <span class="token punctuation">(</span>Date<span class="token punctuation">)</span> runner<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>birth<span class="token punctuation">)</span><span class="token punctuation">;</span>

    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="JDBCæ€»ç»“"><a href="#JDBCæ€»ç»“" class="headerlink" title="JDBCæ€»ç»“"></a>JDBCæ€»ç»“</h2><pre class="line-numbers language-java"><code class="language-java">æ€»ç»“
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testUpdateWithTx</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//1.è·å–è¿æ¥çš„æ“ä½œï¼ˆ</span>
        <span class="token comment" spellcheck="true">//â‘  æ‰‹å†™çš„è¿æ¥ï¼šJDBCUtils.getConnection();</span>
        <span class="token comment" spellcheck="true">//â‘¡ ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± ï¼šC3P0;DBCP;Druid</span>
        <span class="token comment" spellcheck="true">//2.å¯¹æ•°æ®è¡¨è¿›è¡Œä¸€ç³»åˆ—CRUDæ“ä½œ</span>
        <span class="token comment" spellcheck="true">//â‘  ä½¿ç”¨PreparedStatementå®ç°é€šç”¨çš„å¢åˆ æ”¹ã€æŸ¥è¯¢æ“ä½œï¼ˆversion 1.0 \ version 2.0)</span>
<span class="token comment" spellcheck="true">//version2.0çš„å¢åˆ æ”¹public void update(Connection conn,String sql,Object ... args){}</span>
<span class="token comment" spellcheck="true">//version2.0çš„æŸ¥è¯¢ public &lt;T> T getInstance(Connection conn,Class&lt;T> clazz,String sql,Object ... args){}</span>
        <span class="token comment" spellcheck="true">//â‘¡ ä½¿ç”¨dbutilsæä¾›çš„jaråŒ…ä¸­æä¾›çš„QueryRunnerç±»</span>

        <span class="token comment" spellcheck="true">//æäº¤æ•°æ®</span>
        conn<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">//å›æ»šæ•°æ®</span>
            conn<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token keyword">finally</span><span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//3.å…³é—­è¿æ¥ç­‰æ“ä½œ</span>
        <span class="token comment" spellcheck="true">//â‘  JDBCUtils.closeResource();</span>
        <span class="token comment" spellcheck="true">//â‘¡ ä½¿ç”¨dbutilsæä¾›çš„jaråŒ…ä¸­æä¾›çš„DbUtilsç±»æä¾›äº†å…³é—­çš„ç›¸å…³æ“ä½œ</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">DongZhou</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://dongzhougu.github.io/2020/10/08/jdbc-he-xin-ji-zhu/">https://dongzhougu.github.io/2020/10/08/jdbc-he-xin-ji-zhu/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://dongzhougu.github.io" target="_blank">æ¬¢è¿æ¥åˆ°ï¼ŒTWOTO çš„åšå®¢</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JDBC/">JDBC</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-1.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> æ‰“èµ</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/jerryc127/CDN/Photo/wechat.jpg" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/Photo/wechat.jpg" alt="å¾®ä¿¡"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/jerryc127/CDN/Photo/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/Photo/alipay.jpg" alt="æ”¯ä»˜å¯¶"/></a><div class="post-qr-code-desc">æ”¯ä»˜å¯¶</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/jerryc127/CDN/Photo/alipayhk.jpg" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/Photo/alipayhk.jpg" alt="æ”¯ä»˜å¯¶é¦™æ¸¯"/></a><div class="post-qr-code-desc">æ”¯ä»˜å¯¶é¦™æ¸¯</div></li></ul></div></div><div class="ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-fb+5w+4e-db+86" data-ad-client="ca-pub-8919908724705274" data-ad-slot="5978969231"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/10/08/mysql-ji-chu-ru-men/"><img class="prev-cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-7.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">MySQLåŸºç¡€å…¥é—¨</div></div></a></div><div class="next-post pull-right"><a href="/2020/07/16/ji-qi-xue-xi-suan-fa-shi-xian/"><img class="next-cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-3.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">æœºå™¨å­¦ä¹ ç®—æ³•å®ç°</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div><div id="comment-switch"><span class="first-comment">Twikoo</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">DongZhou</div><div class="author-info__description">æŠ€æœ¯ã€æ•ˆç‡ã€æ‘„å½±</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">50</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">29</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">10</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly"><i class="fab fa-github"></i><span>ä¸»é¡Œ GitHub</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:gdz678@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></div><div class="announcement_content">å¦‚æœä½ åœ¨ä½¿ç”¨ä¸­é‡åˆ°å•é¡Œï¼Œè«‹åˆ° <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly/issues" style="color:#49b1f5">Github Issues</a> æˆ–è€… <a href="/messageboard/" style="color:#49b1f5">ç•™è¨€æ¿</a> é€²è¡Œåé¥‹ï¼Œä½ ä¹Ÿå¯ä»¥åŠ å…¥ QQ ç¾¤ï¼ˆç”±æ–¼ QQ ç¾¤åªèƒ½æœ‰500äººï¼Œæœƒå®šæ™‚æ¸…ç†æ½›æ°´çš„äººï¼‰<div class="social-button"> <a class="button--animated" href="https://jq.qq.com/?_wv=1027&k=KU9105XR" target="_blank">QQ 1 ç¾¤ ğŸ‘</a> <a class="button--animated" href="https://jq.qq.com/?_wv=1027&k=r1nK0DQz" target="_blank">QQ 2 ç¾¤ ğŸ‘</a> <a class="button--animated" href="https://t.me/bu2fly" target="_blank">Telegram ğŸ‘</a> </div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC1%E7%AB%A0%EF%BC%9AJDBC%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">ç¬¬1ç« ï¼šJDBCæ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 æ•°æ®çš„æŒä¹…åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-Java%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 Javaä¸­çš„æ•°æ®å­˜å‚¨æŠ€æœ¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-JDBC%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 JDBCä»‹ç»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-JDBC%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-number">1.4.</span> <span class="toc-text">1.4 JDBCä½“ç³»ç»“æ„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-JDBC%E7%A8%8B%E5%BA%8F%E7%BC%96%E5%86%99%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.5.</span> <span class="toc-text">1.5 JDBCç¨‹åºç¼–å†™æ­¥éª¤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC2%E7%AB%A0%EF%BC%9A%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.</span> <span class="toc-text">ç¬¬2ç« ï¼šè·å–æ•°æ®åº“è¿æ¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E8%A6%81%E7%B4%A0%E4%B8%80%EF%BC%9ADriver%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 è¦ç´ ä¸€ï¼šDriveræ¥å£å®ç°ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-Driver%E6%8E%A5%E5%8F%A3%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1 Driveræ¥å£ä»‹ç»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-%E5%8A%A0%E8%BD%BD%E4%B8%8E%E6%B3%A8%E5%86%8CJDBC%E9%A9%B1%E5%8A%A8"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2 åŠ è½½ä¸æ³¨å†ŒJDBCé©±åŠ¨</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E8%A6%81%E7%B4%A0%E4%BA%8C%EF%BC%9AURL"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 è¦ç´ äºŒï¼šURL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E8%A6%81%E7%B4%A0%E4%B8%89%EF%BC%9A%E7%94%A8%E6%88%B7%E5%90%8D%E5%92%8C%E5%AF%86%E7%A0%81"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 è¦ç´ ä¸‰ï¼šç”¨æˆ·åå’Œå¯†ç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E4%B8%BE%E4%BE%8B"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 æ•°æ®åº“è¿æ¥æ–¹å¼ä¸¾ä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-1-%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E4%B8%80"><span class="toc-number">2.4.1.</span> <span class="toc-text">2.4.1 è¿æ¥æ–¹å¼ä¸€</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-2-%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E4%BA%8C"><span class="toc-number">2.4.2.</span> <span class="toc-text">2.4.2 è¿æ¥æ–¹å¼äºŒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-3-%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E4%B8%89"><span class="toc-number">2.4.3.</span> <span class="toc-text">2.4.3 è¿æ¥æ–¹å¼ä¸‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-4-%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E5%9B%9B"><span class="toc-number">2.4.4.</span> <span class="toc-text">2.4.4 è¿æ¥æ–¹å¼å››</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-5-%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F%E4%BA%94-%E6%9C%80%E7%BB%88%E7%89%88"><span class="toc-number">2.4.5.</span> <span class="toc-text">2.4.5 è¿æ¥æ–¹å¼äº”(æœ€ç»ˆç‰ˆ)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC3%E7%AB%A0%EF%BC%9A%E4%BD%BF%E7%94%A8PreparedStatement%E5%AE%9E%E7%8E%B0CRUD%E6%93%8D%E4%BD%9C"><span class="toc-number">3.</span> <span class="toc-text">ç¬¬3ç« ï¼šä½¿ç”¨PreparedStatementå®ç°CRUDæ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%93%8D%E4%BD%9C%E5%92%8C%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 æ“ä½œå’Œè®¿é—®æ•°æ®åº“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E4%BD%BF%E7%94%A8Statement%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E8%A1%A8%E7%9A%84%E5%BC%8A%E7%AB%AF"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨çš„å¼Šç«¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-PreparedStatement%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 PreparedStatementçš„ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-1-PreparedStatement%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.3.1 PreparedStatementä»‹ç»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-2-PreparedStatement-vs-Statement"><span class="toc-number">3.3.2.</span> <span class="toc-text">3.3.2 PreparedStatement vs Statement</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-3-Java%E4%B8%8ESQL%E5%AF%B9%E5%BA%94%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E8%A1%A8"><span class="toc-number">3.3.3.</span> <span class="toc-text">3.3.3 Javaä¸SQLå¯¹åº”æ•°æ®ç±»å‹è½¬æ¢è¡¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-4-%E4%BD%BF%E7%94%A8PreparedStatement%E5%AE%9E%E7%8E%B0%E5%A2%9E%E3%80%81%E5%88%A0%E3%80%81%E6%94%B9%E6%93%8D%E4%BD%9C"><span class="toc-number">3.3.4.</span> <span class="toc-text">3.3.4 ä½¿ç”¨PreparedStatementå®ç°å¢ã€åˆ ã€æ”¹æ“ä½œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-5-%E4%BD%BF%E7%94%A8PreparedStatement%E5%AE%9E%E7%8E%B0%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C"><span class="toc-number">3.3.5.</span> <span class="toc-text">3.3.5 ä½¿ç”¨PreparedStatementå®ç°æŸ¥è¯¢æ“ä½œ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-ResultSet%E4%B8%8EResultSetMetaData"><span class="toc-number">3.4.</span> <span class="toc-text">3.4 ResultSetä¸ResultSetMetaData</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-1-ResultSet"><span class="toc-number">3.4.1.</span> <span class="toc-text">3.4.1 ResultSet</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-2-ResultSetMetaData"><span class="toc-number">3.4.2.</span> <span class="toc-text">3.4.2 ResultSetMetaData</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E8%B5%84%E6%BA%90%E7%9A%84%E9%87%8A%E6%94%BE"><span class="toc-number">3.5.</span> <span class="toc-text">3.5 èµ„æºçš„é‡Šæ”¾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-JDBC-API%E5%B0%8F%E7%BB%93"><span class="toc-number">3.6.</span> <span class="toc-text">3.6 JDBC APIå°ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AB%A0%E8%8A%82%E7%BB%83%E4%B9%A0"><span class="toc-number">4.</span> <span class="toc-text">ç« èŠ‚ç»ƒä¹ </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC4%E7%AB%A0-%E6%93%8D%E4%BD%9CBLOB%E7%B1%BB%E5%9E%8B%E5%AD%97%E6%AE%B5"><span class="toc-number">5.</span> <span class="toc-text">ç¬¬4ç«  æ“ä½œBLOBç±»å‹å­—æ®µ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-MySQL-BLOB%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.1.</span> <span class="toc-text">4.1 MySQL BLOBç±»å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E5%90%91%E6%95%B0%E6%8D%AE%E8%A1%A8%E4%B8%AD%E6%8F%92%E5%85%A5%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.2.</span> <span class="toc-text">4.2 å‘æ•°æ®è¡¨ä¸­æ’å…¥å¤§æ•°æ®ç±»å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E8%A1%A8%E4%B8%AD%E7%9A%84Blob%E7%B1%BB%E5%9E%8B%E5%AD%97%E6%AE%B5"><span class="toc-number">5.3.</span> <span class="toc-text">4.3 ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„Blobç±»å‹å­—æ®µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E4%BB%8E%E6%95%B0%E6%8D%AE%E8%A1%A8%E4%B8%AD%E8%AF%BB%E5%8F%96%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.4.</span> <span class="toc-text">4.4 ä»æ•°æ®è¡¨ä¸­è¯»å–å¤§æ•°æ®ç±»å‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC5%E7%AB%A0-%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5"><span class="toc-number">6.</span> <span class="toc-text">ç¬¬5ç«  æ‰¹é‡æ’å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E6%89%B9%E9%87%8F%E6%89%A7%E8%A1%8CSQL%E8%AF%AD%E5%8F%A5"><span class="toc-number">6.1.</span> <span class="toc-text">5.1 æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E9%AB%98%E6%95%88%E7%9A%84%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5"><span class="toc-number">6.2.</span> <span class="toc-text">5.2 é«˜æ•ˆçš„æ‰¹é‡æ’å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-1-%E5%AE%9E%E7%8E%B0%E5%B1%82%E6%AC%A1%E4%B8%80%EF%BC%9A%E4%BD%BF%E7%94%A8Statement"><span class="toc-number">6.2.1.</span> <span class="toc-text">5.2.1 å®ç°å±‚æ¬¡ä¸€ï¼šä½¿ç”¨Statement</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-2-%E5%AE%9E%E7%8E%B0%E5%B1%82%E6%AC%A1%E4%BA%8C%EF%BC%9A%E4%BD%BF%E7%94%A8PreparedStatement"><span class="toc-number">6.2.2.</span> <span class="toc-text">5.2.2 å®ç°å±‚æ¬¡äºŒï¼šä½¿ç”¨PreparedStatement</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-3-%E5%AE%9E%E7%8E%B0%E5%B1%82%E6%AC%A1%E4%B8%89"><span class="toc-number">6.2.3.</span> <span class="toc-text">5.2.3 å®ç°å±‚æ¬¡ä¸‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-4-%E5%AE%9E%E7%8E%B0%E5%B1%82%E6%AC%A1%E5%9B%9B"><span class="toc-number">6.2.4.</span> <span class="toc-text">5.2.4 å®ç°å±‚æ¬¡å››</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC6%E7%AB%A0%EF%BC%9A-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1"><span class="toc-number">7.</span> <span class="toc-text">ç¬¬6ç« ï¼š æ•°æ®åº“äº‹åŠ¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1%E4%BB%8B%E7%BB%8D"><span class="toc-number">7.1.</span> <span class="toc-text">6.1 æ•°æ®åº“äº‹åŠ¡ä»‹ç»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-JDBC%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86"><span class="toc-number">7.2.</span> <span class="toc-text">6.2 JDBCäº‹åŠ¡å¤„ç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E4%BA%8B%E5%8A%A1%E7%9A%84ACID%E5%B1%9E%E6%80%A7"><span class="toc-number">7.3.</span> <span class="toc-text">6.3 äº‹åŠ¡çš„ACIDå±æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%B9%B6%E5%8F%91%E9%97%AE%E9%A2%98"><span class="toc-number">7.3.1.</span> <span class="toc-text">6.3.1 æ•°æ®åº“çš„å¹¶å‘é—®é¢˜</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-2-%E5%9B%9B%E7%A7%8D%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-number">7.3.2.</span> <span class="toc-text">6.3.2 å››ç§éš”ç¦»çº§åˆ«</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-3-%E5%9C%A8MySql%E4%B8%AD%E8%AE%BE%E7%BD%AE%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-number">7.3.3.</span> <span class="toc-text">6.3.3 åœ¨MySqlä¸­è®¾ç½®éš”ç¦»çº§åˆ«</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC7%E7%AB%A0%EF%BC%9ADAO%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">8.</span> <span class="toc-text">ç¬¬7ç« ï¼šDAOåŠç›¸å…³å®ç°ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90BaseDAO-java%E3%80%91"><span class="toc-number">8.1.</span> <span class="toc-text">ã€BaseDAO.javaã€‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90BookDAO-java%E3%80%91"><span class="toc-number">8.2.</span> <span class="toc-text">ã€BookDAO.javaã€‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90UserDAO-java%E3%80%91"><span class="toc-number">8.3.</span> <span class="toc-text">ã€UserDAO.javaã€‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90BookDaoImpl-java%E3%80%91"><span class="toc-number">8.4.</span> <span class="toc-text">ã€BookDaoImpl.javaã€‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90UserDaoImpl-java%E3%80%91"><span class="toc-number">8.5.</span> <span class="toc-text">ã€UserDaoImpl.javaã€‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90Book-java%E3%80%91"><span class="toc-number">8.6.</span> <span class="toc-text">ã€Book.javaã€‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90Page-java%E3%80%91"><span class="toc-number">8.7.</span> <span class="toc-text">ã€Page.javaã€‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90User-java%E3%80%91"><span class="toc-number">8.8.</span> <span class="toc-text">ã€User.javaã€‘</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC8%E7%AB%A0%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">9.</span> <span class="toc-text">ç¬¬8ç« ï¼šæ•°æ®åº“è¿æ¥æ± </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-JDBC%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0%E7%9A%84%E5%BF%85%E8%A6%81%E6%80%A7"><span class="toc-number">9.1.</span> <span class="toc-text">8.1 JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0%E6%8A%80%E6%9C%AF"><span class="toc-number">9.2.</span> <span class="toc-text">8.2 æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-%E5%A4%9A%E7%A7%8D%E5%BC%80%E6%BA%90%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">9.3.</span> <span class="toc-text">8.3 å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± </span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-3-1-C3P0%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">9.3.1.</span> <span class="toc-text">8.3.1 C3P0æ•°æ®åº“è¿æ¥æ± </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-3-2-DBCP%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">9.3.2.</span> <span class="toc-text">8.3.2 DBCPæ•°æ®åº“è¿æ¥æ± </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-3-3-Druid%EF%BC%88%E5%BE%B7%E9%B2%81%E4%BC%8A%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">9.3.3.</span> <span class="toc-text">8.3.3 Druidï¼ˆå¾·é²ä¼Šï¼‰æ•°æ®åº“è¿æ¥æ± </span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC9%E7%AB%A0%EF%BC%9AApache-DBUtils%E5%AE%9E%E7%8E%B0CRUD%E6%93%8D%E4%BD%9C"><span class="toc-number">10.</span> <span class="toc-text">ç¬¬9ç« ï¼šApache-DBUtilså®ç°CRUDæ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-Apache-DBUtils%E7%AE%80%E4%BB%8B"><span class="toc-number">10.1.</span> <span class="toc-text">9.1 Apache-DBUtilsç®€ä»‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E4%B8%BB%E8%A6%81API%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">10.2.</span> <span class="toc-text">9.2 ä¸»è¦APIçš„ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-1-DbUtils"><span class="toc-number">10.2.1.</span> <span class="toc-text">9.2.1 DbUtils</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-2-QueryRunner%E7%B1%BB"><span class="toc-number">10.2.2.</span> <span class="toc-text">9.2.2 QueryRunnerç±»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-3-ResultSetHandler%E6%8E%A5%E5%8F%A3%E5%8F%8A%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">10.2.3.</span> <span class="toc-text">9.2.3 ResultSetHandleræ¥å£åŠå®ç°ç±»</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JDBC%E6%80%BB%E7%BB%93"><span class="toc-number">11.</span> <span class="toc-text">JDBCæ€»ç»“</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/11/15/yuque/springboot-zheng-he-redis/" title="SpringBoot-æ•´åˆRedis">SpringBoot-æ•´åˆRedis</a><time datetime="2021-11-15T11:11:53.000Z" title="å‘è¡¨äº 2021-11-15 19:11:53">2021-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/11/15/yuque/fen-bu-shi-xiao-xi-zhong-jian-jian-gai-shu/" title="åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶-æ¦‚è¿°">åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶-æ¦‚è¿°</a><time datetime="2021-11-15T10:58:22.000Z" title="å‘è¡¨äº 2021-11-15 18:58:22">2021-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/11/15/yuque/springboot-qian-hou-duan-fen-chi-kua-yu-pei-zhi/" title="SpringBoot-å‰åç«¯åˆ†ç¦»è·¨åŸŸé…ç½®">SpringBoot-å‰åç«¯åˆ†ç¦»è·¨åŸŸé…ç½®</a><time datetime="2021-11-15T06:57:12.000Z" title="å‘è¡¨äº 2021-11-15 14:57:12">2021-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/11/14/yuque/mybatis-jia-gou-yu-yuan-li/" title="MyBatis-æ¶æ„ä¸åŸç†">MyBatis-æ¶æ„ä¸åŸç†</a><time datetime="2021-11-14T04:59:00.000Z" title="å‘è¡¨äº 2021-11-14 12:59:00">2021-11-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/11/14/yuque/mybatis-huan-cun-gong-zuo-yuan-li/" title="Mybatis-ç¼“å­˜å·¥ä½œåŸç†">Mybatis-ç¼“å­˜å·¥ä½œåŸç†</a><time datetime="2021-11-14T04:58:08.000Z" title="å‘è¡¨äº 2021-11-14 12:58:08">2021-11-14</time></div></div></div></div><div class="card-widget ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8919908724705274" data-ad-slot="8108145410" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-1.png')"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By DongZhou</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="æ”¾å¤§å­—ä½“"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="ç¼©å°å­—ä½“"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç°¡</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="https://cdn.jsdelivr.net/npm/hexo-theme-butterfly@3.8.4/source/js/utils.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-butterfly@3.8.4/source/js/main.min.js"></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly.js.org/source/selfjs/tw_cn.min.js?ver=3.8.4"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly.js.org/source/selfjs/localsearch.min.js?ver=3.8.4"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      true && mermaid.init()
    })
  }
}</script><script>(()=>{
  const $countDom = document.getElementById('twikoo-count')
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://butterfly-twikoo.vercel.app/',
      region: ''
    }, null))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'https://butterfly-twikoo.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      $countDom.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const loadTwikoo = (bool = false) => {
    if (typeof twikoo === 'object') {
      init()
      bool && $countDom && setTimeout(getCount,0)
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.min.js').then(()=> {
        init()
        bool && $countDom && setTimeout(getCount,0)
      })
    }
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo(true)
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://dongzhougu.github.io/2020/10/08/jdbc-he-xin-ji-zhu/'
    this.page.identifier = '2020/10/08/jdbc-he-xin-ji-zhu/'
    this.page.title = 'JDBCæ ¸å¿ƒæŠ€æœ¯'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://demo-jerryc-me.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Twikoo' === 'Disqus' || !true) {
  if (true) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[å›¾ç‰‡]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[é“¾æ¥]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[ä»£ç ]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://butterfly-twikoo.vercel.app/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 5/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "æ— æ³•è·å–è¯„è®ºï¼Œè¯·ç¡®è®¤ç›¸å…³é…ç½®æ˜¯å¦æ­£ç¡®"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += 'æ²¡æœ‰è¯„è®º'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/talking/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.removeEventListener('scroll', window.tocScrollFn)
  window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var i=n.imageLazyLoadSetting.isSPA,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){i&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,e,a=0;a<r.length;a++)t=r[a],e=void 0,0<=(e=t.getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(n.innerHeight||document.documentElement.clientHeight)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},n.src=i}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body></html>