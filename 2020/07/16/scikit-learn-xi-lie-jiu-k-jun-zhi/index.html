<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>scikit-learnç³»åˆ—ä¹ï¼šK-å‡å€¼ | æ¬¢è¿æ¥åˆ°ï¼ŒTWOTO çš„åšå®¢</title><meta name="keywords" content="æœºå™¨å­¦ä¹ "><meta name="author" content="DongZhou"><meta name="copyright" content="DongZhou"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿ star å’Œ fork ï¼K-Meansèšç±»ç®—æ³•èšç±»ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†ä¸€ä¸ªåºæ‚æ•°æ®é›†ä¸­å…·æœ‰ç›¸ä¼¼ç‰¹å¾çš„æ•°æ®è‡ªåŠ¨å½’ç±»åˆ°ä¸€èµ·ï¼Œç§°ä¸ºä¸€ä¸ªç°‡ï¼Œç°‡å†…çš„å¯¹è±¡è¶Šç›¸ä¼¼ï¼Œèšç±»çš„æ•ˆæœè¶Šå¥½ã€‚å®ƒæ˜¯ä¸€ç§æ— ç›‘ç£çš„å­¦ä¹ (Unsupervised Learning)æ–¹æ³•,ä¸éœ€è¦é¢„å…ˆæ ‡æ³¨å¥½çš„è®­ç»ƒé›†ã€‚èšç±»ä¸åˆ†ç±»æœ€å¤§çš„åŒºåˆ«å°±æ˜¯åˆ†ç±»çš„ç›®æ ‡äº‹å…ˆå·²çŸ¥ï¼Œä¾‹å¦‚çŒ«ç‹—è¯†åˆ«ï¼Œä½ åœ¨åˆ†ç±»ä¹‹å‰å·²ç»é¢„å…ˆçŸ¥é“è¦å°†å®ƒåˆ†ä¸ºçŒ«ã€ç‹—ä¸¤ä¸ªç§ç±»ï¼›è€Œåœ¨ä½ ">
<meta property="og:type" content="article">
<meta property="og:title" content="scikit-learnç³»åˆ—ä¹ï¼šK-å‡å€¼">
<meta property="og:url" content="https://dongzhougu.github.io/2020/07/16/scikit-learn-xi-lie-jiu-k-jun-zhi/index.html">
<meta property="og:site_name" content="æ¬¢è¿æ¥åˆ°ï¼ŒTWOTO çš„åšå®¢">
<meta property="og:description" content="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿ star å’Œ fork ï¼K-Meansèšç±»ç®—æ³•èšç±»ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†ä¸€ä¸ªåºæ‚æ•°æ®é›†ä¸­å…·æœ‰ç›¸ä¼¼ç‰¹å¾çš„æ•°æ®è‡ªåŠ¨å½’ç±»åˆ°ä¸€èµ·ï¼Œç§°ä¸ºä¸€ä¸ªç°‡ï¼Œç°‡å†…çš„å¯¹è±¡è¶Šç›¸ä¼¼ï¼Œèšç±»çš„æ•ˆæœè¶Šå¥½ã€‚å®ƒæ˜¯ä¸€ç§æ— ç›‘ç£çš„å­¦ä¹ (Unsupervised Learning)æ–¹æ³•,ä¸éœ€è¦é¢„å…ˆæ ‡æ³¨å¥½çš„è®­ç»ƒé›†ã€‚èšç±»ä¸åˆ†ç±»æœ€å¤§çš„åŒºåˆ«å°±æ˜¯åˆ†ç±»çš„ç›®æ ‡äº‹å…ˆå·²çŸ¥ï¼Œä¾‹å¦‚çŒ«ç‹—è¯†åˆ«ï¼Œä½ åœ¨åˆ†ç±»ä¹‹å‰å·²ç»é¢„å…ˆçŸ¥é“è¦å°†å®ƒåˆ†ä¸ºçŒ«ã€ç‹—ä¸¤ä¸ªç§ç±»ï¼›è€Œåœ¨ä½ ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-10.png">
<meta property="article:published_time" content="2020-07-16T07:57:44.000Z">
<meta property="article:modified_time" content="2021-11-07T15:49:32.238Z">
<meta property="article:author" content="DongZhou">
<meta property="article:tag" content="æœºå™¨å­¦ä¹ ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-10.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://dongzhougu.github.io/2020/07/16/scikit-learn-xi-lie-jiu-k-jun-zhi/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="NdIUXAOVyGnnBhcrip0ksCawbdAzT0hlBZDE9u4jx6k"/><meta name="msvalidate.01" content="567E47D75E8DCF1282B9623AD914701E"/><meta name="baidu-site-verification" content="code-pE5rnuxcfD"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  noticeOutdate: undefined,
  highlight: undefined,
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":150,"languages":{"author":"ä½œè€…: DongZhou","link":"é“¾æ¥: ","source":"æ¥æº: æ¬¢è¿æ¥åˆ°ï¼ŒTWOTO çš„åšå®¢","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'scikit-learnç³»åˆ—ä¹ï¼šK-å‡å€¼',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-11-07 23:49:32'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    document.addEventListener('pjax:complete', detectApple)})(window)</script><style type="text/css">.card-announcement .social-button{margin: .6rem 0 0 0; text-align: center;}.card-announcement .social-button a{display: block; margin: 0.2rem 0;background-color: var(--btn-bg); color: var(--btn-color); line-height: 1.6rem; transition: all .3s; position: relative; z-index: 1;}</style><style type="text/css" lang="css">
    #loading-container{
        position: fixed;
        top: 0;
        left: 0;
        min-height: 100vh;
        width: 100vw;
        z-index: 9999;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: #FFF;
        text-align: center;
        /* loaderé¡µé¢æ¶ˆå¤±é‡‡ç”¨æ¸éšçš„æ–¹å¼*/
        -webkit-transition: opacity 1s ease;
        -moz-transition: opacity 1s ease;
        -o-transition: opacity 1s ease;
        transition: opacity 1s ease;
    }
    .loading-image{
        width: 120px;
        height: 50px;
        transform: translate(-50%);
    }
    
    .loading-image div:nth-child(2) {
        -webkit-animation: pacman-balls 1s linear 0s infinite;
        animation: pacman-balls 1s linear 0s infinite
    }

    .loading-image div:nth-child(3) {
        -webkit-animation: pacman-balls 1s linear .33s infinite;
        animation: pacman-balls 1s linear .33s infinite
    }

    .loading-image div:nth-child(4) {
        -webkit-animation: pacman-balls 1s linear .66s infinite;
        animation: pacman-balls 1s linear .66s infinite
    }

    .loading-image div:nth-child(5) {
        -webkit-animation: pacman-balls 1s linear .99s infinite;
        animation: pacman-balls 1s linear .99s infinite
    }
    
   .loading-image div:first-of-type {
        width: 0;
        height: 0;
        border: 25px solid #49b1f5;
        border-right-color: transparent;
        border-radius: 25px;
        -webkit-animation: rotate_pacman_half_up .5s 0s infinite;
        animation: rotate_pacman_half_up .5s 0s infinite;
    }
    .loading-image div:nth-child(2) {
        width: 0;
        height: 0;
        border: 25px solid #49b1f5;
        border-right-color: transparent;
        border-radius: 25px;
        -webkit-animation: rotate_pacman_half_down .5s 0s infinite;
        animation: rotate_pacman_half_down .5s 0s infinite;
        margin-top: -50px;
    }
    @-webkit-keyframes rotate_pacman_half_up {0% {transform: rotate(270deg)}50% {transform: rotate(1turn)}to {transform: rotate(270deg)}}

    @keyframes rotate_pacman_half_up {0% {transform: rotate(270deg)}50% {transform: rotate(1turn)}to {transform: rotate(270deg)}}

    @-webkit-keyframes rotate_pacman_half_down {0% {transform: rotate(90deg)}50% {transform: rotate(0deg)}to {transform: rotate(90deg)}}

    @keyframes rotate_pacman_half_down {0% {transform: rotate(90deg)}50% {transform: rotate(0deg)}to {transform: rotate(90deg)}}
    
    @-webkit-keyframes pacman-balls {75% {opacity: .7}to {transform: translate(-100px, -6.25px)}}

    @keyframes pacman-balls {75% {opacity: .7}to {transform: translate(-100px, -6.25px)}}
    
   
    .loading-image div:nth-child(3),
    .loading-image div:nth-child(4),
    .loading-image div:nth-child(5),
    .loading-image div:nth-child(6){
        background-color: #49b1f5;
        width: 15px;
        height: 15px;
        border-radius: 100%;
        margin: 2px;
        width: 10px;
        height: 10px;
        position: absolute;
        transform: translateY(-6.25px);
        top: 25px;
        left: 100px;
    }
    .loading-text{
        margin-bottom: 20vh;
        text-align: center;
        color: #2c3e50;
        font-size: 2rem;
        box-sizing: border-box;
        padding: 0 10px;
        text-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    @media only screen and (max-width: 500px) {
         .loading-text{
            font-size: 1.5rem;
         }
    }
    .fadeout {
        opacity: 0;
        filter: alpha(opacity=0);
    }
    /* logoå‡ºç°åŠ¨ç”» */
    @-webkit-keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}100%{opacity:1;-webkit-transform:none;transform:none}}
    @keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);}}
 </style>
 <script>
(function () {
    const loaded = function(){
       setTimeout(function(){
            const loader = document.getElementById("loading-container");
            loader.className="fadeout" ;//ä½¿ç”¨æ¸éšçš„æ–¹æ³•æ·¡å‡ºloading page
            // document.getElementById("body-wrap").style.display="flex";
            setTimeout(function(){
                loader.style.display="none";
            },1000); 
        },1000);//å¼ºåˆ¶æ˜¾ç¤ºloading page 1s  
    };
    loaded();
})()
 </script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="æ¬¢è¿æ¥åˆ°ï¼ŒTWOTO çš„åšå®¢" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>
 <div id="loading-container">
     <p class="loading-text">ç©å‘½åŠ è½½ä¸­ . . . </p> 
     <div class="loading-image">
         <div></div>
         <div></div>
         <div></div>
         <div></div> 
         <div></div>
     </div>
 </div><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">50</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">29</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">10</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é </span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> ç›®éŒ„</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ­¸æª”</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ¨™ç±¤</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†é¡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> æ–‡æª”</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/posts/21cfbf15/"><span> ğŸš€ å¿«é€Ÿé–‹å§‹</span></a></li><li><a class="site-page child" href="/posts/dc584b87/"><span> ğŸ“‘ ä¸»é¡Œé é¢</span></a></li><li><a class="site-page child" href="/posts/4aa8abbe/"><span> ğŸ›  ä¸»é¡Œé…ç½®-1</span></a></li><li><a class="site-page child" href="/posts/ceeb73f/"><span> âš”ï¸ ä¸»é¡Œé…ç½®-2</span></a></li><li><a class="site-page child" href="/posts/98d20436/"><span> â“ ä¸»é¡Œå•ç­”</span></a></li><li><a class="site-page child" href="/posts/4073eda/"><span> âš¡ï¸ é€²éšæ•™ç¨‹</span></a></li><li><a class="site-page child" href="/posts/198a4240/"><span> âœ¨ æ›´æ–°æ—¥èªŒ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> å¨›æ¨‚</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> åœ–åº«</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> é›»å½±</span></a></li><li><a class="site-page child" href="/talking/"><i class="fa-fw fas fa-cubes"></i><span> è‡ªè¨€è‡ªèª</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> ç¤ºä¾‹</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-10.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">æ¬¢è¿æ¥åˆ°ï¼ŒTWOTO çš„åšå®¢</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é </span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> ç›®éŒ„</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ­¸æª”</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ¨™ç±¤</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†é¡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> æ–‡æª”</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/posts/21cfbf15/"><span> ğŸš€ å¿«é€Ÿé–‹å§‹</span></a></li><li><a class="site-page child" href="/posts/dc584b87/"><span> ğŸ“‘ ä¸»é¡Œé é¢</span></a></li><li><a class="site-page child" href="/posts/4aa8abbe/"><span> ğŸ›  ä¸»é¡Œé…ç½®-1</span></a></li><li><a class="site-page child" href="/posts/ceeb73f/"><span> âš”ï¸ ä¸»é¡Œé…ç½®-2</span></a></li><li><a class="site-page child" href="/posts/98d20436/"><span> â“ ä¸»é¡Œå•ç­”</span></a></li><li><a class="site-page child" href="/posts/4073eda/"><span> âš¡ï¸ é€²éšæ•™ç¨‹</span></a></li><li><a class="site-page child" href="/posts/198a4240/"><span> âœ¨ æ›´æ–°æ—¥èªŒ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> å¨›æ¨‚</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> åœ–åº«</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> é›»å½±</span></a></li><li><a class="site-page child" href="/talking/"><i class="fa-fw fas fa-cubes"></i><span> è‡ªè¨€è‡ªèª</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> ç¤ºä¾‹</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">scikit-learnç³»åˆ—ä¹ï¼šK-å‡å€¼<a class="post-edit-link" href="https://github.com/jerryc127/butterfly.js.org/edit/main/source/_posts/scikit-learnç³»åˆ—ä¹ï¼šK-å‡å€¼.md" title="ç¼–è¾‘" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">å‘è¡¨äº</span><time datetime="2020-07-16T07:57:44.000Z" title="undefined 2020-07-16 15:57:44">2020-07-16</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python/">Python</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">5.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>18åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="scikit-learnç³»åˆ—ä¹ï¼šK-å‡å€¼"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼"><a href="#é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼" class="headerlink" title="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿ star å’Œ fork ï¼"></a>é¡¹ç›®åœ°å€<a target="_blank" rel="noopener" href="https://github.com/DongZhouGu/scikit-learn-ml">ä¼ é€é—¨</a>ï¼Œæ¬¢è¿ star å’Œ fork ï¼</h2><h2 id="K-Meansèšç±»ç®—æ³•"><a href="#K-Meansèšç±»ç®—æ³•" class="headerlink" title="K-Meansèšç±»ç®—æ³•"></a>K-Meansèšç±»ç®—æ³•</h2><p>èšç±»ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†ä¸€ä¸ªåºæ‚æ•°æ®é›†ä¸­å…·æœ‰ç›¸ä¼¼ç‰¹å¾çš„æ•°æ®è‡ªåŠ¨å½’ç±»åˆ°ä¸€èµ·ï¼Œç§°ä¸ºä¸€ä¸ªç°‡ï¼Œç°‡å†…çš„å¯¹è±¡è¶Šç›¸ä¼¼ï¼Œèšç±»çš„æ•ˆæœè¶Šå¥½ã€‚å®ƒæ˜¯ä¸€ç§æ— ç›‘ç£çš„å­¦ä¹ (Unsupervised Learning)æ–¹æ³•,ä¸éœ€è¦é¢„å…ˆæ ‡æ³¨å¥½çš„è®­ç»ƒé›†ã€‚èšç±»ä¸åˆ†ç±»æœ€å¤§çš„åŒºåˆ«å°±æ˜¯åˆ†ç±»çš„ç›®æ ‡äº‹å…ˆå·²çŸ¥ï¼Œä¾‹å¦‚çŒ«ç‹—è¯†åˆ«ï¼Œä½ åœ¨åˆ†ç±»ä¹‹å‰å·²ç»é¢„å…ˆçŸ¥é“è¦å°†å®ƒåˆ†ä¸ºçŒ«ã€ç‹—ä¸¤ä¸ªç§ç±»ï¼›è€Œåœ¨ä½ èšç±»ä¹‹å‰ï¼Œä½ å¯¹ä½ çš„ç›®æ ‡æ˜¯æœªçŸ¥çš„ï¼ŒåŒæ ·ä»¥åŠ¨ç‰©ä¸ºä¾‹ï¼Œå¯¹äºä¸€ä¸ªåŠ¨ç‰©é›†æ¥è¯´ï¼Œä½ å¹¶ä¸æ¸…æ¥šè¿™ä¸ªæ•°æ®é›†å†…éƒ¨æœ‰å¤šå°‘ç§ç±»çš„åŠ¨ç‰©ï¼Œä½ èƒ½åšçš„åªæ˜¯åˆ©ç”¨èšç±»æ–¹æ³•å°†å®ƒè‡ªåŠ¨æŒ‰ç…§ç‰¹å¾åˆ†ä¸ºå¤šç±»ï¼Œç„¶åäººä¸ºç»™å‡ºè¿™ä¸ªèšç±»ç»“æœçš„å®šä¹‰ï¼ˆå³ç°‡è¯†åˆ«ï¼‰ã€‚ä¾‹å¦‚ï¼Œä½ å°†ä¸€ä¸ªåŠ¨ç‰©é›†åˆ†ä¸ºäº†ä¸‰ç°‡ï¼ˆç±»ï¼‰ï¼Œç„¶åé€šè¿‡è§‚å¯Ÿè¿™ä¸‰ç±»åŠ¨ç‰©çš„ç‰¹å¾ï¼Œä½ ä¸ºæ¯ä¸€ä¸ªç°‡èµ·ä¸€ä¸ªåå­—ï¼Œå¦‚å¤§è±¡ã€ç‹—ã€çŒ«ç­‰ï¼Œè¿™å°±æ˜¯èšç±»çš„åŸºæœ¬æ€æƒ³ã€‚     </p>
<p>è‡³äºâ€œç›¸ä¼¼â€è¿™ä¸€æ¦‚å¿µï¼Œæ˜¯åˆ©ç”¨è·ç¦»è¿™ä¸ªè¯„ä»·æ ‡å‡†æ¥è¡¡é‡çš„ï¼Œæˆ‘ä»¬é€šè¿‡è®¡ç®—å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„è·ç¦»è¿œè¿‘æ¥åˆ¤æ–­å®ƒä»¬æ˜¯å¦å±äºåŒä¸€ç±»åˆ«ï¼Œå³æ˜¯å¦æ˜¯åŒä¸€ä¸ªç°‡ã€‚è‡³äºè·ç¦»å¦‚ä½•è®¡ç®—ï¼Œç§‘å­¦å®¶ä»¬æå‡ºäº†è®¸å¤šç§è·ç¦»çš„è®¡ç®—æ–¹æ³•ï¼Œå…¶ä¸­æ¬§å¼è·ç¦»æ˜¯æœ€ä¸ºç®€å•å’Œå¸¸ç”¨çš„ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰æ›¼å“ˆé¡¿è·ç¦»å’Œä½™å¼¦ç›¸ä¼¼æ€§è·ç¦»ç­‰ã€‚</p>
<p>æ¬§å¼è·ç¦»ï¼Œæˆ‘æƒ³å¤§å®¶å†ç†Ÿæ‚‰ä¸è¿‡äº†ï¼Œä½†ä¸ºå…æœ‰ä¸€äº›åŸºç¡€è–„å¼±çš„åŒå­¦ï¼Œåœ¨æ­¤å†è¯´æ˜ä¸€ä¸‹ï¼Œå®ƒçš„å®šä¹‰ä¸º:<br>å¯¹äºxç‚¹åæ ‡ä¸º(x1,x2,x3,â€¦,xn)å’Œ yç‚¹åæ ‡ä¸º(y1,y2,y3,â€¦,yn)ï¼Œä¸¤è€…çš„æ¬§å¼è·ç¦»ä¸º:<br>$$<br>d(x,y)<br>    ={\sqrt{<br>            (x_{1}-y_{1})^{2}+(x_{2}-y_{2})^{2} + \cdots +(x_{n}-y_{n})^{2}<br>        }}<br>    ={\sqrt{<br>            \sum_{ {i=1} }^{n}(x_{i}-y_{i})^{2}<br>        }}<br>$$</p>
<p>åœ¨äºŒç»´å¹³é¢ï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬åˆä¸­æ—¶å°±å­¦è¿‡çš„ä¸¤ç‚¹è·ç¦»å…¬å¼</p>
<h2 id="1-K-Means-ç®—æ³•"><a href="#1-K-Means-ç®—æ³•" class="headerlink" title="1. K-Means ç®—æ³•"></a>1. K-Means ç®—æ³•</h2><p>K-Means æ˜¯å‘ç°ç»™å®šæ•°æ®é›†çš„ K ä¸ªç°‡çš„èšç±»ç®—æ³•, ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸º <code>K-å‡å€¼</code> æ˜¯å› ä¸ºå®ƒå¯ä»¥å‘ç° K ä¸ªä¸åŒçš„ç°‡, ä¸”æ¯ä¸ªç°‡çš„ä¸­å¿ƒé‡‡ç”¨ç°‡ä¸­æ‰€å«å€¼çš„å‡å€¼è®¡ç®—è€Œæˆ.<br>ç°‡ä¸ªæ•° K æ˜¯ç”¨æˆ·æŒ‡å®šçš„, æ¯ä¸€ä¸ªç°‡é€šè¿‡å…¶è´¨å¿ƒï¼ˆcentroidï¼‰, å³ç°‡ä¸­æ‰€æœ‰ç‚¹çš„ä¸­å¿ƒæ¥æè¿°.<br>èšç±»ä¸åˆ†ç±»ç®—æ³•çš„æœ€å¤§åŒºåˆ«åœ¨äº, åˆ†ç±»çš„ç›®æ ‡ç±»åˆ«å·²çŸ¥, è€Œèšç±»çš„ç›®æ ‡ç±»åˆ«æ˜¯æœªçŸ¥çš„. </p>
<p><strong>ä¼˜ç‚¹</strong>:</p>
<ul>
<li>å±äºæ— ç›‘ç£å­¦ä¹ ï¼Œæ— é¡»å‡†å¤‡è®­ç»ƒé›†</li>
<li>åŸç†ç®€å•ï¼Œå®ç°èµ·æ¥è¾ƒä¸ºå®¹æ˜“</li>
<li>ç»“æœå¯è§£é‡Šæ€§è¾ƒå¥½</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>:</p>
<ul>
<li><strong>éœ€æ‰‹åŠ¨è®¾ç½®kå€¼</strong>ã€‚ åœ¨ç®—æ³•å¼€å§‹é¢„æµ‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨è®¾ç½®kå€¼ï¼Œå³ä¼°è®¡æ•°æ®å¤§æ¦‚çš„ç±»åˆ«ä¸ªæ•°ï¼Œä¸åˆç†çš„kå€¼ä¼šä½¿ç»“æœç¼ºä¹è§£é‡Šæ€§</li>
<li>å¯èƒ½æ”¶æ•›åˆ°å±€éƒ¨æœ€å°å€¼, åœ¨å¤§è§„æ¨¡æ•°æ®é›†ä¸Šæ”¶æ•›è¾ƒæ…¢</li>
<li>å¯¹äºå¼‚å¸¸ç‚¹ã€ç¦»ç¾¤ç‚¹æ•æ„Ÿ</li>
</ul>
<p>ä½¿ç”¨æ•°æ®ç±»å‹ : æ•°å€¼å‹æ•°æ®</p>
<h3 id="1-1-K-Means-åœºæ™¯"><a href="#1-1-K-Means-åœºæ™¯" class="headerlink" title="1.1 K-Means åœºæ™¯"></a>1.1 K-Means åœºæ™¯</h3><p>kmeansï¼Œå¦‚å‰æ‰€è¿°ï¼Œç”¨äºæ•°æ®é›†å†…ç§ç±»å±æ€§ä¸æ˜æ™°ï¼Œå¸Œæœ›èƒ½å¤Ÿé€šè¿‡æ•°æ®æŒ–æ˜å‡ºæˆ–è‡ªåŠ¨å½’ç±»å‡ºæœ‰ç›¸ä¼¼ç‰¹ç‚¹çš„å¯¹è±¡çš„åœºæ™¯ã€‚å…¶å•†ä¸šç•Œçš„åº”ç”¨åœºæ™¯ä¸€èˆ¬ä¸ºæŒ–æ˜å‡ºå…·æœ‰ç›¸ä¼¼ç‰¹ç‚¹çš„æ½œåœ¨å®¢æˆ·ç¾¤ä½“ä»¥ä¾¿å…¬å¸èƒ½å¤Ÿé‡ç‚¹ç ”ç©¶ã€å¯¹ç—‡ä¸‹è¯ã€‚  </p>
<p>ä¾‹å¦‚ï¼Œåœ¨2000å¹´å’Œ2004å¹´çš„ç¾å›½æ€»ç»Ÿå¤§é€‰ä¸­ï¼Œå€™é€‰äººçš„å¾—ç¥¨æ•°æ¯”è¾ƒæ¥è¿‘æˆ–è€…è¯´éå¸¸æ¥è¿‘ã€‚ä»»ä¸€å€™é€‰äººå¾—åˆ°çš„æ™®é€‰ç¥¨æ•°çš„æœ€å¤§ç™¾åˆ†æ¯”ä¸º50.7%è€Œæœ€å°ç™¾åˆ†æ¯”ä¸º47.9% å¦‚æœ1%çš„é€‰æ°‘å°†æ‰‹ä¸­çš„é€‰ç¥¨æŠ•å‘å¦å¤–çš„å€™é€‰äººï¼Œé‚£ä¹ˆé€‰ä¸¾ç»“æœå°±ä¼šæˆªç„¶ä¸åŒã€‚ å®é™…ä¸Šï¼Œå¦‚æœå¦¥å–„åŠ ä»¥å¼•å¯¼ä¸å¸å¼•ï¼Œå°‘éƒ¨åˆ†é€‰æ°‘å°±ä¼šè½¬æ¢ç«‹åœºã€‚å°½ç®¡è¿™ç±»é€‰ä¸¾è€…å çš„æ¯”ä¾‹è¾ƒä½ï¼Œä½†å½“å€™é€‰äººçš„é€‰ç¥¨æ¥è¿‘æ—¶ï¼Œè¿™äº›äººçš„ç«‹åœºæ— ç–‘ä¼šå¯¹é€‰ä¸¾ç»“æœäº§ç”Ÿéå¸¸å¤§çš„å½±å“ã€‚å¦‚ä½•æ‰¾å‡ºè¿™ç±»é€‰æ°‘ï¼Œä»¥åŠå¦‚ä½•åœ¨æœ‰é™çš„é¢„ç®—ä¸‹é‡‡å–æªæ–½æ¥å¸å¼•ä»–ä»¬ï¼Ÿ ç­”æ¡ˆå°±æ˜¯èšç±»ï¼ˆClustering)ã€‚</p>
<p>é‚£ä¹ˆï¼Œå…·ä½“å¦‚ä½•å®æ–½å‘¢ï¼Ÿé¦–å…ˆï¼Œæ”¶é›†ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå¯ä»¥åŒæ—¶æ”¶é›†ç”¨æˆ·æ»¡æ„æˆ–ä¸æ»¡æ„çš„ä¿¡æ¯ï¼Œè¿™æ˜¯å› ä¸ºä»»ä½•å¯¹ç”¨æˆ·é‡è¦çš„å†…å®¹éƒ½å¯èƒ½å½±å“ç”¨æˆ·çš„æŠ•ç¥¨ç»“æœã€‚ç„¶åï¼Œå°†è¿™äº›ä¿¡æ¯è¾“å…¥åˆ°æŸä¸ªèšç±»ç®—æ³•ä¸­ã€‚æ¥ç€ï¼Œå¯¹èšç±»ç»“æœä¸­çš„æ¯ä¸€ä¸ªç°‡ï¼ˆæœ€å¥½é€‰æ‹©æœ€å¤§ç°‡ ï¼‰ï¼Œ ç²¾å¿ƒæ„é€ èƒ½å¤Ÿå¸å¼•è¯¥ç°‡é€‰æ°‘çš„æ¶ˆæ¯ã€‚æœ€åï¼Œ å¼€å±•ç«é€‰æ´»åŠ¨å¹¶è§‚å¯Ÿä¸Šè¿°åšæ³•æ˜¯å¦æœ‰æ•ˆã€‚</p>
<p>å¦ä¸€ä¸ªä¾‹å­å°±æ˜¯äº§å“éƒ¨é—¨çš„å¸‚åœºè°ƒç ”äº†ã€‚ä¸ºäº†æ›´å¥½çš„äº†è§£è‡ªå·±çš„ç”¨æˆ·ï¼Œäº§å“éƒ¨é—¨å¯ä»¥é‡‡ç”¨èšç±»çš„æ–¹æ³•å¾—åˆ°ä¸åŒç‰¹å¾çš„ç”¨æˆ·ç¾¤ä½“ï¼Œç„¶åé’ˆå¯¹ä¸åŒçš„ç”¨æˆ·ç¾¤ä½“å¯ä»¥å¯¹ç—‡ä¸‹è¯ï¼Œä¸ºä»–ä»¬æä¾›æ›´åŠ ç²¾å‡†æœ‰æ•ˆçš„æœåŠ¡ã€‚</p>
<h3 id="1-2-K-Means-æœ¯è¯­"><a href="#1-2-K-Means-æœ¯è¯­" class="headerlink" title="1.2 K-Means æœ¯è¯­"></a>1.2 K-Means æœ¯è¯­</h3><ul>
<li>ç°‡: æ‰€æœ‰æ•°æ®çš„ç‚¹é›†åˆï¼Œç°‡ä¸­çš„å¯¹è±¡æ˜¯ç›¸ä¼¼çš„ã€‚</li>
<li>è´¨å¿ƒ: ç°‡ä¸­æ‰€æœ‰ç‚¹çš„ä¸­å¿ƒï¼ˆè®¡ç®—æ‰€æœ‰ç‚¹çš„å‡å€¼è€Œæ¥ï¼‰.</li>
<li>SSE: Sum of Sqared Errorï¼ˆè¯¯å·®å¹³æ–¹å’Œï¼‰, å®ƒè¢«ç”¨æ¥è¯„ä¼°æ¨¡å‹çš„å¥½åï¼ŒSSE å€¼è¶Šå°ï¼Œè¡¨ç¤ºè¶Šæ¥è¿‘å®ƒä»¬çš„è´¨å¿ƒ. èšç±»æ•ˆæœè¶Šå¥½ã€‚ç”±äºå¯¹è¯¯å·®å–äº†å¹³æ–¹ï¼Œå› æ­¤æ›´åŠ æ³¨é‡é‚£äº›è¿œç¦»ä¸­å¿ƒçš„ç‚¹ï¼ˆä¸€èˆ¬ä¸ºè¾¹ç•Œç‚¹æˆ–ç¦»ç¾¤ç‚¹ï¼‰ã€‚è¯¦æƒ…è§kmeansçš„è¯„ä»·æ ‡å‡†ã€‚</li>
</ul>
<p>æœ‰å…³ <code>ç°‡</code> å’Œ <code>è´¨å¿ƒ</code> æœ¯è¯­æ›´å½¢è±¡çš„ä»‹ç», è¯·å‚è€ƒä¸‹å›¾:</p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/apachecn-k-means-term-1.jpg" alt="K-Means æœ¯è¯­å›¾"></p>
<h3 id="1-3-K-Means-å·¥ä½œæµç¨‹"><a href="#1-3-K-Means-å·¥ä½œæµç¨‹" class="headerlink" title="1.3 K-Means å·¥ä½œæµç¨‹"></a>1.3 K-Means å·¥ä½œæµç¨‹</h3><ol>
<li>é¦–å…ˆ, éšæœºç¡®å®š K ä¸ªåˆå§‹ç‚¹ä½œä¸ºè´¨å¿ƒï¼ˆ<strong>ä¸å¿…æ˜¯æ•°æ®ä¸­çš„ç‚¹</strong>ï¼‰ã€‚</li>
<li>ç„¶åå°†æ•°æ®é›†ä¸­çš„æ¯ä¸ªç‚¹åˆ†é…åˆ°ä¸€ä¸ªç°‡ä¸­, å…·ä½“æ¥è®², å°±æ˜¯ä¸ºæ¯ä¸ªç‚¹æ‰¾åˆ°è·å…¶æœ€è¿‘çš„è´¨å¿ƒ, å¹¶å°†å…¶åˆ†é…è¯¥è´¨å¿ƒæ‰€å¯¹åº”çš„ç°‡. è¿™ä¸€æ­¥å®Œæˆä¹‹å, æ¯ä¸ªç°‡çš„è´¨å¿ƒæ›´æ–°ä¸ºè¯¥ç°‡æ‰€æœ‰ç‚¹çš„å¹³å‡å€¼.<br>3.é‡å¤ä¸Šè¿°è¿‡ç¨‹ç›´åˆ°æ•°æ®é›†ä¸­çš„æ‰€æœ‰ç‚¹éƒ½è·ç¦»å®ƒæ‰€å¯¹åº”çš„è´¨å¿ƒæœ€è¿‘æ—¶ç»“æŸã€‚</li>
</ol>
<p>ä¸Šè¿°è¿‡ç¨‹çš„ <code>ä¼ªä»£ç </code> å¦‚ä¸‹:</p>
<ul>
<li>åˆ›å»º k ä¸ªç‚¹ä½œä¸ºèµ·å§‹è´¨å¿ƒï¼ˆé€šå¸¸æ˜¯éšæœºé€‰æ‹©ï¼‰</li>
<li>å½“ä»»æ„ä¸€ä¸ªç‚¹çš„ç°‡åˆ†é…ç»“æœå‘ç”Ÿæ”¹å˜æ—¶ï¼ˆä¸æ”¹å˜æ—¶ç®—æ³•ç»“æŸï¼‰<ul>
<li>å¯¹æ•°æ®é›†ä¸­çš„æ¯ä¸ªæ•°æ®ç‚¹<ul>
<li>å¯¹æ¯ä¸ªè´¨å¿ƒ<ul>
<li>è®¡ç®—è´¨å¿ƒä¸æ•°æ®ç‚¹ä¹‹é—´çš„è·ç¦»</li>
</ul>
</li>
<li>å°†æ•°æ®ç‚¹åˆ†é…åˆ°è·å…¶æœ€è¿‘çš„ç°‡</li>
</ul>
</li>
<li>å¯¹æ¯ä¸€ä¸ªç°‡, è®¡ç®—ç°‡ä¸­æ‰€æœ‰ç‚¹çš„å‡å€¼å¹¶å°†å‡å€¼ä½œä¸ºè´¨å¿ƒ</li>
</ul>
</li>
</ul>
<h2 id="2-sklearn-é‡Œçš„K-å‡å€¼ç®—æ³•"><a href="#2-sklearn-é‡Œçš„K-å‡å€¼ç®—æ³•" class="headerlink" title="2. sklearn é‡Œçš„K-å‡å€¼ç®—æ³•"></a>2. sklearn é‡Œçš„K-å‡å€¼ç®—æ³•</h2><p>cikit-learné‡Œçš„K-å‡å€¼ç®—æ³•ç”±sklearn.cluster.KMeansç±»å®ç°ã€‚ä¸‹é¢é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ¥å­¦ä¹ æ€æ ·åœ¨scikit-learné‡Œä½¿ç”¨K-å‡å€¼ç®—æ³•ã€‚</p>
<p>æˆ‘ä»¬ç”Ÿæˆä¸€ç»„åŒ…å«ä¸¤ä¸ªç‰¹å¾çš„200ä¸ªæ ·æœ¬ï¼š</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_blobs
X<span class="token punctuation">,</span>y <span class="token operator">=</span> make_blobs<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>
                n_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
                centers<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>
                cluster_std<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
                center_box<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span><span class="token number">10.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç„¶åæŠŠæ ·æœ¬ç”»åœ¨äºŒç»´åæ ‡ç³»ä¸Šï¼Œä»¥ä¾¿ç›´è§‚åœ°è§‚å¯Ÿï¼š</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>s<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç»“æœå¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200716173322275.png" alt="image-20200716173322275"></p>
<p>æ¥ç€ä½¿ç”¨ <code>KMeans</code> æ¨¡å‹æ¥æ‹Ÿåˆã€‚æˆ‘ä»¬è®¾ç½®ç±»åˆ«ä¸ªæ•°ä¸º3ï¼Œå¹¶è®¡ç®—å‡ºå…¶æ‹Ÿåˆåçš„æˆæœ¬ã€‚</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans
n_clusters <span class="token operator">=</span> <span class="token number">3</span>
kmeans <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span>n_clusters<span class="token punctuation">)</span>
kmeans<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"kmeans: k = {}, cost = {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>n_clusters<span class="token punctuation">,</span>int<span class="token punctuation">(</span>kmeans<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-python"><code class="language-python">kmeans<span class="token punctuation">:</span> k <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> cost <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">668</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>KMeans.score()</code> å‡½æ•°è®¡ç®—K-å‡å€¼ç®—æ³•æ‹Ÿåˆåçš„æˆæœ¬ï¼Œç”¨è´Ÿæ•°è¡¨ç¤ºï¼Œå…¶ç»å¯¹å€¼è¶Šå¤§ï¼Œè¯´æ˜æˆæœ¬è¶Šé«˜ã€‚å‰é¢ä»‹ç»è¿‡ï¼ŒK-å‡å€¼ç®—æ³•æˆæœ¬çš„ç‰©ç†æ„ä¹‰ä¸ºè®­ç»ƒæ ·æœ¬åˆ°å…¶æ‰€å±çš„èšç±»ä¸­å¿ƒçš„è·ç¦»å¹³å‡å€¼ï¼Œåœ¨ <code>scikit-learn</code> é‡Œï¼Œå…¶è®¡ç®—æˆæœ¬çš„æ–¹æ³•ç•¥æœ‰ä¸åŒï¼Œå®ƒæ˜¯è®¡ç®—è®­ç»ƒæ ·æœ¬åˆ°å…¶æ‰€å±çš„èšç±»ä¸­å¿ƒçš„è·ç¦»çš„æ€»å’Œã€‚</p>
<p>å½“ç„¶æˆ‘ä»¬è¿˜å¯ä»¥æŠŠåˆ†ç±»åçš„æ ·æœ¬åŠå…¶æ‰€å±çš„èšç±»ä¸­å¿ƒéƒ½ç”»å‡ºæ¥ï¼Œè¿™æ ·å¯ä»¥æ›´ç›´è§‚åœ°è§‚å¯Ÿç®—æ³•çš„æ‹Ÿåˆæ•ˆæœã€‚</p>
<pre class="line-numbers language-python"><code class="language-python">labels <span class="token operator">=</span> kmean<span class="token punctuation">.</span>labels_
centers <span class="token operator">=</span> kmean<span class="token punctuation">.</span>cluster_centers_
markers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'o'</span><span class="token punctuation">,</span> <span class="token string">'^'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">]</span>
colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">]</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># ç”»æ ·æœ¬</span>
<span class="token keyword">for</span> c <span class="token keyword">in</span> range<span class="token punctuation">(</span>n_clusters<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cluster <span class="token operator">=</span> X<span class="token punctuation">[</span>labels <span class="token operator">==</span> c<span class="token punctuation">]</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>cluster<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cluster<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                marker<span class="token operator">=</span>markers<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> c<span class="token operator">=</span>colors<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># ç”»å‡ºä¸­å¿ƒç‚¹</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>centers<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> centers<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">"white"</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> c <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>centers<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'$%d$'</span> <span class="token operator">%</span> i<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> c<span class="token operator">=</span>colors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¾“å‡ºç»“æœå¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200716173439992.png" alt="image-20200716173439992"></p>
<p>å‰é¢è¯´è¿‡ï¼ŒK-å‡å€¼ç®—æ³•çš„ä¸€ä¸ªå…³é”®å‚æ•°æ˜¯Kï¼Œå³èšç±»ä¸ªæ•°ã€‚ä»æŠ€æœ¯è§’åº¦æ¥è®²ï¼ŒKå€¼è¶Šå¤§ï¼Œç®—æ³•æˆæœ¬è¶Šä½ï¼Œè¿™ä¸ªå¾ˆå®¹æ˜“ç†è§£ã€‚ä½†ä»ä¸šåŠ¡è§’åº¦æ¥çœ‹ï¼Œä¸æ˜¯Kå€¼è¶Šå¤§è¶Šå¥½ã€‚é’ˆå¯¹æœ¬èŠ‚çš„ä¾‹å­ï¼Œåˆ†åˆ«é€‰æ‹©K=[2,3,4]è¿™ä¸‰ç§ä¸åŒçš„èšç±»ä¸ªæ•°ï¼Œæ¥è§‚å¯Ÿä¸€ä¸‹K-å‡å€¼ç®—æ³•æœ€ç»ˆæ‹Ÿåˆçš„ç»“æœåŠå…¶æˆæœ¬ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥æŠŠç”»å‡ºK-å‡å€¼èšç±»ç»“æœçš„ä»£ç ç¨å¾®æ”¹é€ ä¸€ä¸‹ï¼Œå˜æˆä¸€ä¸ªå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šä½¿ç”¨K-å‡å€¼ç®—æ³•æ¥è¿›è¡Œèšç±»æ‹Ÿåˆï¼ŒåŒæ—¶ä¼šç”»å‡ºæŒ‰ç…§è¿™ä¸ªèšç±»ä¸ªæ•°æ‹Ÿåˆåçš„åˆ†ç±»æƒ…å†µï¼š</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">fit_plot_kmean_model</span><span class="token punctuation">(</span>n_clusters<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># ä½¿ç”¨ k-å‡å€¼ç®—æ³•è¿›è¡Œæ‹Ÿåˆ</span>
    kmean <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span>n_clusters<span class="token punctuation">)</span>
    kmean<span class="token punctuation">.</span>fit_predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span>

    labels <span class="token operator">=</span> kmean<span class="token punctuation">.</span>labels_
    centers <span class="token operator">=</span> kmean<span class="token punctuation">.</span>cluster_centers_
    markers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'o'</span><span class="token punctuation">,</span> <span class="token string">'^'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token string">'s'</span><span class="token punctuation">]</span>
    colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">]</span>

    <span class="token comment" spellcheck="true"># è®¡ç®—æˆæœ¬</span>
    score <span class="token operator">=</span> kmean<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"k={}, score={}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>n_clusters<span class="token punctuation">,</span> <span class="token punctuation">(</span>int<span class="token punctuation">)</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># ç”»æ ·æœ¬</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> range<span class="token punctuation">(</span>n_clusters<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cluster <span class="token operator">=</span> X<span class="token punctuation">[</span>labels <span class="token operator">==</span> c<span class="token punctuation">]</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>cluster<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cluster<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
                    marker<span class="token operator">=</span>markers<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> c<span class="token operator">=</span>colors<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># ç”»å‡ºä¸­å¿ƒç‚¹</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>centers<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> centers<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">"white"</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> c <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>centers<span class="token punctuation">)</span><span class="token punctuation">:</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'$%d$'</span> <span class="token operator">%</span> i<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> c<span class="token operator">=</span>colors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯èšç±»ä¸ªæ•°ï¼Œå³Kçš„å€¼ï¼Œå¦ä¸€ä¸ªæ˜¯æ•°æ®æ ·æœ¬ã€‚æœ‰äº†è¿™ä¸ªå‡½æ•°ï¼Œæ¥ä¸‹æ¥å°±ç®€å•äº†ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åˆ†åˆ«å¯¹[2,3,4]è¿™ä¸‰ç§ä¸åŒçš„Kå€¼æƒ…å†µè¿›è¡Œèšç±»åˆ†æï¼Œå¹¶æŠŠèšç±»ç»“æœå¯è§†åŒ–ã€‚</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans

n_clusters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> c <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>n_clusters<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    fit_plot_kmean_model<span class="token punctuation">(</span>c<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src= "/img/loading.gif" data-lazy-src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200716175104911.png" alt="image-20200716175104911"></p>
<h2 id="3-ä½¿ç”¨K-å‡å€¼å¯¹æ–‡æ¡£è¿›è¡Œèšç±»åˆ†æ"><a href="#3-ä½¿ç”¨K-å‡å€¼å¯¹æ–‡æ¡£è¿›è¡Œèšç±»åˆ†æ" class="headerlink" title="3. ä½¿ç”¨K-å‡å€¼å¯¹æ–‡æ¡£è¿›è¡Œèšç±»åˆ†æ"></a>3. ä½¿ç”¨K-å‡å€¼å¯¹æ–‡æ¡£è¿›è¡Œèšç±»åˆ†æ</h2><p>æœ¬èŠ‚ä»‹ç»å¦‚ä½•ä½¿ç”¨K-å‡å€¼ç®—æ³•å¯¹æ–‡æ¡£è¿›è¡Œèšç±»åˆ†æã€‚å‡è®¾æœ‰ä¸€ä¸ªåšå®¢å¹³å°ï¼Œç”¨æˆ·åœ¨å¹³å°ä¸Šå‘å¸ƒåšå®¢ï¼Œæˆ‘ä»¬å¦‚ä½•å¯¹åšå®¢è¿›è¡Œèšç±»åˆ†æï¼Œä»¥æ–¹ä¾¿å±•ç¤ºä¸åŒç±»åˆ«ä¸‹çš„çƒ­é—¨æ–‡ç« å‘¢ï¼Ÿ</p>
<h3 id="3-1-åŠ è½½æ•°æ®é›†"><a href="#3-1-åŠ è½½æ•°æ®é›†" class="headerlink" title="3.1 åŠ è½½æ•°æ®é›†"></a>3.1 åŠ è½½æ•°æ®é›†</h3><p>æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯æŠŠæ•°æ®é›†ç›®å½•ä¸‹<code>data/</code>çš„æ–‡æ¡£è¿›è¡Œèšç±»åˆ†æã€‚ä½ å¯èƒ½æœ‰ç–‘é—®ï¼šè¿™äº›æ–‡æ¡£ä¸æ˜¯æŒ‰ç…§æ–‡ä»¶å¤¹å·²ç»åˆ†å¥½ç±»äº†å—ï¼Ÿæ˜¯çš„ï¼Œè¿™æ˜¯äººå·¥æ ‡è®°äº†çš„æ•°æ®ã€‚æœ‰äº†äººå·¥æ ‡è®°çš„æ•°æ®ï¼Œå°±å¯ä»¥æ£€éªŒK-å‡å€¼ç®—æ³•çš„æ€§èƒ½ã€‚</p>
<p>é¦–å…ˆéœ€è¦å¯¼å…¥æ•°æ®ï¼š</p>
<pre class="line-numbers language-go"><code class="language-go">from time <span class="token keyword">import</span> time
from sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_files
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"loading documents ..."</span><span class="token punctuation">)</span>
t <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
docs <span class="token operator">=</span> <span class="token function">load_files</span><span class="token punctuation">(</span><span class="token string">'datasets/clustering/data'</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"summary: {0} documents in {1} categories."</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
    <span class="token function">len</span><span class="token punctuation">(</span>docs<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>docs<span class="token punctuation">.</span>target_names<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"done in {0} seconds"</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-bash"><code class="language-bash">loading documents <span class="token punctuation">..</span>.
summary: 3949 documents <span class="token keyword">in</span> 4 categories.
<span class="token keyword">done</span> <span class="token keyword">in</span> 26.920000076293945 seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>æ€»å…±æœ‰3949ç¯‡æ–‡ç« ï¼Œäººå·¥æ ‡è®°åœ¨4ä¸ªç±»åˆ«é‡Œã€‚æ¥ç€æŠŠæ–‡æ¡£è½¬åŒ–ä¸ºTF-IDFå‘é‡ï¼š</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> TfidfVectorizer

max_features <span class="token operator">=</span> <span class="token number">20000</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"vectorizing documents ..."</span><span class="token punctuation">)</span>
t <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>
vectorizer <span class="token operator">=</span> TfidfVectorizer<span class="token punctuation">(</span>max_df<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">,</span> 
                             min_df<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> 
                             max_features<span class="token operator">=</span>max_features<span class="token punctuation">,</span> 
                             encoding<span class="token operator">=</span><span class="token string">'latin-1'</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span><span class="token punctuation">(</span>d <span class="token keyword">for</span> d <span class="token keyword">in</span> docs<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n_samples: %d, n_features: %d"</span> <span class="token operator">%</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"number of non-zero features in sample [{0}]: {1}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>
    docs<span class="token punctuation">.</span>filenames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>getnnz<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"done in {0} seconds"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¿™é‡Œéœ€è¦æ³¨æ„TfidfVectorizerçš„å‡ ä¸ªå‚æ•°çš„é€‰æ‹©ã€‚max_df=0.4è¡¨ç¤ºå¦‚æœä¸€ä¸ªå•è¯åœ¨40%çš„æ–‡æ¡£é‡Œéƒ½å‡ºç°è¿‡ï¼Œåˆ™è®¤ä¸ºæ˜¯ä¸€ä¸ªé«˜é¢‘è¯ï¼Œå¯¹æ–‡æ¡£èšç±»æ²¡æœ‰å¸®åŠ©ï¼Œåœ¨ç”Ÿæˆè¯å…¸æ—¶å°±ä¼šå‰”é™¤è¿™ä¸ªè¯ã€‚min_df=2è¡¨ç¤ºï¼Œå¦‚æœä¸€ä¸ªå•è¯çš„è¯é¢‘å¤ªä½ï¼Œå°äºç­‰äº2ä¸ªï¼Œåˆ™ä¹ŸæŠŠè¿™ä¸ªå•è¯ä»è¯å…¸é‡Œå‰”é™¤ã€‚max_featureså¯ä»¥è¿›ä¸€æ­¥è¿‡æ»¤è¯å…¸çš„å¤§å°ï¼Œå®ƒä¼šæ ¹æ®TF-IDFæƒé‡ä»é«˜åˆ°ä½è¿›è¡Œæ’åºï¼Œç„¶åå–å‰é¢æƒé‡é«˜çš„å•è¯æ„æˆè¯å…¸ã€‚è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-css"><code class="language-css">vectorizing documents <span class="token number">...</span>
<span class="token property">n_samples</span><span class="token punctuation">:</span> <span class="token number">3949</span>, <span class="token property">n_features</span><span class="token punctuation">:</span> <span class="token number">20000</span>
number of non-zero features in sample [datasets/clustering/data\sci<span class="token number">.</span>electronics<span class="token entity" title="\11902">\11902</span>-<span class="token number">54322</span>]<span class="token punctuation">:</span> <span class="token number">56</span>
done in <span class="token number">1.9150002002716064</span> seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä»è¾“å‡ºå¯çŸ¥ï¼Œæ¯ç¯‡æ–‡ç« æ„æˆçš„å‘é‡éƒ½æ˜¯ä¸€ä¸ªç¨€ç–å‘é‡ï¼Œå…¶å¤§éƒ¨åˆ†å…ƒç´ éƒ½ä¸º0ã€‚è¿™ä¹Ÿå®¹æ˜“ç†è§£ï¼Œæˆ‘ä»¬çš„è¯å…¸å¤§å°ä¸º20000ä¸ªè¯ï¼Œè€Œç¤ºä¾‹æ–‡ç« ä¸­ä¸é‡å¤çš„å•è¯å´åªæœ‰56ä¸ªã€‚</p>
<h3 id="3-2-æ–‡æœ¬èšç±»åˆ†æ"><a href="#3-2-æ–‡æœ¬èšç±»åˆ†æ" class="headerlink" title="3.2 æ–‡æœ¬èšç±»åˆ†æ"></a>3.2 æ–‡æœ¬èšç±»åˆ†æ</h3><p>æ¥ç€ä½¿ç”¨KMeansç®—æ³•å¯¹æ–‡æ¡£è¿›è¡Œèšç±»åˆ†æï¼š</p>
<pre class="line-numbers language-dart"><code class="language-dart">from sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"clustering documents ..."</span><span class="token punctuation">)</span>
t <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
n_clusters <span class="token operator">=</span> <span class="token number">4</span>
kmean <span class="token operator">=</span> <span class="token function">KMeans</span><span class="token punctuation">(</span>n_clusters<span class="token operator">=</span>n_clusters<span class="token punctuation">,</span> 
               max_iter<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>
               tol<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span>
               verbose<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
               n_init<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
kmean<span class="token punctuation">.</span><span class="token function">fit</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"kmean: k={}, cost={}"</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>n_clusters<span class="token punctuation">,</span> <span class="token function">int</span><span class="token punctuation">(</span>kmean<span class="token punctuation">.</span>inertia_<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"done in {0} seconds"</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>é€‰æ‹©èšç±»ä¸ªæ•°ä¸º4ä¸ªã€‚max_iter=100è¡¨ç¤ºæœ€å¤šè¿›è¡Œ100æ¬¡K-å‡å€¼è¿­ä»£ã€‚tol=0.1è¡¨ç¤ºä¸­å¿ƒç‚¹ç§»åŠ¨è·ç¦»å°äº0.1æ—¶å°±è®¤ä¸ºç®—æ³•å·²ç»æ”¶æ•›ï¼Œåœæ­¢è¿­ä»£ã€‚verbose=1è¡¨ç¤ºè¾“å‡ºè¿­ä»£è¿‡ç¨‹çš„è¯¦ç»†ä¿¡æ¯ã€‚n_init=3è¡¨ç¤ºè¿›è¡Œ3éK-å‡å€¼è¿ç®—åæ±‚å¹³å‡å€¼ã€‚å‰é¢ä»‹ç»è¿‡ï¼Œåœ¨ç®—æ³•åˆšå¼€å§‹è¿­ä»£æ—¶ï¼Œä¼šéšæœºé€‰æ‹©èšç±»ä¸­å¿ƒç‚¹ï¼Œä¸åŒçš„ä¸­å¿ƒç‚¹å¯èƒ½å¯¼è‡´ä¸åŒçš„æ”¶æ•›æ•ˆæœï¼Œå› æ­¤å¤šæ¬¡è¿ç®—æ±‚å¹³å‡å€¼çš„æ–¹æ³•å¯ä»¥æé«˜ç®—æ³•çš„ç¨³å®šæ€§ã€‚ç”±äºå¼€å¯äº†è¿­ä»£è¿‡ç¨‹ä¿¡æ¯æ˜¾ç¤ºï¼Œè¾“å‡ºäº†è¾ƒå¤šçš„ä¿¡æ¯ï¼š</p>
<pre class="line-numbers language-bash"><code class="language-bash">clustering documents <span class="token punctuation">..</span>.
Initialization complete
Iteration  0, inertia 7488.362
Iteration  1, inertia 3845.708
Iteration  2, inertia 3835.369
Iteration  3, inertia 3828.959
Iteration  4, inertia 3824.555
Iteration  5, inertia 3820.932
Iteration  6, inertia 3818.555
Iteration  7, inertia 3817.377
Iteration  8, inertia 3816.317
Iteration  9, inertia 3815.570
Iteration 10, inertia 3815.351
Iteration 11, inertia 3815.234
Iteration 12, inertia 3815.181
Iteration 13, inertia 3815.151
Iteration 14, inertia 3815.136
Iteration 15, inertia 3815.120
Iteration 16, inertia 3815.113
Iteration 17, inertia 3815.106
Iteration 18, inertia 3815.104
Converged at iteration 18: center <span class="token function">shift</span> 0.000000e+00 within tolerance 4.896692e-07
Initialization complete
Iteration  0, inertia 7494.329
Iteration  1, inertia 3843.474
Iteration  2, inertia 3835.570
Iteration  3, inertia 3828.511
Iteration  4, inertia 3823.826
Iteration  5, inertia 3819.972
Iteration  6, inertia 3817.714
Iteration  7, inertia 3816.666
Iteration  8, inertia 3816.032
Iteration  9, inertia 3815.778
Iteration 10, inertia 3815.652
Iteration 11, inertia 3815.548
Iteration 12, inertia 3815.462
Iteration 13, inertia 3815.424
Iteration 14, inertia 3815.411
Iteration 15, inertia 3815.404
Iteration 16, inertia 3815.402
Converged at iteration 16: center <span class="token function">shift</span> 0.000000e+00 within tolerance 4.896692e-07
Initialization complete
Iteration  0, inertia 7538.349
Iteration  1, inertia 3844.796
Iteration  2, inertia 3828.820
Iteration  3, inertia 3822.973
Iteration  4, inertia 3821.341
Iteration  5, inertia 3820.164
Iteration  6, inertia 3819.181
Iteration  7, inertia 3818.546
Iteration  8, inertia 3818.167
Iteration  9, inertia 3817.975
Iteration 10, inertia 3817.862
Iteration 11, inertia 3817.770
Iteration 12, inertia 3817.723
Iteration 13, inertia 3817.681
Iteration 14, inertia 3817.654
Iteration 15, inertia 3817.628
Iteration 16, inertia 3817.607
Iteration 17, inertia 3817.593
Iteration 18, inertia 3817.585
Iteration 19, inertia 3817.580
Converged at iteration 19: center <span class="token function">shift</span> 0.000000e+00 within tolerance 4.896692e-07
kmean: k<span class="token operator">=</span>4, cost<span class="token operator">=</span>3815
<span class="token keyword">done</span> <span class="token keyword">in</span> 39.484999895095825 seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æˆ‘ä»¬å¥½å¥‡çš„æ˜¯ï¼šåœ¨è¿›è¡Œèšç±»åˆ†æçš„è¿‡ç¨‹ä¸­ï¼Œå“ªäº›å•è¯çš„æƒé‡æœ€é«˜ï¼Œä»è€Œè¾ƒå®¹æ˜“åœ°å†³å®šä¸€ä¸ªæ–‡ç« çš„ç±»åˆ«ï¼Ÿæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æ¯ç§ç±»åˆ«æ–‡æ¡£ä¸­ï¼Œå…¶æƒé‡æœ€é«˜çš„10ä¸ªå•è¯åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Top terms per cluster:"</span><span class="token punctuation">)</span>
order_centroids <span class="token operator">=</span> kmean<span class="token punctuation">.</span>cluster_centers_<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
terms <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>get_feature_names<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>n_clusters<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Cluster %d:"</span> <span class="token operator">%</span> i<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> ind <span class="token keyword">in</span> order_centroids<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">' %s'</span> <span class="token operator">%</span> terms<span class="token punctuation">[</span>ind<span class="token punctuation">]</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç†è§£è¿™æ®µä»£ç çš„å…³é”®åœ¨äºargsort()å‡½æ•°ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠä¸€ä¸ªNumpyæ•°ç»„è¿›è¡Œå‡åºæ’åˆ—ï¼Œè¿”å›çš„æ˜¯æ’åºåçš„ç´¢å¼•ã€‚</p>
<p>å›åˆ°æˆ‘ä»¬çš„ä»£ç é‡Œï¼Œç”±äº kmean.cluster_centers æ˜¯äºŒç»´æ•°ç»„ï¼Œå› æ­¤ kmean.cluster_centers.argsort()[:,::-1] è¯­å¥çš„å«ä¹‰å°±æ˜¯æŠŠèšç±»ä¸­å¿ƒç‚¹çš„ä¸åŒåˆ†é‡ï¼ŒæŒ‰ç…§ä»å¤§åˆ°å°çš„é¡ºåºè¿›è¡Œæ’åºï¼Œå¹¶ä¸”æŠŠæ’åºåçš„å…ƒç´ ç´¢å¼•ä¿å­˜åœ¨äºŒç»´æ•°ç»„order_centroidsé‡Œã€‚vectorizer.get_feature_names()å°†å¾—åˆ°æˆ‘ä»¬çš„è¯å…¸å•è¯ï¼Œæ ¹æ®ç´¢å¼•å³å¯å¾—åˆ°æ¯ä¸ªç±»åˆ«é‡Œæƒé‡æœ€é«˜çš„é‚£äº›å•è¯äº†ã€‚è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-csharp"><code class="language-csharp">Top terms per cluster<span class="token punctuation">:</span>
Cluster <span class="token number">0</span><span class="token punctuation">:</span> space henry nasa toronto moon pat zoo shuttle gov orbit
Cluster <span class="token number">1</span><span class="token punctuation">:</span> my any me by know your some <span class="token keyword">do</span> so has
Cluster <span class="token number">2</span><span class="token punctuation">:</span> key clipper encryption chip government will keys escrow we nsa
Cluster <span class="token number">3</span><span class="token punctuation">:</span> geb pitt banks gordon shameful dsl n3jxp chastity cadre surrender<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="4-èšç±»ç®—æ³•æ€§èƒ½è¯„ä¼°"><a href="#4-èšç±»ç®—æ³•æ€§èƒ½è¯„ä¼°" class="headerlink" title="4.èšç±»ç®—æ³•æ€§èƒ½è¯„ä¼°"></a>4.èšç±»ç®—æ³•æ€§èƒ½è¯„ä¼°</h3><p>èšç±»æ€§èƒ½è¯„ä¼°æ¯”è¾ƒå¤æ‚ï¼Œä¸åƒåˆ†ç±»é‚£æ ·ç›´è§‚ã€‚é’ˆå¯¹åˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è®¡ç®—è¢«é”™è¯¯åˆ†ç±»çš„æ ·æœ¬æ•°é‡ï¼Œè¿™æ ·å¯ä»¥ç›´æ¥ç®—å‡ºåˆ†ç±»ç®—æ³•çš„å‡†ç¡®ç‡ã€‚èšç±»é—®é¢˜ä¸èƒ½ä½¿ç”¨ç»å¯¹æ•°é‡çš„æ–¹æ³•è¿›è¡Œæ€§èƒ½è¯„ä¼°ï¼ŒåŸå› æ˜¯ï¼Œèšç±»åˆ†æåçš„ç±»åˆ«ä¸åŸæ¥å·²æ ‡è®°çš„ç±»åˆ«ä¹‹é—´ä¸å­˜åœ¨å¿…ç„¶çš„ä¸€ä¸€å¯¹åº”å…³ç³»ã€‚æ›´å…¸å‹çš„ï¼Œé’ˆå¯¹K-å‡å€¼ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©Kçš„æ•°å€¼ä¸ç­‰äºå·²æ ‡è®°çš„ç±»åˆ«ä¸ªæ•°ã€‚</p>
<p>å‰é¢ä»‹ç»å†³ç­–æ ‘çš„æ—¶å€™ç®€å•ä»‹ç»è¿‡â€œç†µâ€çš„æ¦‚å¿µï¼Œå®ƒæ˜¯ä¿¡æ¯è®ºä¸­æœ€é‡è¦çš„åŸºç¡€æ¦‚å¿µã€‚ç†µè¡¨ç¤ºä¸€ä¸ªç³»ç»Ÿçš„æœ‰åºç¨‹åº¦ï¼Œè€Œèšç±»é—®é¢˜çš„æ€§èƒ½è¯„ä¼°ï¼Œå°±æ˜¯å¯¹æ¯”ç»è¿‡èšç±»ç®—æ³•å¤„ç†åçš„æ•°æ®çš„æœ‰åºç¨‹åº¦ï¼Œä¸äººå·¥æ ‡è®°çš„æœ‰åºç¨‹åº¦ä¹‹é—´çš„å·®å¼‚ã€‚ä¸‹é¢ä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„èšç±»ç®—æ³•æ€§èƒ½è¯„ä¼°æŒ‡æ ‡</p>
<h6 id="1-Adjust-Rand-Index"><a href="#1-Adjust-Rand-Index" class="headerlink" title="1.Adjust Rand Index"></a><strong>1.Adjust Rand Index</strong></h6><p>Adjust Rand Indexæ˜¯ä¸€ç§è¡¡é‡ä¸¤ä¸ªåºåˆ—ç›¸ä¼¼æ€§çš„ç®—æ³•ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯ï¼Œé’ˆå¯¹ä¸¤ä¸ªéšæœºåºåˆ—ï¼Œå®ƒçš„å€¼ä¸ºè´Ÿæ•°æˆ–æ¥è¿‘0ã€‚è€Œé’ˆå¯¹ä¸¤ä¸ªç»“æ„ç›¸åŒçš„åºåˆ—ï¼Œå®ƒçš„å€¼æ¥è¿‘1ã€‚è€Œä¸”å¯¹ç±»åˆ«æ ‡ç­¾ä¸æ•æ„Ÿã€‚</p>
<h6 id="2-é½æ¬¡æ€§å’Œå®Œæ•´æ€§"><a href="#2-é½æ¬¡æ€§å’Œå®Œæ•´æ€§" class="headerlink" title="2.é½æ¬¡æ€§å’Œå®Œæ•´æ€§"></a><strong>2.é½æ¬¡æ€§å’Œå®Œæ•´æ€§</strong></h6><p>æ ¹æ®æ¡ä»¶ç†µåˆ†æï¼Œå¯ä»¥å¾—åˆ°å¦å¤–ä¸¤ä¸ªè¡¡é‡èšç±»ç®—æ³•æ€§èƒ½çš„æŒ‡æ ‡ï¼Œåˆ†åˆ«æ˜¯é½æ¬¡æ€§ï¼ˆhomogeneityï¼‰å’Œå®Œæ•´æ€§ï¼ˆcompletenessï¼‰ã€‚é½æ¬¡æ€§è¡¨ç¤ºä¸€ä¸ªèšç±»å…ƒç´ åªç”±ä¸€ç§ç±»åˆ«çš„å…ƒç´ ç»„æˆã€‚å®Œæ•´æ€§è¡¨ç¤ºç»™å®šçš„å·²æ ‡è®°çš„ç±»åˆ«ï¼Œå…¨éƒ¨åˆ†é…åˆ°ä¸€ä¸ªèšç±»é‡Œã€‚å®ƒä»¬çš„å€¼å‡ä»‹äº[0,1]ä¹‹é—´ã€‚</p>
<h6 id="3-è½®å»“ç³»æ•°"><a href="#3-è½®å»“ç³»æ•°" class="headerlink" title="3.è½®å»“ç³»æ•°"></a><strong>3.è½®å»“ç³»æ•°</strong></h6><p>ä¸Šé¢ä»‹ç»çš„èšç±»æ€§èƒ½è¯„ä¼°æ–¹æ³•éƒ½éœ€è¦æœ‰å·²æ ‡è®°çš„ç±»åˆ«æ•°æ®ï¼Œè¿™ä¸ªåœ¨å®è·µä¸­æ˜¯å¾ˆéš¾åšåˆ°çš„ã€‚å¦‚æœå·²ç»æ ‡è®°äº†æ•°æ®ï¼Œå°±ä¼šç›´æ¥ä½¿ç”¨æœ‰ç›‘ç£çš„å­¦ä¹ ç®—æ³•ï¼Œè€Œæ— ç›‘ç£å­¦ä¹ ç®—æ³•çš„æœ€å¤§ä¼˜ç‚¹å°±æ˜¯ä¸éœ€è¦å¯¹æ•°æ®é›†è¿›è¡Œæ ‡è®°ã€‚è½®å»“ç³»æ•°å¯ä»¥åœ¨ä¸éœ€è¦å·²æ ‡è®°çš„æ•°æ®é›†çš„å‰æä¸‹ï¼Œå¯¹èšç±»ç®—æ³•çš„æ€§èƒ½è¿›è¡Œè¯„ä¼°ã€‚</p>
<p>è½®å»“ç³»æ•°ç”±ä»¥ä¸‹ä¸¤ä¸ªæŒ‡æ ‡æ„æˆï¼š</p>
<ul>
<li>aï¼šä¸€ä¸ªæ ·æœ¬ä¸å…¶æ‰€åœ¨ç›¸åŒèšç±»çš„ç‚¹çš„å¹³å‡è·ç¦»ï¼›</li>
<li>bï¼šä¸€ä¸ªæ ·æœ¬ä¸å…¶è·ç¦»æœ€è¿‘çš„ä¸‹ä¸€ä¸ªèšç±»é‡Œçš„ç‚¹çš„å¹³å‡è·ç¦»ã€‚</li>
</ul>
<p>é’ˆå¯¹è¿™ä¸ªæ ·æœ¬ï¼Œå…¶è½®å»“ç³»æ•°sçš„å€¼ä¸ºï¼š<br>$$<br>s=\frac{b-a}{\max (a, b)}<br>$$<br>é’ˆå¯¹ä¸€ä¸ªæ•°æ®é›†ï¼Œå…¶è½®å»“ç³»æ•°sä¸ºå…¶æ‰€æœ‰æ ·æœ¬çš„è½®å»“ç³»æ•°çš„å¹³å‡å€¼ã€‚è½®å»“ç³»æ•°çš„æ•°å€¼ä»‹äº[-1,1]ä¹‹é—´ï¼Œ-1è¡¨ç¤ºå®Œå…¨é”™è¯¯çš„èšç±»ï¼Œ1è¡¨ç¤ºå®Œç¾çš„èšç±»ï¼Œ0è¡¨ç¤ºèšç±»é‡å ã€‚</p>
<p>é’ˆå¯¹å‰é¢çš„ä¾‹å­ï¼Œå¯ä»¥åˆ†åˆ«è®¡ç®—æœ¬èŠ‚ä»‹ç»çš„å‡ ä¸ªèšç±»ç®—æ³•æ€§èƒ½è¯„ä¼°æŒ‡æ ‡ï¼Œç»¼åˆæ¥çœ‹èšç±»ç®—æ³•çš„æ€§èƒ½ï¼š</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics
labels <span class="token operator">=</span> docs<span class="token punctuation">.</span>target
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Homogeneity: %0.3f"</span> <span class="token operator">%</span> metrics<span class="token punctuation">.</span>homogeneity_score<span class="token punctuation">(</span>labels<span class="token punctuation">,</span> kmean<span class="token punctuation">.</span>labels_<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Completeness: %0.3f"</span> <span class="token operator">%</span> metrics<span class="token punctuation">.</span>completeness_score<span class="token punctuation">(</span>labels<span class="token punctuation">,</span> kmean<span class="token punctuation">.</span>labels_<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"V-measure: %0.3f"</span> <span class="token operator">%</span> metrics<span class="token punctuation">.</span>v_measure_score<span class="token punctuation">(</span>labels<span class="token punctuation">,</span> kmean<span class="token punctuation">.</span>labels_<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Adjusted Rand-Index: %.3f"</span>
      <span class="token operator">%</span> metrics<span class="token punctuation">.</span>adjusted_rand_score<span class="token punctuation">(</span>labels<span class="token punctuation">,</span> kmean<span class="token punctuation">.</span>labels_<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Silhouette Coefficient: %0.3f"</span>
      <span class="token operator">%</span> metrics<span class="token punctuation">.</span>silhouette_score<span class="token punctuation">(</span>X<span class="token punctuation">,</span> kmean<span class="token punctuation">.</span>labels_<span class="token punctuation">,</span> sample_size<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-css"><code class="language-css"><span class="token property">Homogeneity</span><span class="token punctuation">:</span> <span class="token number">0.459</span>
<span class="token property">Completeness</span><span class="token punctuation">:</span> <span class="token number">0.519</span>
<span class="token property">V-measure</span><span class="token punctuation">:</span> <span class="token number">0.487</span>
Adjusted <span class="token property">Rand-Index</span><span class="token punctuation">:</span> <span class="token number">0.328</span>
Silhouette <span class="token property">Coefficient</span><span class="token punctuation">:</span> <span class="token number">0.004</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¯ä»¥çœ‹åˆ°æ¨¡å‹æ€§èƒ½å¾ˆä¸€èˆ¬ã€‚å¯èƒ½çš„ä¸€ä¸ªåŸå› æ˜¯æ•°æ®é›†è´¨é‡ä¸é«˜ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é˜…è¯»åŸå§‹çš„è¯­æ–™åº“ï¼Œæ£€éªŒä¸€ä¸‹å¦‚æœé€šè¿‡äººå·¥æ ‡è®°ï¼Œæ˜¯å¦èƒ½å¤Ÿæ ‡è®°å‡ºè¿™äº›æ–‡ç« çš„æ­£ç¡®åˆ†ç±»ã€‚å¦å¤–ï¼Œé’ˆå¯¹myã€anyã€meã€byã€knowã€yourã€someã€doã€soã€hasï¼Œè¿™äº›éƒ½æ˜¯æ²¡æœ‰ç‰¹å¾çš„å•è¯ï¼Œå³ä½¿äººå·¥æ ‡è®°ï¼Œä¹Ÿæ— æ³•åˆ¤æ–­è¿™äº›å•è¯åº”è¯¥å±äºå“ªç§ç±»åˆ«çš„æ–‡ç« ã€‚</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">DongZhou</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://dongzhougu.github.io/2020/07/16/scikit-learn-xi-lie-jiu-k-jun-zhi/">https://dongzhougu.github.io/2020/07/16/scikit-learn-xi-lie-jiu-k-jun-zhi/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://dongzhougu.github.io" target="_blank">æ¬¢è¿æ¥åˆ°ï¼ŒTWOTO çš„åšå®¢</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-10.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> æ‰“èµ</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/jerryc127/CDN/Photo/wechat.jpg" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/Photo/wechat.jpg" alt="å¾®ä¿¡"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/jerryc127/CDN/Photo/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/Photo/alipay.jpg" alt="æ”¯ä»˜å¯¶"/></a><div class="post-qr-code-desc">æ”¯ä»˜å¯¶</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/jerryc127/CDN/Photo/alipayhk.jpg" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/Photo/alipayhk.jpg" alt="æ”¯ä»˜å¯¶é¦™æ¸¯"/></a><div class="post-qr-code-desc">æ”¯ä»˜å¯¶é¦™æ¸¯</div></li></ul></div></div><div class="ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-fb+5w+4e-db+86" data-ad-client="ca-pub-8919908724705274" data-ad-slot="5978969231"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/07/16/ji-qi-xue-xi-suan-fa-shi-xian/"><img class="prev-cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-3.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">æœºå™¨å­¦ä¹ ç®—æ³•å®ç°</div></div></a></div><div class="next-post pull-right"><a href="/2020/07/15/scikit-learn-xi-lie-ba-pca/"><img class="next-cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-4.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">scikit-learnç³»åˆ—å…«ï¼šPCA</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2020/07/16/ji-qi-xue-xi-suan-fa-shi-xian/" title="æœºå™¨å­¦ä¹ ç®—æ³•å®ç°"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-3.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-16</div><div class="title">æœºå™¨å­¦ä¹ ç®—æ³•å®ç°</div></div></a></div><div><a href="/2020/06/30/scikit-learn-xi-lie-san-xian-xing-hui-gui/" title="scikit-learnç³»åˆ—ä¸‰ï¼šçº¿æ€§å›å½’"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-9.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-06-30</div><div class="title">scikit-learnç³»åˆ—ä¸‰ï¼šçº¿æ€§å›å½’</div></div></a></div><div><a href="/2020/06/28/scikit-learn-xi-lie-yi-ji-qi-xue-xi-ji-chu/" title="scikit-learnç³»åˆ—ä¸€ï¼šæœºå™¨å­¦ä¹ åŸºç¡€"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-9.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-06-28</div><div class="title">scikit-learnç³»åˆ—ä¸€ï¼šæœºå™¨å­¦ä¹ åŸºç¡€</div></div></a></div><div><a href="/2020/06/29/scikit-learn-xi-lie-er-k-jin-lin/" title="scikit-learnç³»åˆ—äºŒï¼šK-è¿‘é‚»"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-7.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-06-29</div><div class="title">scikit-learnç³»åˆ—äºŒï¼šK-è¿‘é‚»</div></div></a></div><div><a href="/2020/06/30/scikit-learn-xi-lie-wu-jue-ce-shu/" title="scikit-learnç³»åˆ—äº”ï¼šå†³ç­–æ ‘"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-2.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-06-30</div><div class="title">scikit-learnç³»åˆ—äº”ï¼šå†³ç­–æ ‘</div></div></a></div><div><a href="/2020/07/01/scikit-learn-xi-lie-liu-svm/" title="scikit-learnç³»åˆ—å…­ï¼šSVM"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-9.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-01</div><div class="title">scikit-learnç³»åˆ—å…­ï¼šSVM</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div><div id="comment-switch"><span class="first-comment">Twikoo</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">DongZhou</div><div class="author-info__description">æŠ€æœ¯ã€æ•ˆç‡ã€æ‘„å½±</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">50</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">29</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">10</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly"><i class="fab fa-github"></i><span>ä¸»é¡Œ GitHub</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:gdz678@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></div><div class="announcement_content">å¦‚æœä½ åœ¨ä½¿ç”¨ä¸­é‡åˆ°å•é¡Œï¼Œè«‹åˆ° <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly/issues" style="color:#49b1f5">Github Issues</a> æˆ–è€… <a href="/messageboard/" style="color:#49b1f5">ç•™è¨€æ¿</a> é€²è¡Œåé¥‹ï¼Œä½ ä¹Ÿå¯ä»¥åŠ å…¥ QQ ç¾¤ï¼ˆç”±æ–¼ QQ ç¾¤åªèƒ½æœ‰500äººï¼Œæœƒå®šæ™‚æ¸…ç†æ½›æ°´çš„äººï¼‰<div class="social-button"> <a class="button--animated" href="https://jq.qq.com/?_wv=1027&k=KU9105XR" target="_blank">QQ 1 ç¾¤ ğŸ‘</a> <a class="button--animated" href="https://jq.qq.com/?_wv=1027&k=r1nK0DQz" target="_blank">QQ 2 ç¾¤ ğŸ‘</a> <a class="button--animated" href="https://t.me/bu2fly" target="_blank">Telegram ğŸ‘</a> </div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%9C%B0%E5%9D%80%E4%BC%A0%E9%80%81%E9%97%A8%EF%BC%8C%E6%AC%A2%E8%BF%8E-star-%E5%92%8C-fork-%EF%BC%81"><span class="toc-number">1.</span> <span class="toc-text">é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿ star å’Œ fork ï¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#K-Means%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text">K-Meansèšç±»ç®—æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-K-Means-%E7%AE%97%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">1. K-Means ç®—æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-K-Means-%E5%9C%BA%E6%99%AF"><span class="toc-number">3.1.</span> <span class="toc-text">1.1 K-Means åœºæ™¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-K-Means-%E6%9C%AF%E8%AF%AD"><span class="toc-number">3.2.</span> <span class="toc-text">1.2 K-Means æœ¯è¯­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-K-Means-%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-number">3.3.</span> <span class="toc-text">1.3 K-Means å·¥ä½œæµç¨‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-sklearn-%E9%87%8C%E7%9A%84K-%E5%9D%87%E5%80%BC%E7%AE%97%E6%B3%95"><span class="toc-number">4.</span> <span class="toc-text">2. sklearn é‡Œçš„K-å‡å€¼ç®—æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E4%BD%BF%E7%94%A8K-%E5%9D%87%E5%80%BC%E5%AF%B9%E6%96%87%E6%A1%A3%E8%BF%9B%E8%A1%8C%E8%81%9A%E7%B1%BB%E5%88%86%E6%9E%90"><span class="toc-number">5.</span> <span class="toc-text">3. ä½¿ç”¨K-å‡å€¼å¯¹æ–‡æ¡£è¿›è¡Œèšç±»åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">5.1.</span> <span class="toc-text">3.1 åŠ è½½æ•°æ®é›†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%96%87%E6%9C%AC%E8%81%9A%E7%B1%BB%E5%88%86%E6%9E%90"><span class="toc-number">5.2.</span> <span class="toc-text">3.2 æ–‡æœ¬èšç±»åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95%E6%80%A7%E8%83%BD%E8%AF%84%E4%BC%B0"><span class="toc-number">5.3.</span> <span class="toc-text">4.èšç±»ç®—æ³•æ€§èƒ½è¯„ä¼°</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-Adjust-Rand-Index"><span class="toc-number">5.3.0.0.1.</span> <span class="toc-text">1.Adjust Rand Index</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E9%BD%90%E6%AC%A1%E6%80%A7%E5%92%8C%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number">5.3.0.0.2.</span> <span class="toc-text">2.é½æ¬¡æ€§å’Œå®Œæ•´æ€§</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E8%BD%AE%E5%BB%93%E7%B3%BB%E6%95%B0"><span class="toc-number">5.3.0.0.3.</span> <span class="toc-text">3.è½®å»“ç³»æ•°</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/11/15/yuque/springboot-zheng-he-redis/" title="SpringBoot-æ•´åˆRedis">SpringBoot-æ•´åˆRedis</a><time datetime="2021-11-15T11:11:53.000Z" title="å‘è¡¨äº 2021-11-15 19:11:53">2021-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/11/15/yuque/fen-bu-shi-xiao-xi-zhong-jian-jian-gai-shu/" title="åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶-æ¦‚è¿°">åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶-æ¦‚è¿°</a><time datetime="2021-11-15T10:58:22.000Z" title="å‘è¡¨äº 2021-11-15 18:58:22">2021-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/11/15/yuque/springboot-qian-hou-duan-fen-chi-kua-yu-pei-zhi/" title="SpringBoot-å‰åç«¯åˆ†ç¦»è·¨åŸŸé…ç½®">SpringBoot-å‰åç«¯åˆ†ç¦»è·¨åŸŸé…ç½®</a><time datetime="2021-11-15T06:57:12.000Z" title="å‘è¡¨äº 2021-11-15 14:57:12">2021-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/11/14/yuque/mybatis-jia-gou-yu-yuan-li/" title="MyBatis-æ¶æ„ä¸åŸç†">MyBatis-æ¶æ„ä¸åŸç†</a><time datetime="2021-11-14T04:59:00.000Z" title="å‘è¡¨äº 2021-11-14 12:59:00">2021-11-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/11/14/yuque/mybatis-huan-cun-gong-zuo-yuan-li/" title="Mybatis-ç¼“å­˜å·¥ä½œåŸç†">Mybatis-ç¼“å­˜å·¥ä½œåŸç†</a><time datetime="2021-11-14T04:58:08.000Z" title="å‘è¡¨äº 2021-11-14 12:58:08">2021-11-14</time></div></div></div></div><div class="card-widget ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8919908724705274" data-ad-slot="8108145410" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/material-10.png')"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By DongZhou</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="æ”¾å¤§å­—ä½“"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="ç¼©å°å­—ä½“"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç°¡</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="https://cdn.jsdelivr.net/npm/hexo-theme-butterfly@3.8.4/source/js/utils.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-butterfly@3.8.4/source/js/main.min.js"></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly.js.org/source/selfjs/tw_cn.min.js?ver=3.8.4"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly.js.org/source/selfjs/localsearch.min.js?ver=3.8.4"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      true && mermaid.init()
    })
  }
}</script><script>(()=>{
  const $countDom = document.getElementById('twikoo-count')
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://butterfly-twikoo.vercel.app/',
      region: ''
    }, null))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'https://butterfly-twikoo.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      $countDom.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const loadTwikoo = (bool = false) => {
    if (typeof twikoo === 'object') {
      init()
      bool && $countDom && setTimeout(getCount,0)
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.min.js').then(()=> {
        init()
        bool && $countDom && setTimeout(getCount,0)
      })
    }
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo(true)
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://dongzhougu.github.io/2020/07/16/scikit-learn-xi-lie-jiu-k-jun-zhi/'
    this.page.identifier = '2020/07/16/scikit-learn-xi-lie-jiu-k-jun-zhi/'
    this.page.title = 'scikit-learnç³»åˆ—ä¹ï¼šK-å‡å€¼'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://demo-jerryc-me.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Twikoo' === 'Disqus' || !true) {
  if (true) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[å›¾ç‰‡]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[é“¾æ¥]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[ä»£ç ]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://butterfly-twikoo.vercel.app/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 5/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "æ— æ³•è·å–è¯„è®ºï¼Œè¯·ç¡®è®¤ç›¸å…³é…ç½®æ˜¯å¦æ­£ç¡®"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += 'æ²¡æœ‰è¯„è®º'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/talking/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.removeEventListener('scroll', window.tocScrollFn)
  window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var i=n.imageLazyLoadSetting.isSPA,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){i&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,e,a=0;a<r.length;a++)t=r[a],e=void 0,0<=(e=t.getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(n.innerHeight||document.documentElement.clientHeight)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},n.src=i}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body></html>